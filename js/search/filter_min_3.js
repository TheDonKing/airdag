/**
 * Created by marat on 21.01.2016.
 */

Function.__typeName="Function";Function.__class=true;Function.createCallback=function(b,a){return function(){var e=arguments.length;if(e>0){var d=[];for(var c=0;c<e;c++)d[c]=arguments[c];d[e]=a;return b.apply(this,d)}return b.call(this,a)}};Function.createDelegate=function(a,b){return function(){return b.apply(a,arguments)}};Function.emptyFunction=Function.emptyMethod=function(){};Function.validateParameters=function(c,b,a){return Function._validateParams(c,b,a)};Function._validateParams=function(g,e,c){var a,d=e.length;c=c||typeof c==="undefined";a=Function._validateParameterCount(g,e,c);if(a){a.popStackFrame();return a}for(var b=0,i=g.length;b<i;b++){var f=e[Math.min(b,d-1)],h=f.name;if(f.parameterArray)h+="["+(b-d+1)+"]";else if(!c&&b>=d)break;a=Function._validateParameter(g[b],f,h);if(a){a.popStackFrame();return a}}return null};Function._validateParameterCount=function(j,d,i){var a,c,b=d.length,e=j.length;if(e<b){var f=b;for(a=0;a<b;a++){var g=d[a];if(g.optional||g.parameterArray)f--}if(e<f)c=true}else if(i&&e>b){c=true;for(a=0;a<b;a++)if(d[a].parameterArray){c=false;break}}if(c){var h=Error.parameterCount();h.popStackFrame();return h}return null};Function._validateParameter=function(c,a,h){var b,g=a.type,l=!!a.integer,k=!!a.domElement,m=!!a.mayBeNull;b=Function._validateParameterType(c,g,l,k,m,h);if(b){b.popStackFrame();return b}var e=a.elementType,f=!!a.elementMayBeNull;if(g===Array&&typeof c!=="undefined"&&c!==null&&(e||!f)){var j=!!a.elementInteger,i=!!a.elementDomElement;for(var d=0;d<c.length;d++){var n=c[d];b=Function._validateParameterType(n,e,j,i,f,h+"["+d+"]");if(b){b.popStackFrame();return b}}}return null};Function._validateParameterType=function(b,c,k,j,h,d){var a,g;if(typeof b==="undefined")if(h)return null;else{a=Error.argumentUndefined(d);a.popStackFrame();return a}if(b===null)if(h)return null;else{a=Error.argumentNull(d);a.popStackFrame();return a}if(c&&c.__enum){if(typeof b!=="number"){a=Error.argumentType(d,Object.getType(b),c);a.popStackFrame();return a}if(b%1===0){var e=c.prototype;if(!c.__flags||b===0){for(g in e)if(e[g]===b)return null}else{var i=b;for(g in e){var f=e[g];if(f===0)continue;if((f&b)===f)i-=f;if(i===0)return null}}}a=Error.argumentOutOfRange(d,b,String.format(Sys.Res.enumInvalidValue,b,c.getName()));a.popStackFrame();return a}if(j&&(!Sys._isDomElement(b)||b.nodeType===3)){a=Error.argument(d,Sys.Res.argumentDomElement);a.popStackFrame();return a}if(c&&!Sys._isInstanceOfType(c,b)){a=Error.argumentType(d,Object.getType(b),c);a.popStackFrame();return a}if(c===Number&&k)if(b%1!==0){a=Error.argumentOutOfRange(d,b,Sys.Res.argumentInteger);a.popStackFrame();return a}return null};Error.__typeName="Error";Error.__class=true;Error.create=function(d,b){var a=new Error(d);a.message=d;if(b)for(var c in b)a[c]=b[c];a.popStackFrame();return a};Error.argument=function(a,c){var b="Sys.ArgumentException: "+(c?c:Sys.Res.argument);if(a)b+="\n"+String.format(Sys.Res.paramName,a);var d=Error.create(b,{name:"Sys.ArgumentException",paramName:a});d.popStackFrame();return d};Error.argumentNull=function(a,c){var b="Sys.ArgumentNullException: "+(c?c:Sys.Res.argumentNull);if(a)b+="\n"+String.format(Sys.Res.paramName,a);var d=Error.create(b,{name:"Sys.ArgumentNullException",paramName:a});d.popStackFrame();return d};Error.argumentOutOfRange=function(c,a,d){var b="Sys.ArgumentOutOfRangeException: "+(d?d:Sys.Res.argumentOutOfRange);if(c)b+="\n"+String.format(Sys.Res.paramName,c);if(typeof a!=="undefined"&&a!==null)b+="\n"+String.format(Sys.Res.actualValue,a);var e=Error.create(b,{name:"Sys.ArgumentOutOfRangeException",paramName:c,actualValue:a});e.popStackFrame();return e};Error.argumentType=function(d,c,b,e){var a="Sys.ArgumentTypeException: ";if(e)a+=e;else if(c&&b)a+=String.format(Sys.Res.argumentTypeWithTypes,c.getName(),b.getName());else a+=Sys.Res.argumentType;if(d)a+="\n"+String.format(Sys.Res.paramName,d);var f=Error.create(a,{name:"Sys.ArgumentTypeException",paramName:d,actualType:c,expectedType:b});f.popStackFrame();return f};Error.argumentUndefined=function(a,c){var b="Sys.ArgumentUndefinedException: "+(c?c:Sys.Res.argumentUndefined);if(a)b+="\n"+String.format(Sys.Res.paramName,a);var d=Error.create(b,{name:"Sys.ArgumentUndefinedException",paramName:a});d.popStackFrame();return d};Error.format=function(a){var c="Sys.FormatException: "+(a?a:Sys.Res.format),b=Error.create(c,{name:"Sys.FormatException"});b.popStackFrame();return b};Error.invalidOperation=function(a){var c="Sys.InvalidOperationException: "+(a?a:Sys.Res.invalidOperation),b=Error.create(c,{name:"Sys.InvalidOperationException"});b.popStackFrame();return b};Error.notImplemented=function(a){var c="Sys.NotImplementedException: "+(a?a:Sys.Res.notImplemented),b=Error.create(c,{name:"Sys.NotImplementedException"});b.popStackFrame();return b};Error.parameterCount=function(a){var c="Sys.ParameterCountException: "+(a?a:Sys.Res.parameterCount),b=Error.create(c,{name:"Sys.ParameterCountException"});b.popStackFrame();return b};Error.prototype.popStackFrame=function(){if(typeof this.stack==="undefined"||this.stack===null||typeof this.fileName==="undefined"||this.fileName===null||typeof this.lineNumber==="undefined"||this.lineNumber===null)return;var a=this.stack.split("\n"),c=a[0],e=this.fileName+":"+this.lineNumber;while(typeof c!=="undefined"&&c!==null&&c.indexOf(e)===-1){a.shift();c=a[0]}var d=a[1];if(typeof d==="undefined"||d===null)return;var b=d.match(/@(.*):(\d+)$/);if(typeof b==="undefined"||b===null)return;this.fileName=b[1];this.lineNumber=parseInt(b[2]);a.shift();this.stack=a.join("\n")};Object.__typeName="Object";Object.__class=true;Object.getType=function(b){var a=b.constructor;if(!a||typeof a!=="function"||!a.__typeName||a.__typeName==="Object")return Object;return a};Object.getTypeName=function(a){return Object.getType(a).getName()};String.__typeName="String";String.__class=true;String.prototype.endsWith=function(a){return this.substr(this.length-a.length)===a};String.prototype.startsWith=function(a){return this.substr(0,a.length)===a};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};String.prototype.trimEnd=function(){return this.replace(/\s+$/,"")};String.prototype.trimStart=function(){return this.replace(/^\s+/,"")};String.format=function(){return String._toFormattedString(false,arguments)};String._toFormattedString=function(l,j){var c="",e=j[0];for(var a=0;true;){var f=e.indexOf("{",a),d=e.indexOf("}",a);if(f<0&&d<0){c+=e.slice(a);break}if(d>0&&(d<f||f<0)){c+=e.slice(a,d+1);a=d+2;continue}c+=e.slice(a,f);a=f+1;if(e.charAt(a)==="{"){c+="{";a++;continue}if(d<0)break;var h=e.substring(a,d),g=h.indexOf(":"),k=parseInt(g<0?h:h.substring(0,g),10)+1,i=g<0?"":h.substring(g+1),b=j[k];if(typeof b==="undefined"||b===null)b="";if(b.toFormattedString)c+=b.toFormattedString(i);else if(l&&b.localeFormat)c+=b.localeFormat(i);else if(b.format)c+=b.format(i);else c+=b.toString();a=d+1}return c};Boolean.__typeName="Boolean";Boolean.__class=true;Boolean.parse=function(b){var a=b.trim().toLowerCase();if(a==="false")return false;if(a==="true")return true};Date.__typeName="Date";Date.__class=true;Number.__typeName="Number";Number.__class=true;RegExp.__typeName="RegExp";RegExp.__class=true;if(!window)this.window=this;window.Type=Function;Type.prototype.callBaseMethod=function(a,d,b){var c=Sys._getBaseMethod(this,a,d);if(!b)return c.apply(a);else return c.apply(a,b)};Type.prototype.getBaseMethod=function(a,b){return Sys._getBaseMethod(this,a,b)};Type.prototype.getBaseType=function(){return typeof this.__baseType==="undefined"?null:this.__baseType};Type.prototype.getInterfaces=function(){var a=[],b=this;while(b){var c=b.__interfaces;if(c)for(var d=0,f=c.length;d<f;d++){var e=c[d];if(!Array.contains(a,e))a[a.length]=e}b=b.__baseType}return a};Type.prototype.getName=function(){return typeof this.__typeName==="undefined"?"":this.__typeName};Type.prototype.implementsInterface=function(d){this.resolveInheritance();var c=d.getName(),a=this.__interfaceCache;if(a){var e=a[c];if(typeof e!=="undefined")return e}else a=this.__interfaceCache={};var b=this;while(b){var f=b.__interfaces;if(f)if(Array.indexOf(f,d)!==-1)return a[c]=true;b=b.__baseType}return a[c]=false};Type.prototype.inheritsFrom=function(b){this.resolveInheritance();var a=this.__baseType;while(a){if(a===b)return true;a=a.__baseType}return false};Type.prototype.initializeBase=function(a,b){this.resolveInheritance();if(this.__baseType)if(!b)this.__baseType.apply(a);else this.__baseType.apply(a,b);return a};Type.prototype.isImplementedBy=function(a){if(typeof a==="undefined"||a===null)return false;var b=Object.getType(a);return!!(b.implementsInterface&&b.implementsInterface(this))};Type.prototype.isInstanceOfType=function(a){return Sys._isInstanceOfType(this,a)};Type.prototype.registerClass=function(c,b,d){this.prototype.constructor=this;this.__typeName=c;this.__class=true;if(b){this.__baseType=b;this.__basePrototypePending=true}Sys.__upperCaseTypes[c.toUpperCase()]=this;if(d){this.__interfaces=[];for(var a=2,f=arguments.length;a<f;a++){var e=arguments[a];this.__interfaces.push(e)}}return this};Type.prototype.registerInterface=function(a){Sys.__upperCaseTypes[a.toUpperCase()]=this;this.prototype.constructor=this;this.__typeName=a;this.__interface=true;return this};Type.prototype.resolveInheritance=function(){if(this.__basePrototypePending){var b=this.__baseType;b.resolveInheritance();for(var a in b.prototype){var c=b.prototype[a];if(!this.prototype[a])this.prototype[a]=c}delete this.__basePrototypePending}};Type.getRootNamespaces=function(){return Array.clone(Sys.__rootNamespaces)};Type.isClass=function(a){if(typeof a==="undefined"||a===null)return false;return!!a.__class};Type.isInterface=function(a){if(typeof a==="undefined"||a===null)return false;return!!a.__interface};Type.isNamespace=function(a){if(typeof a==="undefined"||a===null)return false;return!!a.__namespace};Type.parse=function(typeName,ns){var fn;if(ns){fn=Sys.__upperCaseTypes[ns.getName().toUpperCase()+"."+typeName.toUpperCase()];return fn||null}if(!typeName)return null;if(!Type.__htClasses)Type.__htClasses={};fn=Type.__htClasses[typeName];if(!fn){fn=eval(typeName);Type.__htClasses[typeName]=fn}return fn};Type.registerNamespace=function(e){var d=window,c=e.split(".");for(var b=0;b<c.length;b++){var f=c[b],a=d[f];if(!a)a=d[f]={};if(!a.__namespace){if(b===0&&e!=="Sys")Sys.__rootNamespaces[Sys.__rootNamespaces.length]=a;a.__namespace=true;a.__typeName=c.slice(0,b+1).join(".");a.getName=function(){return this.__typeName}}d=a}};Type._checkDependency=function(c,a){var d=Type._registerScript._scripts,b=d?!!d[c]:false;if(typeof a!=="undefined"&&!b)throw Error.invalidOperation(String.format(Sys.Res.requiredScriptReferenceNotIncluded,a,c));return b};Type._registerScript=function(a,c){var b=Type._registerScript._scripts;if(!b)Type._registerScript._scripts=b={};if(b[a])throw Error.invalidOperation(String.format(Sys.Res.scriptAlreadyLoaded,a));b[a]=true;if(c)for(var d=0,f=c.length;d<f;d++){var e=c[d];if(!Type._checkDependency(e))throw Error.invalidOperation(String.format(Sys.Res.scriptDependencyNotFound,a,e))}};Type.registerNamespace("Sys");Sys.__upperCaseTypes={};Sys.__rootNamespaces=[Sys];Sys._isInstanceOfType=function(c,b){if(typeof b==="undefined"||b===null)return false;if(b instanceof c)return true;var a=Object.getType(b);return!!(a===c)||a.inheritsFrom&&a.inheritsFrom(c)||a.implementsInterface&&a.implementsInterface(c)};Sys._getBaseMethod=function(d,e,c){var b=d.getBaseType();if(b){var a=b.prototype[c];return a instanceof Function?a:null}return null};Sys._isDomElement=function(a){var c=false;if(typeof a.nodeType!=="number"){var b=a.ownerDocument||a.document||a;if(b!=a){var d=b.defaultView||b.parentWindow;c=d!=a}else c=typeof b.body==="undefined"}return!c};Array.__typeName="Array";Array.__class=true;Array.add=Array.enqueue=function(a,b){a[a.length]=b};Array.addRange=function(a,b){a.push.apply(a,b)};Array.clear=function(a){a.length=0};Array.clone=function(a){if(a.length===1)return[a[0]];else return Array.apply(null,a)};Array.contains=function(a,b){return Sys._indexOf(a,b)>=0};Array.dequeue=function(a){return a.shift()};Array.forEach=function(b,e,d){for(var a=0,f=b.length;a<f;a++){var c=b[a];if(typeof c!=="undefined")e.call(d,c,a,b)}};Array.indexOf=function(a,c,b){return Sys._indexOf(a,c,b)};Array.insert=function(a,b,c){a.splice(b,0,c)};Array.parse=function(value){if(!value)return[];return eval(value)};Array.remove=function(b,c){var a=Sys._indexOf(b,c);if(a>=0)b.splice(a,1);return a>=0};Array.removeAt=function(a,b){a.splice(b,1)};Sys._indexOf=function(d,e,a){if(typeof e==="undefined")return-1;var c=d.length;if(c!==0){a=a-0;if(isNaN(a))a=0;else{if(isFinite(a))a=a-a%1;if(a<0)a=Math.max(0,c+a)}for(var b=a;b<c;b++)if(typeof d[b]!=="undefined"&&d[b]===e)return b}return-1};Type._registerScript._scripts={"MicrosoftAjaxCore.js":true,"MicrosoftAjaxGlobalization.js":true,"MicrosoftAjaxSerialization.js":true,"MicrosoftAjaxComponentModel.js":true,"MicrosoftAjaxHistory.js":true,"MicrosoftAjaxNetwork.js":true,"MicrosoftAjaxWebServices.js":true};Sys.IDisposable=function(){};Sys.IDisposable.prototype={};Sys.IDisposable.registerInterface("Sys.IDisposable");Sys.StringBuilder=function(a){this._parts=typeof a!=="undefined"&&a!==null&&a!==""?[a.toString()]:[];this._value={};this._len=0};Sys.StringBuilder.prototype={append:function(a){this._parts[this._parts.length]=a},appendLine:function(a){this._parts[this._parts.length]=typeof a==="undefined"||a===null||a===""?"\r\n":a+"\r\n"},clear:function(){this._parts=[];this._value={};this._len=0},isEmpty:function(){if(this._parts.length===0)return true;return this.toString()===""},toString:function(a){a=a||"";var b=this._parts;if(this._len!==b.length){this._value={};this._len=b.length}var d=this._value;if(typeof d[a]==="undefined"){if(a!=="")for(var c=0;c<b.length;)if(typeof b[c]==="undefined"||b[c]===""||b[c]===null)b.splice(c,1);else c++;d[a]=this._parts.join(a)}return d[a]}};Sys.StringBuilder.registerClass("Sys.StringBuilder");Sys.Browser={};Sys.Browser.InternetExplorer={};Sys.Browser.Firefox={};Sys.Browser.Safari={};Sys.Browser.Opera={};Sys.Browser.agent=null;Sys.Browser.hasDebuggerStatement=false;Sys.Browser.name=navigator.appName;Sys.Browser.version=parseFloat(navigator.appVersion);Sys.Browser.documentMode=0;if(navigator.userAgent.indexOf(" MSIE ")>-1){Sys.Browser.agent=Sys.Browser.InternetExplorer;Sys.Browser.version=parseFloat(navigator.userAgent.match(/MSIE (\d+\.\d+)/)[1]);if(Sys.Browser.version>=8)if(document.documentMode>=7)Sys.Browser.documentMode=document.documentMode;Sys.Browser.hasDebuggerStatement=true}else if(navigator.userAgent.indexOf(" Firefox/")>-1){Sys.Browser.agent=Sys.Browser.Firefox;Sys.Browser.version=parseFloat(navigator.userAgent.match(/Firefox\/(\d+\.\d+)/)[1]);Sys.Browser.name="Firefox";Sys.Browser.hasDebuggerStatement=true}else if(navigator.userAgent.indexOf(" AppleWebKit/")>-1){Sys.Browser.agent=Sys.Browser.Safari;Sys.Browser.version=parseFloat(navigator.userAgent.match(/AppleWebKit\/(\d+(\.\d+)?)/)[1]);Sys.Browser.name="Safari"}else if(navigator.userAgent.indexOf("Opera/")>-1)Sys.Browser.agent=Sys.Browser.Opera;Sys.EventArgs=function(){};Sys.EventArgs.registerClass("Sys.EventArgs");Sys.EventArgs.Empty=new Sys.EventArgs;Sys.CancelEventArgs=function(){Sys.CancelEventArgs.initializeBase(this);this._cancel=false};Sys.CancelEventArgs.prototype={get_cancel:function(){return this._cancel},set_cancel:function(a){this._cancel=a}};Sys.CancelEventArgs.registerClass("Sys.CancelEventArgs",Sys.EventArgs);Type.registerNamespace("Sys.UI");Sys._Debug=function(){};Sys._Debug.prototype={_appendConsole:function(a){if(typeof Debug!=="undefined"&&Debug.writeln)Debug.writeln(a);if(window.console&&window.console.log)window.console.log(a);if(window.opera)window.opera.postError(a);if(window.debugService)window.debugService.trace(a)},_appendTrace:function(b){var a=document.getElementById("TraceConsole");if(a&&a.tagName.toUpperCase()==="TEXTAREA")a.value+=b+"\n"},assert:function(c,a,b){if(!c){a=b&&this.assert.caller?String.format(Sys.Res.assertFailedCaller,a,this.assert.caller):String.format(Sys.Res.assertFailed,a);if(confirm(String.format(Sys.Res.breakIntoDebugger,a)))this.fail(a)}},clearTrace:function(){var a=document.getElementById("TraceConsole");if(a&&a.tagName.toUpperCase()==="TEXTAREA")a.value=""},fail:function(message){this._appendConsole(message);if(Sys.Browser.hasDebuggerStatement)eval("debugger")},trace:function(a){this._appendConsole(a);this._appendTrace(a)},traceDump:function(a,b){var c=this._traceDump(a,b,true)},_traceDump:function(a,c,f,b,d){c=c?c:"traceDump";b=b?b:"";if(a===null){this.trace(b+c+": null");return}switch(typeof a){case"undefined":this.trace(b+c+": Undefined");break;case"number":case"string":case"boolean":this.trace(b+c+": "+a);break;default:if(Date.isInstanceOfType(a)||RegExp.isInstanceOfType(a)){this.trace(b+c+": "+a.toString());break}if(!d)d=[];else if(Array.contains(d,a)){this.trace(b+c+": ...");return}Array.add(d,a);if(a==window||a===document||window.HTMLElement&&a instanceof HTMLElement||typeof a.nodeName==="string"){var k=a.tagName?a.tagName:"DomElement";if(a.id)k+=" - "+a.id;this.trace(b+c+" {"+k+"}")}else{var i=Object.getTypeName(a);this.trace(b+c+(typeof i==="string"?" {"+i+"}":""));if(b===""||f){b+="    ";var e,j,l,g,h;if(Array.isInstanceOfType(a)){j=a.length;for(e=0;e<j;e++)this._traceDump(a[e],"["+e+"]",f,b,d)}else for(g in a){h=a[g];if(!Function.isInstanceOfType(h))this._traceDump(h,g,f,b,d)}}}Array.remove(d,a)}}};Sys._Debug.registerClass("Sys._Debug");Sys.Debug=new Sys._Debug;Sys.Debug.isDebug=false;function Sys$Enum$parse(c,e){var a,b,i;if(e){a=this.__lowerCaseValues;if(!a){this.__lowerCaseValues=a={};var g=this.prototype;for(var f in g)a[f.toLowerCase()]=g[f]}}else a=this.prototype;if(!this.__flags){i=e?c.toLowerCase():c;b=a[i.trim()];if(typeof b!=="number")throw Error.argument("value",String.format(Sys.Res.enumInvalidValue,c,this.__typeName));return b}else{var h=(e?c.toLowerCase():c).split(","),j=0;for(var d=h.length-1;d>=0;d--){var k=h[d].trim();b=a[k];if(typeof b!=="number")throw Error.argument("value",String.format(Sys.Res.enumInvalidValue,c.split(",")[d].trim(),this.__typeName));j|=b}return j}}function Sys$Enum$toString(c){if(typeof c==="undefined"||c===null)return this.__string;var d=this.prototype,a;if(!this.__flags||c===0){for(a in d)if(d[a]===c)return a}else{var b=this.__sortedValues;if(!b){b=[];for(a in d)b[b.length]={key:a,value:d[a]};b.sort(function(a,b){return a.value-b.value});this.__sortedValues=b}var e=[],g=c;for(a=b.length-1;a>=0;a--){var h=b[a],f=h.value;if(f===0)continue;if((f&c)===f){e[e.length]=h.key;g-=f;if(g===0)break}}if(e.length&&g===0)return e.reverse().join(", ")}return""}Type.prototype.registerEnum=function(b,c){Sys.__upperCaseTypes[b.toUpperCase()]=this;for(var a in this.prototype)this[a]=this.prototype[a];this.__typeName=b;this.parse=Sys$Enum$parse;this.__string=this.toString();this.toString=Sys$Enum$toString;this.__flags=c;this.__enum=true};Type.isEnum=function(a){if(typeof a==="undefined"||a===null)return false;return!!a.__enum};Type.isFlags=function(a){if(typeof a==="undefined"||a===null)return false;return!!a.__flags};Sys.CollectionChange=function(e,a,c,b,d){this.action=e;if(a)if(!(a instanceof Array))a=[a];this.newItems=a||null;if(typeof c!=="number")c=-1;this.newStartingIndex=c;if(b)if(!(b instanceof Array))b=[b];this.oldItems=b||null;if(typeof d!=="number")d=-1;this.oldStartingIndex=d};Sys.CollectionChange.registerClass("Sys.CollectionChange");Sys.NotifyCollectionChangedAction=function(){throw Error.notImplemented()};Sys.NotifyCollectionChangedAction.prototype={add:0,remove:1,reset:2};Sys.NotifyCollectionChangedAction.registerEnum("Sys.NotifyCollectionChangedAction");Sys.NotifyCollectionChangedEventArgs=function(a){this._changes=a;Sys.NotifyCollectionChangedEventArgs.initializeBase(this)};Sys.NotifyCollectionChangedEventArgs.prototype={get_changes:function(){return this._changes||[]}};Sys.NotifyCollectionChangedEventArgs.registerClass("Sys.NotifyCollectionChangedEventArgs",Sys.EventArgs);Sys.Observer=function(){};Sys.Observer.registerClass("Sys.Observer");Sys.Observer.makeObservable=function(a){var c=a instanceof Array,b=Sys.Observer;if(a.setValue===b._observeMethods.setValue)return a;b._addMethods(a,b._observeMethods);if(c)b._addMethods(a,b._arrayMethods);return a};Sys.Observer._addMethods=function(c,b){for(var a in b)c[a]=b[a]};Sys.Observer._addEventHandler=function(c,a,b){Sys.Observer._getContext(c,true).events._addHandler(a,b)};Sys.Observer.addEventHandler=function(c,a,b){Sys.Observer._addEventHandler(c,a,b)};Sys.Observer._removeEventHandler=function(c,a,b){Sys.Observer._getContext(c,true).events._removeHandler(a,b)};Sys.Observer.removeEventHandler=function(c,a,b){Sys.Observer._removeEventHandler(c,a,b)};Sys.Observer.raiseEvent=function(b,e,d){var c=Sys.Observer._getContext(b);if(!c)return;var a=c.events.getHandler(e);if(a)a(b,d)};Sys.Observer.addPropertyChanged=function(b,a){Sys.Observer._addEventHandler(b,"propertyChanged",a)};Sys.Observer.removePropertyChanged=function(b,a){Sys.Observer._removeEventHandler(b,"propertyChanged",a)};Sys.Observer.beginUpdate=function(a){Sys.Observer._getContext(a,true).updating=true};Sys.Observer.endUpdate=function(b){var a=Sys.Observer._getContext(b);if(!a||!a.updating)return;a.updating=false;var d=a.dirty;a.dirty=false;if(d){if(b instanceof Array){var c=a.changes;a.changes=null;Sys.Observer.raiseCollectionChanged(b,c)}Sys.Observer.raisePropertyChanged(b,"")}};Sys.Observer.isUpdating=function(b){var a=Sys.Observer._getContext(b);return a?a.updating:false};Sys.Observer._setValue=function(a,j,g){var b,f,k=a,d=j.split(".");for(var i=0,m=d.length-1;i<m;i++){var l=d[i];b=a["get_"+l];if(typeof b==="function")a=b.call(a);else a=a[l];var n=typeof a;if(a===null||n==="undefined")throw Error.invalidOperation(String.format(Sys.Res.nullReferenceInPath,j))}var e,c=d[m];b=a["get_"+c];f=a["set_"+c];if(typeof b==="function")e=b.call(a);else e=a[c];if(typeof f==="function")f.call(a,g);else a[c]=g;if(e!==g){var h=Sys.Observer._getContext(k);if(h&&h.updating){h.dirty=true;return}Sys.Observer.raisePropertyChanged(k,d[0])}};Sys.Observer.setValue=function(b,a,c){Sys.Observer._setValue(b,a,c)};Sys.Observer.raisePropertyChanged=function(b,a){Sys.Observer.raiseEvent(b,"propertyChanged",new Sys.PropertyChangedEventArgs(a))};Sys.Observer.addCollectionChanged=function(b,a){Sys.Observer._addEventHandler(b,"collectionChanged",a)};Sys.Observer.removeCollectionChanged=function(b,a){Sys.Observer._removeEventHandler(b,"collectionChanged",a)};Sys.Observer._collectionChange=function(d,c){var a=Sys.Observer._getContext(d);if(a&&a.updating){a.dirty=true;var b=a.changes;if(!b)a.changes=b=[c];else b.push(c)}else{Sys.Observer.raiseCollectionChanged(d,[c]);Sys.Observer.raisePropertyChanged(d,"length")}};Sys.Observer.add=function(a,b){var c=new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.add,[b],a.length);Array.add(a,b);Sys.Observer._collectionChange(a,c)};Sys.Observer.addRange=function(a,b){var c=new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.add,b,a.length);Array.addRange(a,b);Sys.Observer._collectionChange(a,c)};Sys.Observer.clear=function(a){var b=Array.clone(a);Array.clear(a);Sys.Observer._collectionChange(a,new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.reset,null,-1,b,0))};Sys.Observer.insert=function(a,b,c){Array.insert(a,b,c);Sys.Observer._collectionChange(a,new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.add,[c],b))};Sys.Observer.remove=function(a,b){var c=Array.indexOf(a,b);if(c!==-1){Array.remove(a,b);Sys.Observer._collectionChange(a,new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.remove,null,-1,[b],c));return true}return false};Sys.Observer.removeAt=function(b,a){if(a>-1&&a<b.length){var c=b[a];Array.removeAt(b,a);Sys.Observer._collectionChange(b,new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.remove,null,-1,[c],a))}};Sys.Observer.raiseCollectionChanged=function(b,a){Sys.Observer.raiseEvent(b,"collectionChanged",new Sys.NotifyCollectionChangedEventArgs(a))};Sys.Observer._observeMethods={add_propertyChanged:function(a){Sys.Observer._addEventHandler(this,"propertyChanged",a)},remove_propertyChanged:function(a){Sys.Observer._removeEventHandler(this,"propertyChanged",a)},addEventHandler:function(a,b){Sys.Observer._addEventHandler(this,a,b)},removeEventHandler:function(a,b){Sys.Observer._removeEventHandler(this,a,b)},get_isUpdating:function(){return Sys.Observer.isUpdating(this)},beginUpdate:function(){Sys.Observer.beginUpdate(this)},endUpdate:function(){Sys.Observer.endUpdate(this)},setValue:function(b,a){Sys.Observer._setValue(this,b,a)},raiseEvent:function(b,a){Sys.Observer.raiseEvent(this,b,a)},raisePropertyChanged:function(a){Sys.Observer.raiseEvent(this,"propertyChanged",new Sys.PropertyChangedEventArgs(a))}};Sys.Observer._arrayMethods={add_collectionChanged:function(a){Sys.Observer._addEventHandler(this,"collectionChanged",a)},remove_collectionChanged:function(a){Sys.Observer._removeEventHandler(this,"collectionChanged",a)},add:function(a){Sys.Observer.add(this,a)},addRange:function(a){Sys.Observer.addRange(this,a)},clear:function(){Sys.Observer.clear(this)},insert:function(a,b){Sys.Observer.insert(this,a,b)},remove:function(a){return Sys.Observer.remove(this,a)},removeAt:function(a){Sys.Observer.removeAt(this,a)},raiseCollectionChanged:function(a){Sys.Observer.raiseEvent(this,"collectionChanged",new Sys.NotifyCollectionChangedEventArgs(a))}};Sys.Observer._getContext=function(b,c){var a=b._observerContext;if(a)return a();if(c)return(b._observerContext=Sys.Observer._createContext())();return null};Sys.Observer._createContext=function(){var a={events:new Sys.EventHandlerList};return function(){return a}};Date._appendPreOrPostMatch=function(e,b){var d=0,a=false;for(var c=0,g=e.length;c<g;c++){var f=e.charAt(c);switch(f){case"'":if(a)b.append("'");else d++;a=false;break;case"\\":if(a)b.append("\\");a=!a;break;default:b.append(f);a=false}}return d};Date._expandFormat=function(a,b){if(!b)b="F";var c=b.length;if(c===1)switch(b){case"d":return a.ShortDatePattern;case"D":return a.LongDatePattern;case"t":return a.ShortTimePattern;case"T":return a.LongTimePattern;case"f":return a.LongDatePattern+" "+a.ShortTimePattern;case"F":return a.FullDateTimePattern;case"M":case"m":return a.MonthDayPattern;case"s":return a.SortableDateTimePattern;case"Y":case"y":return a.YearMonthPattern;default:throw Error.format(Sys.Res.formatInvalidString)}else if(c===2&&b.charAt(0)==="%")b=b.charAt(1);return b};Date._expandYear=function(c,a){var d=new Date,e=Date._getEra(d);if(a<100){var b=Date._getEraYear(d,c,e);a+=b-b%100;if(a>c.Calendar.TwoDigitYearMax)a-=100}return a};Date._getEra=function(e,c){if(!c)return 0;var b,d=e.getTime();for(var a=0,f=c.length;a<f;a+=4){b=c[a+2];if(b===null||d>=b)return a}return 0};Date._getEraYear=function(d,b,e,c){var a=d.getFullYear();if(!c&&b.eras)a-=b.eras[e+3];return a};Date._getParseRegExp=function(b,e){if(!b._parseRegExp)b._parseRegExp={};else if(b._parseRegExp[e])return b._parseRegExp[e];var c=Date._expandFormat(b,e);c=c.replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1");var a=new Sys.StringBuilder("^"),j=[],f=0,i=0,h=Date._getTokenRegExp(),d;while((d=h.exec(c))!==null){var l=c.slice(f,d.index);f=h.lastIndex;i+=Date._appendPreOrPostMatch(l,a);if(i%2===1){a.append(d[0]);continue}switch(d[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gg":case"g":a.append("(\\D+)");break;case"tt":case"t":a.append("(\\D*)");break;case"yyyy":a.append("(\\d{4})");break;case"fff":a.append("(\\d{3})");break;case"ff":a.append("(\\d{2})");break;case"f":a.append("(\\d)");break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":a.append("(\\d\\d?)");break;case"zzz":a.append("([+-]?\\d\\d?:\\d{2})");break;case"zz":case"z":a.append("([+-]?\\d\\d?)");break;case"/":a.append("(\\"+b.DateSeparator+")")}Array.add(j,d[0])}Date._appendPreOrPostMatch(c.slice(f),a);a.append("$");var k=a.toString().replace(/\s+/g,"\\s+"),g={"regExp":k,"groups":j};b._parseRegExp[e]=g;return g};Date._getTokenRegExp=function(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g};Date.parseLocale=function(a){return Date._parse(a,Sys.CultureInfo.CurrentCulture,arguments)};Date.parseInvariant=function(a){return Date._parse(a,Sys.CultureInfo.InvariantCulture,arguments)};Date._parse=function(h,d,i){var a,c,b,f,e,g=false;for(a=1,c=i.length;a<c;a++){f=i[a];if(f){g=true;b=Date._parseExact(h,f,d);if(b)return b}}if(!g){e=d._getDateTimeFormats();for(a=0,c=e.length;a<c;a++){b=Date._parseExact(h,e[a],d);if(b)return b}}return null};Date._parseExact=function(w,D,k){w=w.trim();var g=k.dateTimeFormat,A=Date._getParseRegExp(g,D),C=(new RegExp(A.regExp)).exec(w);if(C===null)return null;var B=A.groups,x=null,e=null,c=null,j=null,i=null,d=0,h,p=0,q=0,f=0,l=null,v=false;for(var s=0,E=B.length;s<E;s++){var a=C[s+1];if(a)switch(B[s]){case"dd":case"d":j=parseInt(a,10);if(j<1||j>31)return null;break;case"MMMM":c=k._getMonthIndex(a);if(c<0||c>11)return null;break;case"MMM":c=k._getAbbrMonthIndex(a);if(c<0||c>11)return null;break;case"M":case"MM":c=parseInt(a,10)-1;if(c<0||c>11)return null;break;case"y":case"yy":e=Date._expandYear(g,parseInt(a,10));if(e<0||e>9999)return null;break;case"yyyy":e=parseInt(a,10);if(e<0||e>9999)return null;break;case"h":case"hh":d=parseInt(a,10);if(d===12)d=0;if(d<0||d>11)return null;break;case"H":case"HH":d=parseInt(a,10);if(d<0||d>23)return null;break;case"m":case"mm":p=parseInt(a,10);if(p<0||p>59)return null;break;case"s":case"ss":q=parseInt(a,10);if(q<0||q>59)return null;break;case"tt":case"t":var z=a.toUpperCase();v=z===g.PMDesignator.toUpperCase();if(!v&&z!==g.AMDesignator.toUpperCase())return null;break;case"f":f=parseInt(a,10)*100;if(f<0||f>999)return null;break;case"ff":f=parseInt(a,10)*10;if(f<0||f>999)return null;break;case"fff":f=parseInt(a,10);if(f<0||f>999)return null;break;case"dddd":i=k._getDayIndex(a);if(i<0||i>6)return null;break;case"ddd":i=k._getAbbrDayIndex(a);if(i<0||i>6)return null;break;case"zzz":var u=a.split(/:/);if(u.length!==2)return null;h=parseInt(u[0],10);if(h<-12||h>13)return null;var m=parseInt(u[1],10);if(m<0||m>59)return null;l=h*60+(a.startsWith("-")?-m:m);break;case"z":case"zz":h=parseInt(a,10);if(h<-12||h>13)return null;l=h*60;break;case"g":case"gg":var o=a;if(!o||!g.eras)return null;o=o.toLowerCase().trim();for(var r=0,F=g.eras.length;r<F;r+=4)if(o===g.eras[r+1].toLowerCase()){x=r;break}if(x===null)return null}}var b=new Date,t,n=g.Calendar.convert;if(n)t=n.fromGregorian(b)[0];else t=b.getFullYear();if(e===null)e=t;else if(g.eras)e+=g.eras[(x||0)+3];if(c===null)c=0;if(j===null)j=1;if(n){b=n.toGregorian(e,c,j);if(b===null)return null}else{b.setFullYear(e,c,j);if(b.getDate()!==j)return null;if(i!==null&&b.getDay()!==i)return null}if(v&&d<12)d+=12;b.setHours(d,p,q,f);if(l!==null){var y=b.getMinutes()-(l+b.getTimezoneOffset());b.setHours(b.getHours()+parseInt(y/60,10),y%60)}return b};Date.prototype.format=function(a){return this._toFormattedString(a,Sys.CultureInfo.InvariantCulture)};Date.prototype.localeFormat=function(a){return this._toFormattedString(a,Sys.CultureInfo.CurrentCulture)};Date.prototype._toFormattedString=function(e,j){var b=j.dateTimeFormat,n=b.Calendar.convert;if(!e||!e.length||e==="i")if(j&&j.name.length)if(n)return this._toFormattedString(b.FullDateTimePattern,j);else{var r=new Date(this.getTime()),x=Date._getEra(this,b.eras);r.setFullYear(Date._getEraYear(this,b,x));return r.toLocaleString()}else return this.toString();var l=b.eras,k=e==="s";e=Date._expandFormat(b,e);var a=new Sys.StringBuilder,c;function d(a){if(a<10)return"0"+a;return a.toString()}function m(a){if(a<10)return"00"+a;if(a<100)return"0"+a;return a.toString()}function v(a){if(a<10)return"000"+a;else if(a<100)return"00"+a;else if(a<1000)return"0"+a;return a.toString()}var h,p,t=/([^d]|^)(d|dd)([^d]|$)/g;function s(){if(h||p)return h;h=t.test(e);p=true;return h}var q=0,o=Date._getTokenRegExp(),f;if(!k&&n)f=n.fromGregorian(this);for(;true;){var w=o.lastIndex,i=o.exec(e),u=e.slice(w,i?i.index:e.length);q+=Date._appendPreOrPostMatch(u,a);if(!i)break;if(q%2===1){a.append(i[0]);continue}function g(a,b){if(f)return f[b];switch(b){case 0:return a.getFullYear();case 1:return a.getMonth();case 2:return a.getDate()}}switch(i[0]){case"dddd":a.append(b.DayNames[this.getDay()]);break;case"ddd":a.append(b.AbbreviatedDayNames[this.getDay()]);break;case"dd":h=true;a.append(d(g(this,2)));break;case"d":h=true;a.append(g(this,2));break;case"MMMM":a.append(b.MonthGenitiveNames&&s()?b.MonthGenitiveNames[g(this,1)]:b.MonthNames[g(this,1)]);break;case"MMM":a.append(b.AbbreviatedMonthGenitiveNames&&s()?b.AbbreviatedMonthGenitiveNames[g(this,1)]:b.AbbreviatedMonthNames[g(this,1)]);break;case"MM":a.append(d(g(this,1)+1));break;case"M":a.append(g(this,1)+1);break;case"yyyy":a.append(v(f?f[0]:Date._getEraYear(this,b,Date._getEra(this,l),k)));break;case"yy":a.append(d((f?f[0]:Date._getEraYear(this,b,Date._getEra(this,l),k))%100));break;case"y":a.append((f?f[0]:Date._getEraYear(this,b,Date._getEra(this,l),k))%100);break;case"hh":c=this.getHours()%12;if(c===0)c=12;a.append(d(c));break;case"h":c=this.getHours()%12;if(c===0)c=12;a.append(c);break;case"HH":a.append(d(this.getHours()));break;case"H":a.append(this.getHours());break;case"mm":a.append(d(this.getMinutes()));break;case"m":a.append(this.getMinutes());break;case"ss":a.append(d(this.getSeconds()));break;case"s":a.append(this.getSeconds());break;case"tt":a.append(this.getHours()<12?b.AMDesignator:b.PMDesignator);break;case"t":a.append((this.getHours()<12?b.AMDesignator:b.PMDesignator).charAt(0));break;case"f":a.append(m(this.getMilliseconds()).charAt(0));break;case"ff":a.append(m(this.getMilliseconds()).substr(0,2));break;case"fff":a.append(m(this.getMilliseconds()));break;case"z":c=this.getTimezoneOffset()/60;a.append((c<=0?"+":"-")+Math.floor(Math.abs(c)));break;case"zz":c=this.getTimezoneOffset()/60;a.append((c<=0?"+":"-")+d(Math.floor(Math.abs(c))));break;case"zzz":c=this.getTimezoneOffset()/60;a.append((c<=0?"+":"-")+d(Math.floor(Math.abs(c)))+":"+d(Math.abs(this.getTimezoneOffset()%60)));break;case"g":case"gg":if(b.eras)a.append(b.eras[Date._getEra(this,l)+1]);break;case"/":a.append(b.DateSeparator)}}return a.toString()};String.localeFormat=function(){return String._toFormattedString(true,arguments)};Number.parseLocale=function(a){return Number._parse(a,Sys.CultureInfo.CurrentCulture)};Number.parseInvariant=function(a){return Number._parse(a,Sys.CultureInfo.InvariantCulture)};Number._parse=function(b,o){b=b.trim();if(b.match(/^[+-]?infinity$/i))return parseFloat(b);if(b.match(/^0x[a-f0-9]+$/i))return parseInt(b);var a=o.numberFormat,g=Number._parseNumberNegativePattern(b,a,a.NumberNegativePattern),h=g[0],e=g[1];if(h===""&&a.NumberNegativePattern!==1){g=Number._parseNumberNegativePattern(b,a,1);h=g[0];e=g[1]}if(h==="")h="+";var j,d,f=e.indexOf("e");if(f<0)f=e.indexOf("E");if(f<0){d=e;j=null}else{d=e.substr(0,f);j=e.substr(f+1)}var c,k,m=d.indexOf(a.NumberDecimalSeparator);if(m<0){c=d;k=null}else{c=d.substr(0,m);k=d.substr(m+a.NumberDecimalSeparator.length)}c=c.split(a.NumberGroupSeparator).join("");var n=a.NumberGroupSeparator.replace(/\u00A0/g," ");if(a.NumberGroupSeparator!==n)c=c.split(n).join("");var l=h+c;if(k!==null)l+="."+k;if(j!==null){var i=Number._parseNumberNegativePattern(j,a,1);if(i[0]==="")i[0]="+";l+="e"+i[0]+i[1]}if(l.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/))return parseFloat(l);return Number.NaN};Number._parseNumberNegativePattern=function(a,d,e){var b=d.NegativeSign,c=d.PositiveSign;switch(e){case 4:b=" "+b;c=" "+c;case 3:if(a.endsWith(b))return["-",a.substr(0,a.length-b.length)];else if(a.endsWith(c))return["+",a.substr(0,a.length-c.length)];break;case 2:b+=" ";c+=" ";case 1:if(a.startsWith(b))return["-",a.substr(b.length)];else if(a.startsWith(c))return["+",a.substr(c.length)];break;case 0:if(a.startsWith("(")&&a.endsWith(")"))return["-",a.substr(1,a.length-2)]}return["",a]};Number.prototype.format=function(a){return this._toFormattedString(a,Sys.CultureInfo.InvariantCulture)};Number.prototype.localeFormat=function(a){return this._toFormattedString(a,Sys.CultureInfo.CurrentCulture)};Number.prototype._toFormattedString=function(e,j){if(!e||e.length===0||e==="i")if(j&&j.name.length>0)return this.toLocaleString();else return this.toString();var o=["n %","n%","%n"],n=["-n %","-n%","-%n"],p=["(n)","-n","- n","n-","n -"],m=["$n","n$","$ n","n $"],l=["($n)","-$n","$-n","$n-","(n$)","-n$","n-$","n$-","-n $","-$ n","n $-","$ n-","$ -n","n- $","($ n)","(n $)"];function g(a,c,d){for(var b=a.length;b<c;b++)a=d?"0"+a:a+"0";return a}function i(j,i,l,n,p){var h=l[0],k=1,o=Math.pow(10,i),m=Math.round(j*o)/o;if(!isFinite(m))m=j;j=m;var b=j.toString(),a="",c,e=b.split(/e/i);b=e[0];c=e.length>1?parseInt(e[1]):0;e=b.split(".");b=e[0];a=e.length>1?e[1]:"";var q;if(c>0){a=g(a,c,false);b+=a.slice(0,c);a=a.substr(c)}else if(c<0){c=-c;b=g(b,c+1,true);a=b.slice(-c,b.length)+a;b=b.slice(0,-c)}if(i>0){if(a.length>i)a=a.slice(0,i);else a=g(a,i,false);a=p+a}else a="";var d=b.length-1,f="";while(d>=0){if(h===0||h>d)if(f.length>0)return b.slice(0,d+1)+n+f+a;else return b.slice(0,d+1)+a;if(f.length>0)f=b.slice(d-h+1,d+1)+n+f;else f=b.slice(d-h+1,d+1);d-=h;if(k<l.length){h=l[k];k++}}return b.slice(0,d+1)+n+f+a}var a=j.numberFormat,d=Math.abs(this);if(!e)e="D";var b=-1;if(e.length>1)b=parseInt(e.slice(1),10);var c;switch(e.charAt(0)){case"d":case"D":c="n";if(b!==-1)d=g(""+d,b,true);if(this<0)d=-d;break;case"c":case"C":if(this<0)c=l[a.CurrencyNegativePattern];else c=m[a.CurrencyPositivePattern];if(b===-1)b=a.CurrencyDecimalDigits;d=i(Math.abs(this),b,a.CurrencyGroupSizes,a.CurrencyGroupSeparator,a.CurrencyDecimalSeparator);break;case"n":case"N":if(this<0)c=p[a.NumberNegativePattern];else c="n";if(b===-1)b=a.NumberDecimalDigits;d=i(Math.abs(this),b,a.NumberGroupSizes,a.NumberGroupSeparator,a.NumberDecimalSeparator);break;case"p":case"P":if(this<0)c=n[a.PercentNegativePattern];else c=o[a.PercentPositivePattern];if(b===-1)b=a.PercentDecimalDigits;d=i(Math.abs(this)*100,b,a.PercentGroupSizes,a.PercentGroupSeparator,a.PercentDecimalSeparator);break;default:throw Error.format(Sys.Res.formatBadFormatSpecifier)}var k=/n|\$|-|%/g,f="";for(;true;){var q=k.lastIndex,h=k.exec(c);f+=c.slice(q,h?h.index:c.length);if(!h)break;switch(h[0]){case"n":f+=d;break;case"$":f+=a.CurrencySymbol;break;case"-":if(/[1-9]/.test(d))f+=a.NegativeSign;break;case"%":f+=a.PercentSymbol}}return f};Sys.CultureInfo=function(c,b,a){this.name=c;this.numberFormat=b;this.dateTimeFormat=a};Sys.CultureInfo.prototype={_getDateTimeFormats:function(){if(!this._dateTimeFormats){var a=this.dateTimeFormat;this._dateTimeFormats=[a.MonthDayPattern,a.YearMonthPattern,a.ShortDatePattern,a.ShortTimePattern,a.LongDatePattern,a.LongTimePattern,a.FullDateTimePattern,a.RFC1123Pattern,a.SortableDateTimePattern,a.UniversalSortableDateTimePattern]}return this._dateTimeFormats},_getIndex:function(c,d,e){var b=this._toUpper(c),a=Array.indexOf(d,b);if(a===-1)a=Array.indexOf(e,b);return a},_getMonthIndex:function(a){if(!this._upperMonths){this._upperMonths=this._toUpperArray(this.dateTimeFormat.MonthNames);this._upperMonthsGenitive=this._toUpperArray(this.dateTimeFormat.MonthGenitiveNames)}return this._getIndex(a,this._upperMonths,this._upperMonthsGenitive)},_getAbbrMonthIndex:function(a){if(!this._upperAbbrMonths){this._upperAbbrMonths=this._toUpperArray(this.dateTimeFormat.AbbreviatedMonthNames);this._upperAbbrMonthsGenitive=this._toUpperArray(this.dateTimeFormat.AbbreviatedMonthGenitiveNames)}return this._getIndex(a,this._upperAbbrMonths,this._upperAbbrMonthsGenitive)},_getDayIndex:function(a){if(!this._upperDays)this._upperDays=this._toUpperArray(this.dateTimeFormat.DayNames);return Array.indexOf(this._upperDays,this._toUpper(a))},_getAbbrDayIndex:function(a){if(!this._upperAbbrDays)this._upperAbbrDays=this._toUpperArray(this.dateTimeFormat.AbbreviatedDayNames);return Array.indexOf(this._upperAbbrDays,this._toUpper(a))},_toUpperArray:function(c){var b=[];for(var a=0,d=c.length;a<d;a++)b[a]=this._toUpper(c[a]);return b},_toUpper:function(a){return a.split("\u00a0").join(" ").toUpperCase()}};Sys.CultureInfo.registerClass("Sys.CultureInfo");Sys.CultureInfo._parse=function(a){var b=a.dateTimeFormat;if(b&&!b.eras)b.eras=a.eras;return new Sys.CultureInfo(a.name,a.numberFormat,b)};Sys.CultureInfo.InvariantCulture=Sys.CultureInfo._parse({"name":"","numberFormat":{"CurrencyDecimalDigits":2,"CurrencyDecimalSeparator":".","IsReadOnly":true,"CurrencyGroupSizes":[3],"NumberGroupSizes":[3],"PercentGroupSizes":[3],"CurrencyGroupSeparator":",","CurrencySymbol":"\u00a4","NaNSymbol":"NaN","CurrencyNegativePattern":0,"NumberNegativePattern":1,"PercentPositivePattern":0,"PercentNegativePattern":0,"NegativeInfinitySymbol":"-Infinity","NegativeSign":"-","NumberDecimalDigits":2,"NumberDecimalSeparator":".","NumberGroupSeparator":",","CurrencyPositivePattern":0,"PositiveInfinitySymbol":"Infinity","PositiveSign":"+","PercentDecimalDigits":2,"PercentDecimalSeparator":".","PercentGroupSeparator":",","PercentSymbol":"%","PerMilleSymbol":"\u2030","NativeDigits":["0","1","2","3","4","5","6","7","8","9"],"DigitSubstitution":1},"dateTimeFormat":{"AMDesignator":"AM","Calendar":{"MinSupportedDateTime":"@-62135568000000@","MaxSupportedDateTime":"@253402300799999@","AlgorithmType":1,"CalendarType":1,"Eras":[1],"TwoDigitYearMax":2029,"IsReadOnly":true},"DateSeparator":"/","FirstDayOfWeek":0,"CalendarWeekRule":0,"FullDateTimePattern":"dddd, dd MMMM yyyy HH:mm:ss","LongDatePattern":"dddd, dd MMMM yyyy","LongTimePattern":"HH:mm:ss","MonthDayPattern":"MMMM dd","PMDesignator":"PM","RFC1123Pattern":"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'","ShortDatePattern":"MM/dd/yyyy","ShortTimePattern":"HH:mm","SortableDateTimePattern":"yyyy'-'MM'-'dd'T'HH':'mm':'ss","TimeSeparator":":","UniversalSortableDateTimePattern":"yyyy'-'MM'-'dd HH':'mm':'ss'Z'","YearMonthPattern":"yyyy MMMM","AbbreviatedDayNames":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"ShortestDayNames":["Su","Mo","Tu","We","Th","Fr","Sa"],"DayNames":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"AbbreviatedMonthNames":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],"MonthNames":["January","February","March","April","May","June","July","August","September","October","November","December",""],"IsReadOnly":true,"NativeCalendarName":"Gregorian Calendar","AbbreviatedMonthGenitiveNames":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],"MonthGenitiveNames":["January","February","March","April","May","June","July","August","September","October","November","December",""]},"eras":[1,"A.D.",null,0]});if(typeof __cultureInfo==="object"){Sys.CultureInfo.CurrentCulture=Sys.CultureInfo._parse(__cultureInfo);delete __cultureInfo}else Sys.CultureInfo.CurrentCulture=Sys.CultureInfo._parse({"name":"en-US","numberFormat":{"CurrencyDecimalDigits":2,"CurrencyDecimalSeparator":".","IsReadOnly":false,"CurrencyGroupSizes":[3],"NumberGroupSizes":[3],"PercentGroupSizes":[3],"CurrencyGroupSeparator":",","CurrencySymbol":"$","NaNSymbol":"NaN","CurrencyNegativePattern":0,"NumberNegativePattern":1,"PercentPositivePattern":0,"PercentNegativePattern":0,"NegativeInfinitySymbol":"-Infinity","NegativeSign":"-","NumberDecimalDigits":2,"NumberDecimalSeparator":".","NumberGroupSeparator":",","CurrencyPositivePattern":0,"PositiveInfinitySymbol":"Infinity","PositiveSign":"+","PercentDecimalDigits":2,"PercentDecimalSeparator":".","PercentGroupSeparator":",","PercentSymbol":"%","PerMilleSymbol":"\u2030","NativeDigits":["0","1","2","3","4","5","6","7","8","9"],"DigitSubstitution":1},"dateTimeFormat":{"AMDesignator":"AM","Calendar":{"MinSupportedDateTime":"@-62135568000000@","MaxSupportedDateTime":"@253402300799999@","AlgorithmType":1,"CalendarType":1,"Eras":[1],"TwoDigitYearMax":2029,"IsReadOnly":false},"DateSeparator":"/","FirstDayOfWeek":0,"CalendarWeekRule":0,"FullDateTimePattern":"dddd, MMMM dd, yyyy h:mm:ss tt","LongDatePattern":"dddd, MMMM dd, yyyy","LongTimePattern":"h:mm:ss tt","MonthDayPattern":"MMMM dd","PMDesignator":"PM","RFC1123Pattern":"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'","ShortDatePattern":"M/d/yyyy","ShortTimePattern":"h:mm tt","SortableDateTimePattern":"yyyy'-'MM'-'dd'T'HH':'mm':'ss","TimeSeparator":":","UniversalSortableDateTimePattern":"yyyy'-'MM'-'dd HH':'mm':'ss'Z'","YearMonthPattern":"MMMM, yyyy","AbbreviatedDayNames":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"ShortestDayNames":["Su","Mo","Tu","We","Th","Fr","Sa"],"DayNames":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"AbbreviatedMonthNames":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],"MonthNames":["January","February","March","April","May","June","July","August","September","October","November","December",""],"IsReadOnly":false,"NativeCalendarName":"Gregorian Calendar","AbbreviatedMonthGenitiveNames":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],"MonthGenitiveNames":["January","February","March","April","May","June","July","August","September","October","November","December",""]},"eras":[1,"A.D.",null,0]});Type.registerNamespace("Sys.Serialization");Sys.Serialization.JavaScriptSerializer=function(){};Sys.Serialization.JavaScriptSerializer.registerClass("Sys.Serialization.JavaScriptSerializer");Sys.Serialization.JavaScriptSerializer._charsToEscapeRegExs=[];Sys.Serialization.JavaScriptSerializer._charsToEscape=[];Sys.Serialization.JavaScriptSerializer._dateRegEx=new RegExp('(^|[^\\\\])\\"\\\\/Date\\((-?[0-9]+)(?:[a-zA-Z]|(?:\\+|-)[0-9]{4})?\\)\\\\/\\"',"g");Sys.Serialization.JavaScriptSerializer._escapeChars={};Sys.Serialization.JavaScriptSerializer._escapeRegEx=new RegExp('["\\\\\\x00-\\x1F]',"i");Sys.Serialization.JavaScriptSerializer._escapeRegExGlobal=new RegExp('["\\\\\\x00-\\x1F]',"g");Sys.Serialization.JavaScriptSerializer._jsonRegEx=new RegExp("[^,:{}\\[\\]0-9.\\-+Eaeflnr-u \\n\\r\\t]","g");Sys.Serialization.JavaScriptSerializer._jsonStringRegEx=new RegExp('"(\\\\.|[^"\\\\])*"',"g");Sys.Serialization.JavaScriptSerializer._serverTypeFieldName="__type";Sys.Serialization.JavaScriptSerializer._init=function(){var c=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000b","\\f","\\r","\\u000e","\\u000f","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001a","\\u001b","\\u001c","\\u001d","\\u001e","\\u001f"];Sys.Serialization.JavaScriptSerializer._charsToEscape[0]="\\";Sys.Serialization.JavaScriptSerializer._charsToEscapeRegExs["\\"]=new RegExp("\\\\","g");Sys.Serialization.JavaScriptSerializer._escapeChars["\\"]="\\\\";Sys.Serialization.JavaScriptSerializer._charsToEscape[1]='"';Sys.Serialization.JavaScriptSerializer._charsToEscapeRegExs['"']=new RegExp('"',"g");Sys.Serialization.JavaScriptSerializer._escapeChars['"']='\\"';for(var a=0;a<32;a++){var b=String.fromCharCode(a);Sys.Serialization.JavaScriptSerializer._charsToEscape[a+2]=b;Sys.Serialization.JavaScriptSerializer._charsToEscapeRegExs[b]=new RegExp(b,"g");Sys.Serialization.JavaScriptSerializer._escapeChars[b]=c[a]}};Sys.Serialization.JavaScriptSerializer._serializeBooleanWithBuilder=function(b,a){a.append(b.toString())};Sys.Serialization.JavaScriptSerializer._serializeNumberWithBuilder=function(a,b){if(isFinite(a))b.append(String(a));else throw Error.invalidOperation(Sys.Res.cannotSerializeNonFiniteNumbers)};Sys.Serialization.JavaScriptSerializer._serializeStringWithBuilder=function(a,c){c.append('"');if(Sys.Serialization.JavaScriptSerializer._escapeRegEx.test(a)){if(Sys.Serialization.JavaScriptSerializer._charsToEscape.length===0)Sys.Serialization.JavaScriptSerializer._init();if(a.length<128)a=a.replace(Sys.Serialization.JavaScriptSerializer._escapeRegExGlobal,function(a){return Sys.Serialization.JavaScriptSerializer._escapeChars[a]});else for(var d=0;d<34;d++){var b=Sys.Serialization.JavaScriptSerializer._charsToEscape[d];if(a.indexOf(b)!==-1)if(Sys.Browser.agent===Sys.Browser.Opera||Sys.Browser.agent===Sys.Browser.FireFox)a=a.split(b).join(Sys.Serialization.JavaScriptSerializer._escapeChars[b]);else a=a.replace(Sys.Serialization.JavaScriptSerializer._charsToEscapeRegExs[b],Sys.Serialization.JavaScriptSerializer._escapeChars[b])}}c.append(a);c.append('"')};Sys.Serialization.JavaScriptSerializer._serializeWithBuilder=function(b,a,i,g){var c;switch(typeof b){case"object":if(b)if(Number.isInstanceOfType(b))Sys.Serialization.JavaScriptSerializer._serializeNumberWithBuilder(b,a);else if(Boolean.isInstanceOfType(b))Sys.Serialization.JavaScriptSerializer._serializeBooleanWithBuilder(b,a);else if(String.isInstanceOfType(b))Sys.Serialization.JavaScriptSerializer._serializeStringWithBuilder(b,a);else if(Array.isInstanceOfType(b)){a.append("[");for(c=0;c<b.length;++c){if(c>0)a.append(",");Sys.Serialization.JavaScriptSerializer._serializeWithBuilder(b[c],a,false,g)}a.append("]")}else{if(Date.isInstanceOfType(b)){a.append('"\\/Date(');a.append(b.getTime());a.append(')\\/"');break}var d=[],f=0;for(var e in b){if(e.startsWith("$"))continue;if(e===Sys.Serialization.JavaScriptSerializer._serverTypeFieldName&&f!==0){d[f++]=d[0];d[0]=e}else d[f++]=e}if(i)d.sort();a.append("{");var j=false;for(c=0;c<f;c++){var h=b[d[c]];if(typeof h!=="undefined"&&typeof h!=="function"){if(j)a.append(",");else j=true;Sys.Serialization.JavaScriptSerializer._serializeWithBuilder(d[c],a,i,g);a.append(":");Sys.Serialization.JavaScriptSerializer._serializeWithBuilder(h,a,i,g)}}a.append("}")}else a.append("null");break;case"number":Sys.Serialization.JavaScriptSerializer._serializeNumberWithBuilder(b,a);break;case"string":Sys.Serialization.JavaScriptSerializer._serializeStringWithBuilder(b,a);break;case"boolean":Sys.Serialization.JavaScriptSerializer._serializeBooleanWithBuilder(b,a);break;default:a.append("null")}};Sys.Serialization.JavaScriptSerializer.serialize=function(b){var a=new Sys.StringBuilder;Sys.Serialization.JavaScriptSerializer._serializeWithBuilder(b,a,false);return a.toString()};Sys.Serialization.JavaScriptSerializer.deserialize=function(data,secure){if(data.length===0)throw Error.argument("data",Sys.Res.cannotDeserializeEmptyString);try{var exp=data.replace(Sys.Serialization.JavaScriptSerializer._dateRegEx,"$1new Date($2)");if(secure&&Sys.Serialization.JavaScriptSerializer._jsonRegEx.test(exp.replace(Sys.Serialization.JavaScriptSerializer._jsonStringRegEx,"")))throw null;return eval("("+exp+")")}catch(a){throw Error.argument("data",Sys.Res.cannotDeserializeInvalidJson)}};Type.registerNamespace("Sys.UI");Sys.EventHandlerList=function(){this._list={}};Sys.EventHandlerList.prototype={_addHandler:function(b,a){Array.add(this._getEvent(b,true),a)},addHandler:function(b,a){this._addHandler(b,a)},_removeHandler:function(c,b){var a=this._getEvent(c);if(!a)return;Array.remove(a,b)},removeHandler:function(b,a){this._removeHandler(b,a)},getHandler:function(b){var a=this._getEvent(b);if(!a||a.length===0)return null;a=Array.clone(a);return function(c,d){for(var b=0,e=a.length;b<e;b++)a[b](c,d)}},_getEvent:function(a,b){if(!this._list[a]){if(!b)return null;this._list[a]=[]}return this._list[a]}};Sys.EventHandlerList.registerClass("Sys.EventHandlerList");Sys.CommandEventArgs=function(c,a,b){Sys.CommandEventArgs.initializeBase(this);this._commandName=c;this._commandArgument=a;this._commandSource=b};Sys.CommandEventArgs.prototype={_commandName:null,_commandArgument:null,_commandSource:null,get_commandName:function(){return this._commandName},get_commandArgument:function(){return this._commandArgument},get_commandSource:function(){return this._commandSource}};Sys.CommandEventArgs.registerClass("Sys.CommandEventArgs",Sys.CancelEventArgs);Sys.INotifyPropertyChange=function(){};Sys.INotifyPropertyChange.prototype={};Sys.INotifyPropertyChange.registerInterface("Sys.INotifyPropertyChange");Sys.PropertyChangedEventArgs=function(a){Sys.PropertyChangedEventArgs.initializeBase(this);this._propertyName=a};Sys.PropertyChangedEventArgs.prototype={get_propertyName:function(){return this._propertyName}};Sys.PropertyChangedEventArgs.registerClass("Sys.PropertyChangedEventArgs",Sys.EventArgs);Sys.INotifyDisposing=function(){};Sys.INotifyDisposing.prototype={};Sys.INotifyDisposing.registerInterface("Sys.INotifyDisposing");Sys.Component=function(){if(Sys.Application)Sys.Application.registerDisposableObject(this)};Sys.Component.prototype={_id:null,_initialized:false,_updating:false,get_events:function(){if(!this._events)this._events=new Sys.EventHandlerList;return this._events},get_id:function(){return this._id},set_id:function(a){this._id=a},get_isInitialized:function(){return this._initialized},get_isUpdating:function(){return this._updating},add_disposing:function(a){this.get_events().addHandler("disposing",a)},remove_disposing:function(a){this.get_events().removeHandler("disposing",a)},add_propertyChanged:function(a){this.get_events().addHandler("propertyChanged",a)},remove_propertyChanged:function(a){this.get_events().removeHandler("propertyChanged",a)},beginUpdate:function(){this._updating=true},dispose:function(){if(this._events){var a=this._events.getHandler("disposing");if(a)a(this,Sys.EventArgs.Empty)}delete this._events;Sys.Application.unregisterDisposableObject(this);Sys.Application.removeComponent(this)},endUpdate:function(){this._updating=false;if(!this._initialized)this.initialize();this.updated()},initialize:function(){this._initialized=true},raisePropertyChanged:function(b){if(!this._events)return;var a=this._events.getHandler("propertyChanged");if(a)a(this,new Sys.PropertyChangedEventArgs(b))},updated:function(){}};Sys.Component.registerClass("Sys.Component",null,Sys.IDisposable,Sys.INotifyPropertyChange,Sys.INotifyDisposing);function Sys$Component$_setProperties(a,i){var d,j=Object.getType(a),e=j===Object||j===Sys.UI.DomElement,h=Sys.Component.isInstanceOfType(a)&&!a.get_isUpdating();if(h)a.beginUpdate();for(var c in i){var b=i[c],f=e?null:a["get_"+c];if(e||typeof f!=="function"){var k=a[c];if(!b||typeof b!=="object"||e&&!k)a[c]=b;else Sys$Component$_setProperties(k,b)}else{var l=a["set_"+c];if(typeof l==="function")l.apply(a,[b]);else if(b instanceof Array){d=f.apply(a);for(var g=0,m=d.length,n=b.length;g<n;g++,m++)d[m]=b[g]}else if(typeof b==="object"&&Object.getType(b)===Object){d=f.apply(a);Sys$Component$_setProperties(d,b)}}}if(h)a.endUpdate()}function Sys$Component$_setReferences(c,b){for(var a in b){var e=c["set_"+a],d=$find(b[a]);e.apply(c,[d])}}var $create=Sys.Component.create=function(h,f,d,c,g){var a=g?new h(g):new h,b=Sys.Application,i=b.get_isCreatingComponents();a.beginUpdate();if(f)Sys$Component$_setProperties(a,f);if(d)for(var e in d)a["add_"+e](d[e]);if(a.get_id())b.addComponent(a);if(i){b._createdComponents[b._createdComponents.length]=a;if(c)b._addComponentToSecondPass(a,c);else a.endUpdate()}else{if(c)Sys$Component$_setReferences(a,c);a.endUpdate()}return a};Sys.UI.MouseButton=function(){throw Error.notImplemented()};Sys.UI.MouseButton.prototype={leftButton:0,middleButton:1,rightButton:2};Sys.UI.MouseButton.registerEnum("Sys.UI.MouseButton");Sys.UI.Key=function(){throw Error.notImplemented()};Sys.UI.Key.prototype={backspace:8,tab:9,enter:13,esc:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,del:127};Sys.UI.Key.registerEnum("Sys.UI.Key");Sys.UI.Point=function(a,b){this.x=a;this.y=b};Sys.UI.Point.registerClass("Sys.UI.Point");Sys.UI.Bounds=function(c,d,b,a){this.x=c;this.y=d;this.height=a;this.width=b};Sys.UI.Bounds.registerClass("Sys.UI.Bounds");Sys.UI.DomEvent=function(e){var a=e,b=this.type=a.type.toLowerCase();this.rawEvent=a;this.altKey=a.altKey;if(typeof a.button!=="undefined")this.button=typeof a.which!=="undefined"?a.button:a.button===4?Sys.UI.MouseButton.middleButton:a.button===2?Sys.UI.MouseButton.rightButton:Sys.UI.MouseButton.leftButton;if(b==="keypress")this.charCode=a.charCode||a.keyCode;else if(a.keyCode&&a.keyCode===46)this.keyCode=127;else this.keyCode=a.keyCode;this.clientX=a.clientX;this.clientY=a.clientY;this.ctrlKey=a.ctrlKey;this.target=a.target?a.target:a.srcElement;if(!b.startsWith("key"))if(typeof a.offsetX!=="undefined"&&typeof a.offsetY!=="undefined"){this.offsetX=a.offsetX;this.offsetY=a.offsetY}else if(this.target&&this.target.nodeType!==3&&typeof a.clientX==="number"){var c=Sys.UI.DomElement.getLocation(this.target),d=Sys.UI.DomElement._getWindow(this.target);this.offsetX=(d.pageXOffset||0)+a.clientX-c.x;this.offsetY=(d.pageYOffset||0)+a.clientY-c.y}this.screenX=a.screenX;this.screenY=a.screenY;this.shiftKey=a.shiftKey};Sys.UI.DomEvent.prototype={preventDefault:function(){if(this.rawEvent.preventDefault)this.rawEvent.preventDefault();else if(window.event)this.rawEvent.returnValue=false},stopPropagation:function(){if(this.rawEvent.stopPropagation)this.rawEvent.stopPropagation();else if(window.event)this.rawEvent.cancelBubble=true}};Sys.UI.DomEvent.registerClass("Sys.UI.DomEvent");var $addHandler=Sys.UI.DomEvent.addHandler=function(a,d,e,g){if(!a._events)a._events={};var c=a._events[d];if(!c)a._events[d]=c=[];var b;if(a.addEventListener){b=function(b){return e.call(a,new Sys.UI.DomEvent(b))};a.addEventListener(d,b,false)}else if(a.attachEvent){b=function(){var b={};try{b=Sys.UI.DomElement._getWindow(a).event}catch(c){}return e.call(a,new Sys.UI.DomEvent(b))};a.attachEvent("on"+d,b)}c[c.length]={handler:e,browserHandler:b,autoRemove:g};if(g){var f=a.dispose;if(f!==Sys.UI.DomEvent._disposeHandlers){a.dispose=Sys.UI.DomEvent._disposeHandlers;if(typeof f!=="undefined")a._chainDispose=f}}},$addHandlers=Sys.UI.DomEvent.addHandlers=function(f,d,c,e){for(var b in d){var a=d[b];if(c)a=Function.createDelegate(c,a);$addHandler(f,b,a,e||false)}},$clearHandlers=Sys.UI.DomEvent.clearHandlers=function(a){Sys.UI.DomEvent._clearHandlers(a,false)};Sys.UI.DomEvent._clearHandlers=function(a,g){if(a._events){var e=a._events;for(var b in e){var d=e[b];for(var c=d.length-1;c>=0;c--){var f=d[c];if(!g||f.autoRemove)$removeHandler(a,b,f.handler)}}a._events=null}};Sys.UI.DomEvent._disposeHandlers=function(){Sys.UI.DomEvent._clearHandlers(this,true);var b=this._chainDispose,a=typeof b;if(a!=="undefined"){this.dispose=b;this._chainDispose=null;if(a==="function")this.dispose()}};var $removeHandler=Sys.UI.DomEvent.removeHandler=function(b,a,c){Sys.UI.DomEvent._removeHandler(b,a,c)};Sys.UI.DomEvent._removeHandler=function(a,e,f){var d=null,c=a._events[e];for(var b=0,g=c.length;b<g;b++)if(c[b].handler===f){d=c[b].browserHandler;break}if(a.removeEventListener)a.removeEventListener(e,d,false);else if(a.detachEvent)a.detachEvent("on"+e,d);c.splice(b,1)};Sys.UI.DomElement=function(){};Sys.UI.DomElement.registerClass("Sys.UI.DomElement");Sys.UI.DomElement.addCssClass=function(a,b){if(!Sys.UI.DomElement.containsCssClass(a,b))if(a.className==="")a.className=b;else a.className+=" "+b};Sys.UI.DomElement.containsCssClass=function(b,a){return Array.contains(b.className.split(" "),a)};Sys.UI.DomElement.getBounds=function(a){var b=Sys.UI.DomElement.getLocation(a);return new Sys.UI.Bounds(b.x,b.y,a.offsetWidth||0,a.offsetHeight||0)};var $get=Sys.UI.DomElement.getElementById=function(f,e){if(!e)return document.getElementById(f);if(e.getElementById)return e.getElementById(f);var c=[],d=e.childNodes;for(var b=0;b<d.length;b++){var a=d[b];if(a.nodeType==1)c[c.length]=a}while(c.length){a=c.shift();if(a.id==f)return a;d=a.childNodes;for(b=0;b<d.length;b++){a=d[b];if(a.nodeType==1)c[c.length]=a}}return null};if(document.documentElement.getBoundingClientRect)Sys.UI.DomElement.getLocation=function(b){if(b.self||b.nodeType===9||b===document.documentElement||b.parentNode===b.ownerDocument.documentElement)return new Sys.UI.Point(0,0);var f=b.getBoundingClientRect();if(!f)return new Sys.UI.Point(0,0);var k,e=b.ownerDocument.documentElement,c=Math.round(f.left)+e.scrollLeft,d=Math.round(f.top)+e.scrollTop;if(Sys.Browser.agent===Sys.Browser.InternetExplorer){try{var g=b.ownerDocument.parentWindow.frameElement||null;if(g){var h=g.frameBorder==="0"||g.frameBorder==="no"?2:0;c+=h;d+=h}}catch(l){}if(Sys.Browser.version===7&&!document.documentMode){var i=document.body,j=i.getBoundingClientRect(),a=(j.right-j.left)/i.clientWidth;a=Math.round(a*100);a=(a-a%5)/100;if(!isNaN(a)&&a!==1){c=Math.round(c/a);d=Math.round(d/a)}}if((document.documentMode||0)<8){c-=e.clientLeft;d-=e.clientTop}}return new Sys.UI.Point(c,d)};else if(Sys.Browser.agent===Sys.Browser.Safari)Sys.UI.DomElement.getLocation=function(c){if(c.window&&c.window===c||c.nodeType===9)return new Sys.UI.Point(0,0);var d=0,e=0,a,j=null,g=null,b;for(a=c;a;j=a,(g=b,a=a.offsetParent)){b=Sys.UI.DomElement._getCurrentStyle(a);var f=a.tagName?a.tagName.toUpperCase():null;if((a.offsetLeft||a.offsetTop)&&(f!=="BODY"||(!g||g.position!=="absolute"))){d+=a.offsetLeft;e+=a.offsetTop}if(j&&Sys.Browser.version>=3){d+=parseInt(b.borderLeftWidth);e+=parseInt(b.borderTopWidth)}}b=Sys.UI.DomElement._getCurrentStyle(c);var h=b?b.position:null;if(!h||h!=="absolute")for(a=c.parentNode;a;a=a.parentNode){f=a.tagName?a.tagName.toUpperCase():null;if(f!=="BODY"&&f!=="HTML"&&(a.scrollLeft||a.scrollTop)){d-=a.scrollLeft||0;e-=a.scrollTop||0}b=Sys.UI.DomElement._getCurrentStyle(a);var i=b?b.position:null;if(i&&i==="absolute")break}return new Sys.UI.Point(d,e)};else Sys.UI.DomElement.getLocation=function(d){if(d.window&&d.window===d||d.nodeType===9)return new Sys.UI.Point(0,0);var e=0,f=0,a,i=null,g=null,b=null;for(a=d;a;i=a,(g=b,a=a.offsetParent)){var c=a.tagName?a.tagName.toUpperCase():null;b=Sys.UI.DomElement._getCurrentStyle(a);if((a.offsetLeft||a.offsetTop)&&!(c==="BODY"&&(!g||g.position!=="absolute"))){e+=a.offsetLeft;f+=a.offsetTop}if(i!==null&&b){if(c!=="TABLE"&&c!=="TD"&&c!=="HTML"){e+=parseInt(b.borderLeftWidth)||0;f+=parseInt(b.borderTopWidth)||0}if(c==="TABLE"&&(b.position==="relative"||b.position==="absolute")){e+=parseInt(b.marginLeft)||0;f+=parseInt(b.marginTop)||0}}}b=Sys.UI.DomElement._getCurrentStyle(d);var h=b?b.position:null;if(!h||h!=="absolute")for(a=d.parentNode;a;a=a.parentNode){c=a.tagName?a.tagName.toUpperCase():null;if(c!=="BODY"&&c!=="HTML"&&(a.scrollLeft||a.scrollTop)){e-=a.scrollLeft||0;f-=a.scrollTop||0;b=Sys.UI.DomElement._getCurrentStyle(a);if(b){e+=parseInt(b.borderLeftWidth)||0;f+=parseInt(b.borderTopWidth)||0}}}return new Sys.UI.Point(e,f)};Sys.UI.DomElement.isDomElement=function(a){return Sys._isDomElement(a)};Sys.UI.DomElement.removeCssClass=function(d,c){var a=" "+d.className+" ",b=a.indexOf(" "+c+" ");if(b>=0)d.className=(a.substr(0,b)+" "+a.substring(b+c.length+1,a.length)).trim()};Sys.UI.DomElement.resolveElement=function(b,c){var a=b;if(!a)return null;if(typeof a==="string")a=Sys.UI.DomElement.getElementById(a,c);return a};Sys.UI.DomElement.raiseBubbleEvent=function(c,d){var b=c;while(b){var a=b.control;if(a&&a.onBubbleEvent&&a.raiseBubbleEvent){Sys.UI.DomElement._raiseBubbleEventFromControl(a,c,d);return}b=b.parentNode}};Sys.UI.DomElement._raiseBubbleEventFromControl=function(a,b,c){if(!a.onBubbleEvent(b,c))a._raiseBubbleEvent(b,c)};Sys.UI.DomElement.setLocation=function(b,c,d){var a=b.style;a.position="absolute";a.left=c+"px";a.top=d+"px"};Sys.UI.DomElement.toggleCssClass=function(b,a){if(Sys.UI.DomElement.containsCssClass(b,a))Sys.UI.DomElement.removeCssClass(b,a);else Sys.UI.DomElement.addCssClass(b,a)};Sys.UI.DomElement.getVisibilityMode=function(a){return a._visibilityMode===Sys.UI.VisibilityMode.hide?Sys.UI.VisibilityMode.hide:Sys.UI.VisibilityMode.collapse};Sys.UI.DomElement.setVisibilityMode=function(a,b){Sys.UI.DomElement._ensureOldDisplayMode(a);if(a._visibilityMode!==b){a._visibilityMode=b;if(Sys.UI.DomElement.getVisible(a)===false)if(a._visibilityMode===Sys.UI.VisibilityMode.hide)a.style.display=a._oldDisplayMode;else a.style.display="none";a._visibilityMode=b}};Sys.UI.DomElement.getVisible=function(b){var a=b.currentStyle||Sys.UI.DomElement._getCurrentStyle(b);if(!a)return true;return a.visibility!=="hidden"&&a.display!=="none"};Sys.UI.DomElement.setVisible=function(a,b){if(b!==Sys.UI.DomElement.getVisible(a)){Sys.UI.DomElement._ensureOldDisplayMode(a);a.style.visibility=b?"visible":"hidden";if(b||a._visibilityMode===Sys.UI.VisibilityMode.hide)a.style.display=a._oldDisplayMode;else a.style.display="none"}};Sys.UI.DomElement._ensureOldDisplayMode=function(a){if(!a._oldDisplayMode){var b=a.currentStyle||Sys.UI.DomElement._getCurrentStyle(a);a._oldDisplayMode=b?b.display:null;if(!a._oldDisplayMode||a._oldDisplayMode==="none")switch(a.tagName.toUpperCase()){case"DIV":case"P":case"ADDRESS":case"BLOCKQUOTE":case"BODY":case"COL":case"COLGROUP":case"DD":case"DL":case"DT":case"FIELDSET":case"FORM":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"HR":case"IFRAME":case"LEGEND":case"OL":case"PRE":case"TABLE":case"TD":case"TH":case"TR":case"UL":a._oldDisplayMode="block";break;case"LI":a._oldDisplayMode="list-item";break;default:a._oldDisplayMode="inline"}}};Sys.UI.DomElement._getWindow=function(a){var b=a.ownerDocument||a.document||a;return b.defaultView||b.parentWindow};Sys.UI.DomElement._getCurrentStyle=function(a){if(a.nodeType===3)return null;var c=Sys.UI.DomElement._getWindow(a);if(a.documentElement)a=a.documentElement;var b=c&&a!==c&&c.getComputedStyle?c.getComputedStyle(a,null):a.currentStyle||a.style;if(!b&&Sys.Browser.agent===Sys.Browser.Safari&&a.style){var g=a.style.display,f=a.style.position;a.style.position="absolute";a.style.display="block";var e=c.getComputedStyle(a,null);a.style.display=g;a.style.position=f;b={};for(var d in e)b[d]=e[d];b.display="none"}return b};Sys.IContainer=function(){};Sys.IContainer.prototype={};Sys.IContainer.registerInterface("Sys.IContainer");Sys.ApplicationLoadEventArgs=function(b,a){Sys.ApplicationLoadEventArgs.initializeBase(this);this._components=b;this._isPartialLoad=a};Sys.ApplicationLoadEventArgs.prototype={get_components:function(){return this._components},get_isPartialLoad:function(){return this._isPartialLoad}};Sys.ApplicationLoadEventArgs.registerClass("Sys.ApplicationLoadEventArgs",Sys.EventArgs);Sys._Application=function(){Sys._Application.initializeBase(this);this._disposableObjects=[];this._components={};this._createdComponents=[];this._secondPassComponents=[];this._unloadHandlerDelegate=Function.createDelegate(this,this._unloadHandler);Sys.UI.DomEvent.addHandler(window,"unload",this._unloadHandlerDelegate);this._domReady()};Sys._Application.prototype={_creatingComponents:false,_disposing:false,_deleteCount:0,get_isCreatingComponents:function(){return this._creatingComponents},get_isDisposing:function(){return this._disposing},add_init:function(a){if(this._initialized)a(this,Sys.EventArgs.Empty);else this.get_events().addHandler("init",a)},remove_init:function(a){this.get_events().removeHandler("init",a)},add_load:function(a){this.get_events().addHandler("load",a)},remove_load:function(a){this.get_events().removeHandler("load",a)},add_unload:function(a){this.get_events().addHandler("unload",a)},remove_unload:function(a){this.get_events().removeHandler("unload",a)},addComponent:function(a){this._components[a.get_id()]=a},beginCreateComponents:function(){this._creatingComponents=true},dispose:function(){if(!this._disposing){this._disposing=true;if(this._timerCookie){window.clearTimeout(this._timerCookie);delete this._timerCookie}if(this._endRequestHandler){Sys.WebForms.PageRequestManager.getInstance().remove_endRequest(this._endRequestHandler);delete this._endRequestHandler}if(this._beginRequestHandler){Sys.WebForms.PageRequestManager.getInstance().remove_beginRequest(this._beginRequestHandler);delete this._beginRequestHandler}if(window.pageUnload)window.pageUnload(this,Sys.EventArgs.Empty);var c=this.get_events().getHandler("unload");if(c)c(this,Sys.EventArgs.Empty);var b=Array.clone(this._disposableObjects);for(var a=0,f=b.length;a<f;a++){var d=b[a];if(typeof d!=="undefined")d.dispose()}Array.clear(this._disposableObjects);Sys.UI.DomEvent.removeHandler(window,"unload",this._unloadHandlerDelegate);if(Sys._ScriptLoader){var e=Sys._ScriptLoader.getInstance();if(e)e.dispose()}Sys._Application.callBaseMethod(this,"dispose")}},disposeElement:function(c,j){if(c.nodeType===1){var b,h=c.getElementsByTagName("*"),g=h.length,i=new Array(g);for(b=0;b<g;b++)i[b]=h[b];for(b=g-1;b>=0;b--){var d=i[b],f=d.dispose;if(f&&typeof f==="function")d.dispose();else{var e=d.control;if(e&&typeof e.dispose==="function")e.dispose()}var a=d._behaviors;if(a)this._disposeComponents(a);a=d._components;if(a){this._disposeComponents(a);d._components=null}}if(!j){var f=c.dispose;if(f&&typeof f==="function")c.dispose();else{var e=c.control;if(e&&typeof e.dispose==="function")e.dispose()}var a=c._behaviors;if(a)this._disposeComponents(a);a=c._components;if(a){this._disposeComponents(a);c._components=null}}}},endCreateComponents:function(){var b=this._secondPassComponents;for(var a=0,d=b.length;a<d;a++){var c=b[a].component;Sys$Component$_setReferences(c,b[a].references);c.endUpdate()}this._secondPassComponents=[];this._creatingComponents=false},findComponent:function(b,a){return a?Sys.IContainer.isInstanceOfType(a)?a.findComponent(b):a[b]||null:Sys.Application._components[b]||null},getComponents:function(){var a=[],b=this._components;for(var c in b)a[a.length]=b[c];return a},initialize:function(){if(!this.get_isInitialized()&&!this._disposing){Sys._Application.callBaseMethod(this,"initialize");this._raiseInit();if(this.get_stateString){if(Sys.WebForms&&Sys.WebForms.PageRequestManager){this._beginRequestHandler=Function.createDelegate(this,this._onPageRequestManagerBeginRequest);Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(this._beginRequestHandler);this._endRequestHandler=Function.createDelegate(this,this._onPageRequestManagerEndRequest);Sys.WebForms.PageRequestManager.getInstance().add_endRequest(this._endRequestHandler)}var a=this.get_stateString();if(a!==this._currentEntry)this._navigate(a);else this._ensureHistory()}this.raiseLoad()}},notifyScriptLoaded:function(){},registerDisposableObject:function(b){if(!this._disposing){var a=this._disposableObjects,c=a.length;a[c]=b;b.__msdisposeindex=c}},raiseLoad:function(){var b=this.get_events().getHandler("load"),a=new Sys.ApplicationLoadEventArgs(Array.clone(this._createdComponents),!!this._loaded);this._loaded=true;if(b)b(this,a);if(window.pageLoad)window.pageLoad(this,a);this._createdComponents=[]},removeComponent:function(b){var a=b.get_id();if(a)delete this._components[a]},unregisterDisposableObject:function(a){if(!this._disposing){var e=a.__msdisposeindex;if(typeof e==="number"){var b=this._disposableObjects;delete b[e];delete a.__msdisposeindex;if(++this._deleteCount>1000){var c=[];for(var d=0,f=b.length;d<f;d++){a=b[d];if(typeof a!=="undefined"){a.__msdisposeindex=c.length;c.push(a)}}this._disposableObjects=c;this._deleteCount=0}}}},_addComponentToSecondPass:function(b,a){this._secondPassComponents[this._secondPassComponents.length]={component:b,references:a}},_disposeComponents:function(a){if(a)for(var b=a.length-1;b>=0;b--){var c=a[b];if(typeof c.dispose==="function")c.dispose()}},_domReady:function(){var a,g,f=this;function b(){f.initialize()}var c=function(){Sys.UI.DomEvent.removeHandler(window,"load",c);b()};Sys.UI.DomEvent.addHandler(window,"load",c);if(document.addEventListener)try{document.addEventListener("DOMContentLoaded",a=function(){document.removeEventListener("DOMContentLoaded",a,false);b()},false)}catch(h){}else if(document.attachEvent)if(window==window.top&&document.documentElement.doScroll){var e,d=document.createElement("div");a=function(){try{d.doScroll("left")}catch(c){e=window.setTimeout(a,0);return}d=null;b()};a()}else document.attachEvent("onreadystatechange",a=function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",a);b()}})},_raiseInit:function(){var a=this.get_events().getHandler("init");if(a){this.beginCreateComponents();a(this,Sys.EventArgs.Empty);this.endCreateComponents()}},_unloadHandler:function(){this.dispose()}};Sys._Application.registerClass("Sys._Application",Sys.Component,Sys.IContainer);Sys.Application=new Sys._Application;var $find=Sys.Application.findComponent;Sys.UI.Behavior=function(b){Sys.UI.Behavior.initializeBase(this);this._element=b;var a=b._behaviors;if(!a)b._behaviors=[this];else a[a.length]=this};Sys.UI.Behavior.prototype={_name:null,get_element:function(){return this._element},get_id:function(){var a=Sys.UI.Behavior.callBaseMethod(this,"get_id");if(a)return a;if(!this._element||!this._element.id)return"";return this._element.id+"$"+this.get_name()},get_name:function(){if(this._name)return this._name;var a=Object.getTypeName(this),b=a.lastIndexOf(".");if(b!==-1)a=a.substr(b+1);if(!this.get_isInitialized())this._name=a;return a},set_name:function(a){this._name=a},initialize:function(){Sys.UI.Behavior.callBaseMethod(this,"initialize");var a=this.get_name();if(a)this._element[a]=this},dispose:function(){Sys.UI.Behavior.callBaseMethod(this,"dispose");var a=this._element;if(a){var c=this.get_name();if(c)a[c]=null;var b=a._behaviors;Array.remove(b,this);if(b.length===0)a._behaviors=null;delete this._element}}};Sys.UI.Behavior.registerClass("Sys.UI.Behavior",Sys.Component);Sys.UI.Behavior.getBehaviorByName=function(b,c){var a=b[c];return a&&Sys.UI.Behavior.isInstanceOfType(a)?a:null};Sys.UI.Behavior.getBehaviors=function(a){if(!a._behaviors)return[];return Array.clone(a._behaviors)};Sys.UI.Behavior.getBehaviorsByType=function(d,e){var a=d._behaviors,c=[];if(a)for(var b=0,f=a.length;b<f;b++)if(e.isInstanceOfType(a[b]))c[c.length]=a[b];return c};Sys.UI.VisibilityMode=function(){throw Error.notImplemented()};Sys.UI.VisibilityMode.prototype={hide:0,collapse:1};Sys.UI.VisibilityMode.registerEnum("Sys.UI.VisibilityMode");Sys.UI.Control=function(a){Sys.UI.Control.initializeBase(this);this._element=a;a.control=this;var b=this.get_role();if(b)a.setAttribute("role",b)};Sys.UI.Control.prototype={_parent:null,_visibilityMode:Sys.UI.VisibilityMode.hide,get_element:function(){return this._element},get_id:function(){if(!this._element)return"";return this._element.id},set_id:function(){throw Error.invalidOperation(Sys.Res.cantSetId)},get_parent:function(){if(this._parent)return this._parent;if(!this._element)return null;var a=this._element.parentNode;while(a){if(a.control)return a.control;a=a.parentNode}return null},set_parent:function(a){this._parent=a},get_role:function(){return null},get_visibilityMode:function(){return Sys.UI.DomElement.getVisibilityMode(this._element)},set_visibilityMode:function(a){Sys.UI.DomElement.setVisibilityMode(this._element,a)},get_visible:function(){return Sys.UI.DomElement.getVisible(this._element)},set_visible:function(a){Sys.UI.DomElement.setVisible(this._element,a)},addCssClass:function(a){Sys.UI.DomElement.addCssClass(this._element,a)},dispose:function(){Sys.UI.Control.callBaseMethod(this,"dispose");if(this._element){this._element.control=null;delete this._element}if(this._parent)delete this._parent},onBubbleEvent:function(){return false},raiseBubbleEvent:function(a,b){this._raiseBubbleEvent(a,b)},_raiseBubbleEvent:function(b,c){var a=this.get_parent();while(a){if(a.onBubbleEvent(b,c))return;a=a.get_parent()}},removeCssClass:function(a){Sys.UI.DomElement.removeCssClass(this._element,a)},toggleCssClass:function(a){Sys.UI.DomElement.toggleCssClass(this._element,a)}};Sys.UI.Control.registerClass("Sys.UI.Control",Sys.Component);Sys.HistoryEventArgs=function(a){Sys.HistoryEventArgs.initializeBase(this);this._state=a};Sys.HistoryEventArgs.prototype={get_state:function(){return this._state}};Sys.HistoryEventArgs.registerClass("Sys.HistoryEventArgs",Sys.EventArgs);Sys.Application._appLoadHandler=null;Sys.Application._beginRequestHandler=null;Sys.Application._clientId=null;Sys.Application._currentEntry="";Sys.Application._endRequestHandler=null;Sys.Application._history=null;Sys.Application._enableHistory=false;Sys.Application._historyFrame=null;Sys.Application._historyInitialized=false;Sys.Application._historyPointIsNew=false;Sys.Application._ignoreTimer=false;Sys.Application._initialState=null;Sys.Application._state={};Sys.Application._timerCookie=0;Sys.Application._timerHandler=null;Sys.Application._uniqueId=null;Sys._Application.prototype.get_stateString=function(){var a=null;if(Sys.Browser.agent===Sys.Browser.Firefox){var c=window.location.href,b=c.indexOf("#");if(b!==-1)a=c.substring(b+1);else a="";return a}else a=window.location.hash;if(a.length>0&&a.charAt(0)==="#")a=a.substring(1);return a};Sys._Application.prototype.get_enableHistory=function(){return this._enableHistory};Sys._Application.prototype.set_enableHistory=function(a){this._enableHistory=a};Sys._Application.prototype.add_navigate=function(a){this.get_events().addHandler("navigate",a)};Sys._Application.prototype.remove_navigate=function(a){this.get_events().removeHandler("navigate",a)};Sys._Application.prototype.addHistoryPoint=function(c,f){this._ensureHistory();var b=this._state;for(var a in c){var d=c[a];if(d===null){if(typeof b[a]!=="undefined")delete b[a]}else b[a]=d}var e=this._serializeState(b);this._historyPointIsNew=true;this._setState(e,f);this._raiseNavigate()};Sys._Application.prototype.setServerId=function(a,b){this._clientId=a;this._uniqueId=b};Sys._Application.prototype.setServerState=function(a){this._ensureHistory();this._state.__s=a;this._updateHiddenField(a)};Sys._Application.prototype._deserializeState=function(a){var e={};a=a||"";var b=a.indexOf("&&");if(b!==-1&&b+2<a.length){e.__s=a.substr(b+2);a=a.substr(0,b)}var g=a.split("&");for(var f=0,j=g.length;f<j;f++){var d=g[f],c=d.indexOf("=");if(c!==-1&&c+1<d.length){var i=d.substr(0,c),h=d.substr(c+1);e[i]=decodeURIComponent(h)}}return e};Sys._Application.prototype._enableHistoryInScriptManager=function(){this._enableHistory=true};Sys._Application.prototype._ensureHistory=function(){if(!this._historyInitialized&&this._enableHistory){if(Sys.Browser.agent===Sys.Browser.InternetExplorer&&Sys.Browser.documentMode<8){this._historyFrame=document.getElementById("__historyFrame");this._ignoreIFrame=true}this._timerHandler=Function.createDelegate(this,this._onIdle);this._timerCookie=window.setTimeout(this._timerHandler,100);try{this._initialState=this._deserializeState(this.get_stateString())}catch(a){}this._historyInitialized=true}};Sys._Application.prototype._navigate=function(c){this._ensureHistory();var b=this._deserializeState(c);if(this._uniqueId){var d=this._state.__s||"",a=b.__s||"";if(a!==d){this._updateHiddenField(a);__doPostBack(this._uniqueId,a);this._state=b;return}}this._setState(c);this._state=b;this._raiseNavigate()};Sys._Application.prototype._onIdle=function(){delete this._timerCookie;var a=this.get_stateString();if(a!==this._currentEntry){if(!this._ignoreTimer){this._historyPointIsNew=false;this._navigate(a)}}else this._ignoreTimer=false;this._timerCookie=window.setTimeout(this._timerHandler,100)};Sys._Application.prototype._onIFrameLoad=function(a){this._ensureHistory();if(!this._ignoreIFrame){this._historyPointIsNew=false;this._navigate(a)}this._ignoreIFrame=false};Sys._Application.prototype._onPageRequestManagerBeginRequest=function(){this._ignoreTimer=true;this._originalTitle=document.title};Sys._Application.prototype._onPageRequestManagerEndRequest=function(g,f){var d=f.get_dataItems()[this._clientId],c=this._originalTitle;this._originalTitle=null;var b=document.getElementById("__EVENTTARGET");if(b&&b.value===this._uniqueId)b.value="";if(typeof d!=="undefined"){this.setServerState(d);this._historyPointIsNew=true}else this._ignoreTimer=false;var a=this._serializeState(this._state);if(a!==this._currentEntry){this._ignoreTimer=true;if(typeof c==="string"){if(Sys.Browser.agent!==Sys.Browser.InternetExplorer||Sys.Browser.version>7){var e=document.title;document.title=c;this._setState(a);document.title=e}else this._setState(a);this._raiseNavigate()}else{this._setState(a);this._raiseNavigate()}}};Sys._Application.prototype._raiseNavigate=function(){var d=this._historyPointIsNew,c=this.get_events().getHandler("navigate"),b={};for(var a in this._state)if(a!=="__s")b[a]=this._state[a];var e=new Sys.HistoryEventArgs(b);if(c)c(this,e);if(!d){var f;try{if(Sys.Browser.agent===Sys.Browser.Firefox&&window.location.hash&&(!window.frameElement||window.top.location.hash))Sys.Browser.version<3.5?window.history.go(0):(location.hash=this.get_stateString())}catch(g){}}};Sys._Application.prototype._serializeState=function(d){var b=[];for(var a in d){var e=d[a];if(a==="__s")var c=e;else b[b.length]=a+"="+encodeURIComponent(e)}return b.join("&")+(c?"&&"+c:"")};Sys._Application.prototype._setState=function(a,b){if(this._enableHistory){a=a||"";if(a!==this._currentEntry){if(window.theForm){var d=window.theForm.action,e=d.indexOf("#");window.theForm.action=(e!==-1?d.substring(0,e):d)+"#"+a}if(this._historyFrame&&this._historyPointIsNew){this._ignoreIFrame=true;var c=this._historyFrame.contentWindow.document;c.open("javascript:'<html></html>'");c.write("<html><head><title>"+(b||document.title)+"</title><scri"+'pt type="text/javascript">parent.Sys.Application._onIFrameLoad('+Sys.Serialization.JavaScriptSerializer.serialize(a)+");</scri"+"pt></head><body></body></html>");c.close()}this._ignoreTimer=false;this._currentEntry=a;if(this._historyFrame||this._historyPointIsNew){var f=this.get_stateString();if(a!==f){window.location.hash=a;this._currentEntry=this.get_stateString();if(typeof b!=="undefined"&&b!==null)document.title=b}}this._historyPointIsNew=false}}};Sys._Application.prototype._updateHiddenField=function(b){if(this._clientId){var a=document.getElementById(this._clientId);if(a)a.value=b}};if(!window.XMLHttpRequest)window.XMLHttpRequest=function(){var b=["Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP"];for(var a=0,c=b.length;a<c;a++)try{return new ActiveXObject(b[a])}catch(d){}return null};Type.registerNamespace("Sys.Net");Sys.Net.WebRequestExecutor=function(){this._webRequest=null;this._resultObject=null};Sys.Net.WebRequestExecutor.prototype={get_webRequest:function(){return this._webRequest},_set_webRequest:function(a){this._webRequest=a},get_started:function(){throw Error.notImplemented()},get_responseAvailable:function(){throw Error.notImplemented()},get_timedOut:function(){throw Error.notImplemented()},get_aborted:function(){throw Error.notImplemented()},get_responseData:function(){throw Error.notImplemented()},get_statusCode:function(){throw Error.notImplemented()},get_statusText:function(){throw Error.notImplemented()},get_xml:function(){throw Error.notImplemented()},get_object:function(){if(!this._resultObject)this._resultObject=Sys.Serialization.JavaScriptSerializer.deserialize(this.get_responseData());return this._resultObject},executeRequest:function(){throw Error.notImplemented()},abort:function(){throw Error.notImplemented()},getResponseHeader:function(){throw Error.notImplemented()},getAllResponseHeaders:function(){throw Error.notImplemented()}};Sys.Net.WebRequestExecutor.registerClass("Sys.Net.WebRequestExecutor");Sys.Net.XMLDOM=function(d){if(!window.DOMParser){var c=["Msxml2.DOMDocument.3.0","Msxml2.DOMDocument"];for(var b=0,f=c.length;b<f;b++)try{var a=new ActiveXObject(c[b]);a.async=false;a.loadXML(d);a.setProperty("SelectionLanguage","XPath");return a}catch(g){}}else try{var e=new window.DOMParser;return e.parseFromString(d,"text/xml")}catch(g){}return null};Sys.Net.XMLHttpExecutor=function(){Sys.Net.XMLHttpExecutor.initializeBase(this);var a=this;this._xmlHttpRequest=null;this._webRequest=null;this._responseAvailable=false;this._timedOut=false;this._timer=null;this._aborted=false;this._started=false;this._onReadyStateChange=function(){if(a._xmlHttpRequest.readyState===4){try{if(typeof a._xmlHttpRequest.status==="undefined")return}catch(b){return}a._clearTimer();a._responseAvailable=true;try{a._webRequest.completed(Sys.EventArgs.Empty)}finally{if(a._xmlHttpRequest!=null){a._xmlHttpRequest.onreadystatechange=Function.emptyMethod;a._xmlHttpRequest=null}}}};this._clearTimer=function(){if(a._timer!=null){window.clearTimeout(a._timer);a._timer=null}};this._onTimeout=function(){if(!a._responseAvailable){a._clearTimer();a._timedOut=true;a._xmlHttpRequest.onreadystatechange=Function.emptyMethod;a._xmlHttpRequest.abort();a._webRequest.completed(Sys.EventArgs.Empty);a._xmlHttpRequest=null}}};Sys.Net.XMLHttpExecutor.prototype={get_timedOut:function(){return this._timedOut},get_started:function(){return this._started},get_responseAvailable:function(){return this._responseAvailable},get_aborted:function(){return this._aborted},executeRequest:function(){this._webRequest=this.get_webRequest();var c=this._webRequest.get_body(),a=this._webRequest.get_headers();this._xmlHttpRequest=new XMLHttpRequest;this._xmlHttpRequest.onreadystatechange=this._onReadyStateChange;var e=this._webRequest.get_httpVerb();this._xmlHttpRequest.open(e,this._webRequest.getResolvedUrl(),true);this._xmlHttpRequest.setRequestHeader("X-Requested-With","XMLHttpRequest");if(a)for(var b in a){var f=a[b];if(typeof f!=="function")this._xmlHttpRequest.setRequestHeader(b,f)}if(e.toLowerCase()==="post"){if(a===null||!a["Content-Type"])this._xmlHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8");if(!c)c=""}var d=this._webRequest.get_timeout();if(d>0)this._timer=window.setTimeout(Function.createDelegate(this,this._onTimeout),d);this._xmlHttpRequest.send(c);this._started=true},getResponseHeader:function(b){var a;try{a=this._xmlHttpRequest.getResponseHeader(b)}catch(c){}if(!a)a="";return a},getAllResponseHeaders:function(){return this._xmlHttpRequest.getAllResponseHeaders()},get_responseData:function(){return this._xmlHttpRequest.responseText},get_statusCode:function(){var a=0;try{a=this._xmlHttpRequest.status}catch(b){}return a},get_statusText:function(){return this._xmlHttpRequest.statusText},get_xml:function(){var a=this._xmlHttpRequest.responseXML;if(!a||!a.documentElement){a=Sys.Net.XMLDOM(this._xmlHttpRequest.responseText);if(!a||!a.documentElement)return null}else if(navigator.userAgent.indexOf("MSIE")!==-1)a.setProperty("SelectionLanguage","XPath");if(a.documentElement.namespaceURI==="http://www.mozilla.org/newlayout/xml/parsererror.xml"&&a.documentElement.tagName==="parsererror")return null;if(a.documentElement.firstChild&&a.documentElement.firstChild.tagName==="parsererror")return null;return a},abort:function(){if(this._aborted||this._responseAvailable||this._timedOut)return;this._aborted=true;this._clearTimer();if(this._xmlHttpRequest&&!this._responseAvailable){this._xmlHttpRequest.onreadystatechange=Function.emptyMethod;this._xmlHttpRequest.abort();this._xmlHttpRequest=null;this._webRequest.completed(Sys.EventArgs.Empty)}}};Sys.Net.XMLHttpExecutor.registerClass("Sys.Net.XMLHttpExecutor",Sys.Net.WebRequestExecutor);Sys.Net._WebRequestManager=function(){this._defaultTimeout=0;this._defaultExecutorType="Sys.Net.XMLHttpExecutor"};Sys.Net._WebRequestManager.prototype={add_invokingRequest:function(a){this._get_eventHandlerList().addHandler("invokingRequest",a)},remove_invokingRequest:function(a){this._get_eventHandlerList().removeHandler("invokingRequest",a)},add_completedRequest:function(a){this._get_eventHandlerList().addHandler("completedRequest",a)},remove_completedRequest:function(a){this._get_eventHandlerList().removeHandler("completedRequest",a)},_get_eventHandlerList:function(){if(!this._events)this._events=new Sys.EventHandlerList;return this._events},get_defaultTimeout:function(){return this._defaultTimeout},set_defaultTimeout:function(a){this._defaultTimeout=a},get_defaultExecutorType:function(){return this._defaultExecutorType},set_defaultExecutorType:function(a){this._defaultExecutorType=a},executeRequest:function(webRequest){var executor=webRequest.get_executor();if(!executor){var failed=false;try{var executorType=eval(this._defaultExecutorType);executor=new executorType}catch(a){failed=true}webRequest.set_executor(executor)}if(executor.get_aborted())return;var evArgs=new Sys.Net.NetworkRequestEventArgs(webRequest),handler=this._get_eventHandlerList().getHandler("invokingRequest");if(handler)handler(this,evArgs);if(!evArgs.get_cancel())executor.executeRequest()}};Sys.Net._WebRequestManager.registerClass("Sys.Net._WebRequestManager");Sys.Net.WebRequestManager=new Sys.Net._WebRequestManager;Sys.Net.NetworkRequestEventArgs=function(a){Sys.Net.NetworkRequestEventArgs.initializeBase(this);this._webRequest=a};Sys.Net.NetworkRequestEventArgs.prototype={get_webRequest:function(){return this._webRequest}};Sys.Net.NetworkRequestEventArgs.registerClass("Sys.Net.NetworkRequestEventArgs",Sys.CancelEventArgs);Sys.Net.WebRequest=function(){this._url="";this._headers={};this._body=null;this._userContext=null;this._httpVerb=null;this._executor=null;this._invokeCalled=false;this._timeout=0};Sys.Net.WebRequest.prototype={add_completed:function(a){this._get_eventHandlerList().addHandler("completed",a)},remove_completed:function(a){this._get_eventHandlerList().removeHandler("completed",a)},completed:function(b){var a=Sys.Net.WebRequestManager._get_eventHandlerList().getHandler("completedRequest");if(a)a(this._executor,b);a=this._get_eventHandlerList().getHandler("completed");if(a)a(this._executor,b)},_get_eventHandlerList:function(){if(!this._events)this._events=new Sys.EventHandlerList;return this._events},get_url:function(){return this._url},set_url:function(a){this._url=a},get_headers:function(){return this._headers},get_httpVerb:function(){if(this._httpVerb===null){if(this._body===null)return"GET";return"POST"}return this._httpVerb},set_httpVerb:function(a){this._httpVerb=a},get_body:function(){return this._body},set_body:function(a){this._body=a},get_userContext:function(){return this._userContext},set_userContext:function(a){this._userContext=a},get_executor:function(){return this._executor},set_executor:function(a){this._executor=a;this._executor._set_webRequest(this)},get_timeout:function(){if(this._timeout===0)return Sys.Net.WebRequestManager.get_defaultTimeout();return this._timeout},set_timeout:function(a){this._timeout=a},getResolvedUrl:function(){return Sys.Net.WebRequest._resolveUrl(this._url)},invoke:function(){Sys.Net.WebRequestManager.executeRequest(this);this._invokeCalled=true}};Sys.Net.WebRequest._resolveUrl=function(b,a){if(b&&b.indexOf("://")!==-1)return b;if(!a||a.length===0){var d=document.getElementsByTagName("base")[0];if(d&&d.href&&d.href.length>0)a=d.href;else a=document.URL}var c=a.indexOf("?");if(c!==-1)a=a.substr(0,c);c=a.indexOf("#");if(c!==-1)a=a.substr(0,c);a=a.substr(0,a.lastIndexOf("/")+1);if(!b||b.length===0)return a;if(b.charAt(0)==="/"){var e=a.indexOf("://"),g=a.indexOf("/",e+3);return a.substr(0,g)+b}else{var f=a.lastIndexOf("/");return a.substr(0,f+1)+b}};Sys.Net.WebRequest._createQueryString=function(c,b,f){b=b||encodeURIComponent;var h=0,e,g,d,a=new Sys.StringBuilder;if(c)for(d in c){e=c[d];if(typeof e==="function")continue;g=Sys.Serialization.JavaScriptSerializer.serialize(e);if(h++)a.append("&");a.append(d);a.append("=");a.append(b(g))}if(f){if(h)a.append("&");a.append(f)}return a.toString()};Sys.Net.WebRequest._createUrl=function(a,b,c){if(!b&&!c)return a;var d=Sys.Net.WebRequest._createQueryString(b,null,c);return d.length?a+(a&&a.indexOf("?")>=0?"&":"?")+d:a};Sys.Net.WebRequest.registerClass("Sys.Net.WebRequest");Sys._ScriptLoaderTask=function(b,a){this._scriptElement=b;this._completedCallback=a};Sys._ScriptLoaderTask.prototype={get_scriptElement:function(){return this._scriptElement},dispose:function(){if(this._disposed)return;this._disposed=true;this._removeScriptElementHandlers();Sys._ScriptLoaderTask._clearScript(this._scriptElement);this._scriptElement=null},execute:function(){this._addScriptElementHandlers();document.getElementsByTagName("head")[0].appendChild(this._scriptElement)},_addScriptElementHandlers:function(){this._scriptLoadDelegate=Function.createDelegate(this,this._scriptLoadHandler);if(Sys.Browser.agent!==Sys.Browser.InternetExplorer){this._scriptElement.readyState="loaded";$addHandler(this._scriptElement,"load",this._scriptLoadDelegate)}else $addHandler(this._scriptElement,"readystatechange",this._scriptLoadDelegate);if(this._scriptElement.addEventListener){this._scriptErrorDelegate=Function.createDelegate(this,this._scriptErrorHandler);this._scriptElement.addEventListener("error",this._scriptErrorDelegate,false)}},_removeScriptElementHandlers:function(){if(this._scriptLoadDelegate){var a=this.get_scriptElement();if(Sys.Browser.agent!==Sys.Browser.InternetExplorer)$removeHandler(a,"load",this._scriptLoadDelegate);else $removeHandler(a,"readystatechange",this._scriptLoadDelegate);if(this._scriptErrorDelegate){this._scriptElement.removeEventListener("error",this._scriptErrorDelegate,false);this._scriptErrorDelegate=null}this._scriptLoadDelegate=null}},_scriptErrorHandler:function(){if(this._disposed)return;this._completedCallback(this.get_scriptElement(),false)},_scriptLoadHandler:function(){if(this._disposed)return;var a=this.get_scriptElement();if(a.readyState!=="loaded"&&a.readyState!=="complete")return;this._completedCallback(a,true)}};Sys._ScriptLoaderTask.registerClass("Sys._ScriptLoaderTask",null,Sys.IDisposable);Sys._ScriptLoaderTask._clearScript=function(a){if(!Sys.Debug.isDebug)a.parentNode.removeChild(a)};Type.registerNamespace("Sys.Net");Sys.Net.WebServiceProxy=function(){};Sys.Net.WebServiceProxy.prototype={get_timeout:function(){return this._timeout||0},set_timeout:function(a){if(a<0)throw Error.argumentOutOfRange("value",a,Sys.Res.invalidTimeout);this._timeout=a},get_defaultUserContext:function(){return typeof this._userContext==="undefined"?null:this._userContext},set_defaultUserContext:function(a){this._userContext=a},get_defaultSucceededCallback:function(){return this._succeeded||null},set_defaultSucceededCallback:function(a){this._succeeded=a},get_defaultFailedCallback:function(){return this._failed||null},set_defaultFailedCallback:function(a){this._failed=a},get_enableJsonp:function(){return!!this._jsonp},set_enableJsonp:function(a){this._jsonp=a},get_path:function(){return this._path||null},set_path:function(a){this._path=a},get_jsonpCallbackParameter:function(){return this._callbackParameter||"callback"},set_jsonpCallbackParameter:function(a){this._callbackParameter=a},_invoke:function(d,e,g,f,c,b,a){c=c||this.get_defaultSucceededCallback();b=b||this.get_defaultFailedCallback();if(a===null||typeof a==="undefined")a=this.get_defaultUserContext();return Sys.Net.WebServiceProxy.invoke(d,e,g,f,c,b,a,this.get_timeout(),this.get_enableJsonp(),this.get_jsonpCallbackParameter())}};Sys.Net.WebServiceProxy.registerClass("Sys.Net.WebServiceProxy");Sys.Net.WebServiceProxy.invoke=function(q,a,m,l,j,b,g,e,w,p){var i=w!==false?Sys.Net.WebServiceProxy._xdomain.exec(q):null,c,n=i&&i.length===3&&(i[1]!==location.protocol||i[2]!==location.host);m=n||m;if(n){p=p||"callback";c="_jsonp"+Sys._jsonp++}if(!l)l={};var r=l;if(!m||!r)r={};var s,h,f=null,k,o=null,u=Sys.Net.WebRequest._createUrl(a?q+"/"+encodeURIComponent(a):q,r,n?p+"=Sys."+c:null);if(n){s=document.createElement("script");s.src=u;k=new Sys._ScriptLoaderTask(s,function(d,b){if(!b||c)t({Message:String.format(Sys.Res.webServiceFailedNoMsg,a)},-1)});function v(){if(f===null)return;f=null;h=new Sys.Net.WebServiceError(true,String.format(Sys.Res.webServiceTimedOut,a));k.dispose();delete Sys[c];if(b)b(h,g,a)}function t(d,e){if(f!==null){window.clearTimeout(f);f=null}k.dispose();delete Sys[c];c=null;if(typeof e!=="undefined"&&e!==200){if(b){h=new Sys.Net.WebServiceError(false,d.Message||String.format(Sys.Res.webServiceFailedNoMsg,a),d.StackTrace||null,d.ExceptionType||null,d);h._statusCode=e;b(h,g,a)}}else if(j)j(d,g,a)}Sys[c]=t;e=e||Sys.Net.WebRequestManager.get_defaultTimeout();if(e>0)f=window.setTimeout(v,e);k.execute();return null}var d=new Sys.Net.WebRequest;d.set_url(u);d.get_headers()["Content-Type"]="application/json; charset=utf-8";if(!m){o=Sys.Serialization.JavaScriptSerializer.serialize(l);if(o==="{}")o=""}d.set_body(o);d.add_completed(x);if(e&&e>0)d.set_timeout(e);d.invoke();function x(d){if(d.get_responseAvailable()){var f=d.get_statusCode(),c=null;try{var e=d.getResponseHeader("Content-Type");if(e.startsWith("application/json"))c=d.get_object();else if(e.startsWith("text/xml"))c=d.get_xml();else c=d.get_responseData()}catch(m){}var k=d.getResponseHeader("jsonerror"),h=k==="true";if(h){if(c)c=new Sys.Net.WebServiceError(false,c.Message,c.StackTrace,c.ExceptionType,c)}else if(e.startsWith("application/json"))c=!c||typeof c.d==="undefined"?c:c.d;if(f<200||f>=300||h){if(b){if(!c||!h)c=new Sys.Net.WebServiceError(false,String.format(Sys.Res.webServiceFailedNoMsg,a));c._statusCode=f;b(c,g,a)}}else if(j)j(c,g,a)}else{var i;if(d.get_timedOut())i=String.format(Sys.Res.webServiceTimedOut,a);else i=String.format(Sys.Res.webServiceFailedNoMsg,a);if(b)b(new Sys.Net.WebServiceError(d.get_timedOut(),i,"",""),g,a)}}return d};Sys.Net.WebServiceProxy._generateTypedConstructor=function(a){return function(b){if(b)for(var c in b)this[c]=b[c];this.__type=a}};Sys._jsonp=0;Sys.Net.WebServiceProxy._xdomain=/^\s*([a-zA-Z0-9\+\-\.]+\:)\/\/([^?#\/]+)/;Sys.Net.WebServiceError=function(d,e,c,a,b){this._timedOut=d;this._message=e;this._stackTrace=c;this._exceptionType=a;this._errorObject=b;this._statusCode=-1};Sys.Net.WebServiceError.prototype={get_timedOut:function(){return this._timedOut},get_statusCode:function(){return this._statusCode},get_message:function(){return this._message},get_stackTrace:function(){return this._stackTrace||""},get_exceptionType:function(){return this._exceptionType||""},get_errorObject:function(){return this._errorObject||null}};Sys.Net.WebServiceError.registerClass("Sys.Net.WebServiceError");Type.registerNamespace('Sys');Sys.Res={'argumentInteger':'Value must be an integer.','invokeCalledTwice':'Cannot call invoke more than once.','webServiceFailed':'The server method \'{0}\' failed with the following error: {1}','argumentType':'Object cannot be converted to the required type.','argumentNull':'Value cannot be null.','scriptAlreadyLoaded':'The script \'{0}\' has been referenced multiple times. If referencing Microsoft AJAX scripts explicitly, set the MicrosoftAjaxMode property of the ScriptManager to Explicit.','scriptDependencyNotFound':'The script \'{0}\' failed to load because it is dependent on script \'{1}\'.','formatBadFormatSpecifier':'Format specifier was invalid.','requiredScriptReferenceNotIncluded':'\'{0}\' requires that you have included a script reference to \'{1}\'.','webServiceFailedNoMsg':'The server method \'{0}\' failed.','argumentDomElement':'Value must be a DOM element.','invalidExecutorType':'Could not create a valid Sys.Net.WebRequestExecutor from: {0}.','cannotCallBeforeResponse':'Cannot call {0} when responseAvailable is false.','actualValue':'Actual value was {0}.','enumInvalidValue':'\'{0}\' is not a valid value for enum {1}.','scriptLoadFailed':'The script \'{0}\' could not be loaded.','parameterCount':'Parameter count mismatch.','cannotDeserializeEmptyString':'Cannot deserialize empty string.','formatInvalidString':'Input string was not in a correct format.','invalidTimeout':'Value must be greater than or equal to zero.','cannotAbortBeforeStart':'Cannot abort when executor has not started.','argument':'Value does not fall within the expected range.','cannotDeserializeInvalidJson':'Cannot deserialize. The data does not correspond to valid JSON.','invalidHttpVerb':'httpVerb cannot be set to an empty or null string.','nullWebRequest':'Cannot call executeRequest with a null webRequest.','eventHandlerInvalid':'Handler was not added through the Sys.UI.DomEvent.addHandler method.','cannotSerializeNonFiniteNumbers':'Cannot serialize non finite numbers.','argumentUndefined':'Value cannot be undefined.','webServiceInvalidReturnType':'The server method \'{0}\' returned an invalid type. Expected type: {1}','servicePathNotSet':'The path to the web service has not been set.','argumentTypeWithTypes':'Object of type \'{0}\' cannot be converted to type \'{1}\'.','cannotCallOnceStarted':'Cannot call {0} once started.','badBaseUrl1':'Base URL does not contain ://.','badBaseUrl2':'Base URL does not contain another /.','badBaseUrl3':'Cannot find last / in base URL.','setExecutorAfterActive':'Cannot set executor after it has become active.','paramName':'Parameter name: {0}','nullReferenceInPath':'Null reference while evaluating data path: \'{0}\'.','cannotCallOutsideHandler':'Cannot call {0} outside of a completed event handler.','cannotSerializeObjectWithCycle':'Cannot serialize object with cyclic reference within child properties.','format':'One of the identified items was in an invalid format.','assertFailedCaller':'Assertion Failed: {0}\r\nat {1}','argumentOutOfRange':'Specified argument was out of the range of valid values.','webServiceTimedOut':'The server method \'{0}\' timed out.','notImplemented':'The method or operation is not implemented.','assertFailed':'Assertion Failed: {0}','invalidOperation':'Operation is not valid due to the current state of the object.','breakIntoDebugger':'{0}\r\n\r\nBreak into debugger?'};var momondo=momondo||{};var Momondo=Momondo||{};var $mm=$mm||{};$mm.getImageUrl=function(url){var args=$A(arguments);if(!url.startsWith('/'))url='/'+url;args[0]=mm.imagePath+url;return String.format.apply(this,args).toLowerCase();};$mm.getLogoUrl=function(url){var args=$A(arguments);if(!url.startsWith('/'))url='/'+url;args[0]=mm.logoPath+url;return String.format.apply(this,args).toLowerCase();};$mm.getSupplierLogoUrl=function(id){return mm.logoPath+'/'+id.toLowerCase()+'.png';};var $ev=new(function(){var listeners={};return{observe:function(msg,func,context,deferred){context=context||null;var listener=listeners[msg]||(listeners[msg]=[]);var handler={func:func,context:context,deferred:(typeof deferred!=='undefined'?deferred:false)};listener.push(handler);var t=this;return{handler:func,stop:function(){t.removeListener(msg,handler);}};},removeListener:function(msg,handler){var listener=listeners[msg];if(listener){var funcs=listener;for(var i=0,len=funcs.length;i<len;i++){if(funcs[i]===handler)
    funcs.splice(i,1);}}},getArguments:function(){var args=[];for(var i=1,len=arguments.length;i<len;i++){args[i-1]=arguments[i];}
    return args;},fire:function(){var msg=arguments[0];var args=arguments.length>1?this.getArguments.apply(this,arguments):[];var handlers=listeners[msg]||[];for(var i=0,len=handlers.length;i<len;i++){var handler=handlers[i];if(handler.deferred)
{(function(handler,args)
{window.setTimeout(function(){handler.func.apply(handler.context||null,args);},0);})(handler,args);}
else
    handler.func.apply(handler.context||null,args);}},peek:function(){var out='';for(var obj in listeners)
{var listener=listeners[obj];out+=obj+' '+(listeners[obj].length||0)+'\n';}
    return out;}};})();if(typeof Effect!='undefined'){Effect.DefaultOptions.transition=function(pos){if((pos/=0.5)<1)return 0.5*Math.pow(pos,4);return-0.5*((pos-=2)*Math.pow(pos,3)-2);};Effect.ScrollToLeft=function(container){var options=arguments[1]||{},scrollOffsets=Element._returnOffset($(container).scrollLeft,$(container).scrollTop),max=$(container).scrollWidth-$(container).getWidth();return new Effect.Tween(null,scrollOffsets.left,options.left>max?max:options.left,options,function(p){container.scrollLeft=p.round();container.scrollTop=scrollOffsets.top;});};Effect.ElementScrollToVert=function(element,container,scrollToMiddle){var eo=$(element).cumulativeOffset();var co=$(container).cumulativeOffset();var options=arguments[3]||{},scrollOffsets=Element._returnOffset($(container).scrollLeft,$(container).scrollTop),elementOffsets=Element._returnOffset(eo.left-co.left,eo.top-co.top),max=$(container).scrollHeight-($(container).getHeight()/2);if(options.offset)elementOffsets[1]+=options.offset;if(scrollToMiddle)
    elementOffsets[1]-=$(container).getHeight()/2;return new Effect.Tween(null,scrollOffsets.top,elementOffsets[1]>max?max:elementOffsets[1],options,function(p){container.scrollLeft=scrollOffsets.left;container.scrollTop=p.round();});};Effect.ElementScrollToHorz=function(element,container){var eo=$(element).cumulativeOffset();var co=$(container).cumulativeOffset();var options=arguments[2]||{},scrollOffsets=Element._returnOffset($(container).scrollLeft,$(container).scrollTop),elementOffsets=Element._returnOffset(eo.left-co.left,eo.top-co.top),max=$(container).scrollWidth-$(container).getWidth();if(options.offset)elementOffsets[0]+=options.offset;return new Effect.Tween(null,scrollOffsets.left,elementOffsets[0]>max?max:elementOffsets[0],options,function(p){container.scrollLeft=p.round();container.scrollTop=scrollOffsets.top;});};Effect.ElementScrollTo=Effect.ElementScrollToVert;Effect.ElementScrollToEx=function(element,container){var eo=$(element).cumulativeOffset();var co=$(container).cumulativeOffset();var dims=$(container).getDimensions();var options=arguments[2]||{},scrollOffsets=Element._returnOffset($(container).scrollLeft,$(container).scrollTop),elementOffsets=Element._returnOffset(eo.left-co.left,eo.top-co.top),maxScrollWidth=$(container).scrollWidth-dims.width,maxScrollHeight=$(container).scrollHeight-dims.height;if(options.offsetWidth)elementOffsets[0]+=options.offsetWidth;if(options.offsetHeight)elementOffsets[1]+=options.offsetHeight;var w={start:scrollOffsets.left,range:(elementOffsets[0]>maxScrollWidth?maxScrollWidth:elementOffsets[0])-scrollOffsets.left};var h={start:scrollOffsets.top,range:(elementOffsets[1]>maxScrollHeight?maxScrollHeight:elementOffsets[1])-scrollOffsets.top};return new Effect.Tween(null,0,1,options,function(p){container.scrollLeft=Math.round(w.start+w.range*p);container.scrollTop=Math.round(h.start+h.range*p);});};Effect.FadeAndRemove=function(element){element=$(element);var oldOpacity=element.getInlineOpacity();var options=Object.extend({from:element.getOpacity()||1.0,to:0.0,duration:0.5,afterFinishInternal:function(effect){if(effect.options.to!=0)return;effect.element.hide().setStyle({opacity:oldOpacity});},afterFinish:function(effect){if(element.parentNode!=null)
    effect.element.remove();}},arguments[1]||{});return new Effect.Opacity(element,options);};Effect.Transitions.spring2=function(pos){return 1-(Math.cos(pos*4.5*Math.PI)*Math.exp(-pos*6));};if(typeof window.scrollTo!=='function'){Effect.ScrollTo=function(element){var options=arguments[1]||{},scrollOffsets=document.viewport.getScrollOffsets(),elementOffsets=$(element).cumulativeOffset();if(options.offset)
    elementOffsets[1]+=options.offset;var body=$(document).body;return new Effect.Tween(null,scrollOffsets.top,elementOffsets[1],options,function(p){body.scrollTop=p.round();});}
    setTimeout(function(){Element.scrollTo=function(element){var body=$(document).body;element=$(element);var pos=Element.cumulativeOffset(element);body.scrollTop=pos[1];return element;}},0);}}
function contentPartReadMoreLess(l,c){if(!c.visible()){c.show();l.innerHTML=Language['CityGuide_CityInfo_ReadLess'];}
else{l.innerHTML=Language['CityGuide_CityInfo_ReadMore'];new Effect.SlideUp(c);new Effect.ScrollTo(c.previous().identify());}}
if(typeof Element!='undefined'){Element.scrollToElement=function(container,element){var c=$(container);var co=c.cumulativeOffset()
    var eo=$(element).cumulativeOffset();c.scrollLeft=eo.left-co.left;c.scrollTop=eo.top-co.top;}}
Object.extend(String,{pad:function(number,length){var str=''+number;while(str.length<length){str='0'+str;}
    return str;}});var saveToQueryParams=String.prototype.toQueryParams;Object.extend(String.prototype,{toQueryParams:function(sep){var result=null;try{result=saveToQueryParams.call(this,sep);}
catch(e)
{}
    if(result==null){var s=unescape(this);result=saveToQueryParams.call(s,sep);}
    return result;}});function getRelativeDate(date){return date.momondoGetRelativeDate();}
Object.extend(Date.prototype,{equals:function(d){return this.getFullYear()===d.getFullYear()&&this.getMonth()===d.getMonth()&&this.getDate()===d.getDate();},daysInMonth:function(){return Date.daysInMonth(this.getMonth(),this.getFullYear());},dayOfWeek:function(firstDayOfWeek){if(firstDayOfWeek===undefined){firstDayOfWeek=1;}
    return(this.getDay()-firstDayOfWeek+7)%7;},toUTC:function(){var d=new Date();d.setUTCFullYear(this.getFullYear(),this.getMonth(),this.getDate());d.setUTCHours(this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds());return d;},toUTCDate:function(){var d=new Date();d.setUTCFullYear(this.getFullYear(),this.getMonth(),this.getDate());d.setUTCHours(0,0,0,0);return d;},getDateOnly:function(midday){return!!midday?new Date(this.getFullYear(),this.getMonth(),this.getDate(),12,0):new Date(this.getFullYear(),this.getMonth(),this.getDate());},getUTCDateOnly:function(midday){return!!midday?new Date(this.getUTCFullYear(),this.getUTCMonth(),this.getUTCDate(),12,0):new Date(this.getUTCFullYear(),this.getUTCMonth(),this.getUTCDate());},getDaysDiff:function(toDate){var from=this.getDateOnly(true).getTime(),to=toDate.getDateOnly(true).getTime(),dstOffset=(this.getTimezoneOffset()*60000)-(toDate.getTimezoneOffset()*60000);return Math.floor((to-from+dstOffset)/86400000);},dateOnly:function(midday){this.setHours(midday===true?12:0,0,0,0);return this;},dayName:function(){return Date.getDayName(this.getDay(),false);},monthName:function(){return Date.getMonthName(this.getMonth());},dateString:function(){return this.momondoFormat();},timeString:function(am,pm){var hours=this.getHours(),mins=this.getMinutes(),suffix='';if(currentCulture==='en-US'){suffix=(hours<12)?(am||' AM'):(pm||' PM');if(hours===0){hours=12;}else if(hours>12){hours=hours-12;}}
    return String.pad(hours,2)+':'+String.pad(mins,2)+suffix;},timeStringUTC:function(am,pm){var hours=this.getUTCHours(),mins=this.getUTCMinutes(),suffix='';if(currentCulture==='en-US'){suffix=(hours<12)?(am||' AM'):(pm||' PM');if(hours===0){hours=12;}else if(hours>12){hours=hours-12;}}
    return String.pad(hours,2)+':'+String.pad(mins,2)+suffix;},momondoFormat:function(parameter){var dy=this.getFullYear(),dm=this.getMonth()+1,dd=this.getDate(),ys=dy.toString(),ms=dm.toString(),ds=dd.toString();if(ms.length===1){ms='0'+ms;}
    if(ds.length===1){ds='0'+ds;}
    if(!parameter&&currentCulture==='en-US'){return ms+'/'+ds+'/'+ys;}
    if(!parameter&&currentCulture==='sv-SE'){return ys+'-'+ms+'-'+ds;}
    if(!parameter&&(currentCulture==='zh-CN'||currentCulture==='zh-TW'||currentCulture==='zh-HK')){return ys+'-'+ms+'-'+ds;}
    return ds+'-'+ms+'-'+ys;},momondoGetRelativeDate:function(updateTags){if(updateTags===undefined){updateTags=true;}
    var dateDiff=new Date(new Date()-this).getTime();var minutes=Math.floor(dateDiff/(1000*60))%60;var hours=Math.floor(dateDiff/(1000*60*60))%24;var days=Math.floor(dateDiff/(1000*60*60*24));result='';if(updateTags){result+='<span class="relative_dates_update" time="'+this.getTime()+'">';}
    if(days>=7){result+=this.dateString()+' '+this.timeString();}
    else if(days>=1){result+=this.dayName()+' '+this.timeString();}
    else if(hours>1){result+=String.format(Language['RelativeDate_HoursAgo'],hours);}
    else if(hours===1){result+=Language['RelativeDate_HourAgo'];}
    else if(minutes>1){result+=String.format(Language['RelativeDate_MinutesAgo'],minutes);}
    else if(minutes===1){result+=Language['RelativeDate_MinuteAgo'];}
    else{result+=Language['RelativeDate_MomentsAgo'];}
    if(updateTags){result+='</span>';}
    return result;},momondoTimePassed:function(){var dateDiff=new Date(new Date()-this).getTime();return{seconds:Math.floor(dateDiff/1000)%60,minutes:Math.floor(dateDiff/60000)%60,hours:Math.floor(dateDiff/3600000)%24,days:Math.floor(dateDiff/86400000)%7,weeks:Math.floor(dateDiff/604800000)};},toMomondoDate:function(){return String.pad(this.getDate(),2)+'-'+String.pad(this.getMonth()+1,2)+'-'+String.pad(this.getFullYear(),4);},toISODate:function(){return String.pad(this.getFullYear(),4)+'-'+String.pad(this.getMonth()+1,2)+'-'+String.pad(this.getDate(),2);},toDateShort:function(){return String.pad(this.getFullYear(),4)+String.pad(this.getMonth()+1,2)+String.pad(this.getDate(),2);},toDateTimeShort:function(){return String.pad(this.getFullYear(),4)+String.pad(this.getMonth()+1,2)+String.pad(this.getDate(),2)+String.pad(this.getHours(),2)+String.pad(this.getMinutes(),2);},addDays:function(days){var h=this.getHours(),m=this.getMinutes(),d=new Date(this.getTime()+86400000*days);d.setHours(h);d.setMinutes(m);return d;},addMonths:function(months){var d=new Date(this.getTime()),m,delta,dm;if(months!==0){m=this.getMonth();delta=m+months;d.setMonth(delta);dm=(delta+12*Math.abs(months))%12;while(d.getMonth()>dm){d=d.addDays(-1);}}
    return d;},addYears:function(years){return this.addMonths(years*12);},getMaxDays:function(){var d=new Date(this.getTime()),m=d.getMonth(),day=28;while(d.getMonth()===m&&day<=32){day++;d.setDate(day);}
    return day-1;},getWeekNumber:function(firstDayOfWeek){if(firstDayOfWeek===undefined){firstDayOfWeek=1;}
    var tempDate=new Date(this);tempDate.setDate(tempDate.getDate()-(tempDate.getDay()+(7-firstDayOfWeek))%7+3);var dms=tempDate.valueOf();tempDate.setMonth(0);tempDate.setDate(4);return Math.round((dms-tempDate.valueOf())/(604800000))+1;},between:function(min,max,defMin,defMax,exclusive){if(!min||min.UTC===undefined){min=defMax===undefined?Date.MIN_VALUE:defMin;}
    if(!max||max.UTC===undefined){max=defMax===undefined?Date.MAX_VALUE:defMax;}
    return exclusive?(this>min&&this<max):(this>=min&&this<=max);}});Object.extend(Date,{MIN_VALUE:new Date(1900,1,1),MAX_VALUE:new Date(2100,1,1),momondoParse:function(s,midday){if(typeof midday=='undefined')midday=true;var regex=/(\d+)-(\d+)-(\d\d(\d\d)?)/;if(currentCulture=='en-US')
    regex=/(\d+)\/(\d+)\/(\d\d(\d\d)?)/;if(currentCulture=='sv-SE')
    regex=/(\d\d(\d\d)?)-(\d+)-(\d+)/;if(currentCulture=='zh-CN'||currentCulture=='zh-TW'||currentCulture=='zh-HK')
    regex=/(\d\d(\d\d)?)-(\d+)-(\d+)/;var match=regex.exec(s);if(match!=null&&match.index>=0){var d=match[1];var m=match[2];var y=match[3];if(currentCulture=='en-US'){d=match[2];m=match[1];}
    if(currentCulture=='sv-SE'){y=match[1];m=match[3];d=match[4];}
    if(currentCulture=='zh-CN'||currentCulture=='zh-TW'||currentCulture=='zh-HK'){y=match[1];m=match[3];d=match[4];}
    if(y.length==2)
        y='20'+y;return!!midday?new Date(y,parseInt(m,10)-1,d,12):new Date(y,parseInt(m,10)-1,d);}
else{regex=/(\d\d\d\d)(\d\d)(\d\d)((\d\d)(\d\d))?/;match=regex.exec(s);if(match!=null&&match.index>=0){var y=match[1];var m=match[2];var d=match[3];var dt=!!midday?new Date(y,parseInt(m,10)-1,d,12):new Date(y,parseInt(m,10)-1,d);var t=match[4];if(t){var h=match[5];var mn=match[6];if(!h)h=0;if(!mn)mn=0;dt.setHours(h,mn,0,0);}
    return dt;}}
    return null;},daysInMonth:function(){var a=arguments;if(a&&a.length>0){var m=-1;var y=-1;if(a.length==2){m=a[0];y=a[1];}
else{var arg=a[0];if(typeof arg=='object'&&typeof arg.getFullYear=='function'){m=arg.getMonth();y=arg.getFullYear();}
else if(typeof arg=='number'){m=arg;y=new Date().getFullYear();}}
    if(y<=0||m<0||m>=12)
        return 0;else
        return 32-new Date(y,m,32).getDate();}
    return 0;},getTicks:function(){return(new Date()).getTime();},getDayName:function(dow,shorter){var dtf=MomondoInfo.CultureInfo.CurrentCulture.dateTimeFormat;var names=shorter?dtf.ShortestDayNames:dtf.DayNames;return names[dow];},getMonthName:function(m,shorter){var dtf=MomondoInfo.CultureInfo.CurrentCulture.dateTimeFormat;var names=shorter?dtf.AbbreviatedMonthNames:dtf.MonthNames;return names[m];},fromUTC:function(secs){var dt=new Date(0);dt.setUTCSeconds(secs);var d=new Date(0);d.setFullYear(dt.getUTCFullYear(),dt.getUTCMonth(),dt.getUTCDate());d.setHours(dt.getUTCHours(),dt.getUTCMinutes(),dt.getUTCSeconds());return d;},fromDateShort:function(dateShort){var y=parseInt(dateShort.substr(0,4),10);var m=parseInt(dateShort.substr(4,2),10);var d=parseInt(dateShort.substr(6,2),10);var dt=new Date();dt.setFullYear(y,m-1,d);dt.setHours(0,0,0,0);return dt;},fromISO:function(isoString,midday){var parts=isoString.split('T');var a=parts[0].split('-');var b=parts[1].split(':');return new Date(a[0],a[1]-1,a[2],!!midday?12:b[0],b[1],b[2].replace('Z',''));}});(function updateRelativeDates(){$$('.relative_dates_update').each(function(e){var d=new Date();d.setTime(parseInt(e.attributes['time'].value));e.update(d.momondoGetRelativeDate(false));});updateRelativeDates.delay(6);}).delay(6);Element.addMethods({setDisplay:function(element,display){if(display)
    element.show();else
    element.hide();},showOne:function(element){var parent=element.up();parent.childElements().each(function(e){if(element==e||e.hasClassName('do-not-hide'))
    e.show();else
    e.hide();});},addClassNameToOne:function(element,classname){var parent=element.up();parent.childElements().each(function(e){if(element==e)
    e.addClassName(classname);else
    e.removeClassName(classname);});}});Element.addMethods('TEXTAREA',{elastic:function(element,options){if(!options)
    options={};element=$(element);if(typeof options.watermarkText=='undefined')
    options.watermarkText='';if(typeof options.controlToShowOnFocus=='undefined')
    options.controlToShowOnFocus=null;else
    options.controlToShowOnFocus=$(options.controlToShowOnFocus);if(typeof options.onResize=='undefined')
    options.onResize=Prototype.emptyFunction;if(typeof options.minHeight=='undefined')
    options.minHeight=0;this.options=options;var mimics=['paddingTop','paddingRight','paddingBottom','paddingLeft','fontSize','lineHeight','fontFamily','width','fontWeight','textAlign'];var marginbottom=parseInt(element.getStyle('lineHeight'))||parseInt(element.getStyle('fontSize'));if(options.minHeight>0&&marginbottom<options.minHeight)
    marginbottom=options.minHeight;var minheight=parseInt(element.getStyle('height'))||marginbottom;if(options.minHeight>0&&minheight<options.minHeight)
    minheight=options.minHeight;var goalheight=0;var twin=null;function update(){if(!twin){twin=new Element('div').setStyle({'display':'none','position':'absolute'});$(document.body).appendChild(twin);mimics.each(function(e){var style=new Object();eval('style.'+e+'=\''+element.getStyle(e)+'\';');twin.setStyle(style);});}
    var content=element.value.replace(/<|>/g,' ').replace(/\n/g,'<br />').replace(/&/g,"&amp;").replace(/  /g,' &nbsp;');if(element.value==options.watermarkText){element.setStyle({'height':marginbottom+'px'});twin.innerHTML=content;}
    else if(twin.innerHTML!=content){twin.innerHTML=content;goalheight=(twin.getHeight()+marginbottom>minheight)?twin.getHeight()+marginbottom:minheight;if(Math.abs(goalheight-element.getHeight())>1)
        element.setStyle({'height':goalheight+'px'});if(options.onResize!=null)
        options.onResize();}}
    element.setStyle({overflow:'hidden',display:'block'});element.observe('focus',function(){element.periodicalUpdater=window.setInterval(function(){update();},400);if(element.value==options.watermarkText){element.addClassName('selected');element.removeClassName('unselected');element.value='';update();if(options.controlToShowOnFocus!=null)
        options.controlToShowOnFocus.show();}});element.observe('blur',function(){clearInterval(element.periodicalUpdater);this.clearelastic(element);update();});element.value=options.watermarkText;element.addClassName('unselected');update();},clearelastic:function(element){if(element.value==''){element.addClassName('unselected');element.removeClassName('selected');element.value=options.watermarkText;if(this.options.controlToShowOnFocus!=null)
    this.options.controlToShowOnFocus.hide();}},unelastic:function(element){element=$(element);element.stopObserving('focus');element.stopObserving('blur');},acceptTabs:function(element){var handler=element.retrieve('acceptTabsHandler');if(handler){handler.start();}
else{handler=element.on('keypress',function(ev){if(ev.keyCode==9){var myValue="\t";var startPos=this.selectionStart;var endPos=this.selectionEnd;var scrollTop=this.scrollTop;this.value=this.value.substring(0,startPos)+myValue+this.value.substring(endPos,this.value.length);this.focus();this.selectionStart=startPos+myValue.length;this.selectionEnd=startPos+myValue.length;this.scrollTop=scrollTop;ev.stop();}}.bindAsEventListener(element));element.store('acceptTabsHandler',handler);}}});Element.addMethods('INPUT',{setCaretTo:function(element,pos){if(element.type!='text')
    return;if(element.createTextRange){var range=element.createTextRange();range.move('character',pos);range.select();}
else if(element.selectionStart){element.focus();element.setSelectionRange(pos,pos);}}});if(typeof Prototype=='object'){Prototype.Browser.IEMajorVersion=-1;var regex=/MSIE (\d+)\.(\d+).*/;if(regex.match(navigator.appVersion)){var matches=regex.exec(navigator.appVersion);Prototype.Browser.IEMajorVersion=parseInt(matches[1],10);}}
if(!String.prototype.parseUrl){String.prototype.parseUrl=function(){var matches=this.match(arguments.callee.re);if(!matches){return null;}
    var result={'scheme':matches[1]||'','subscheme':matches[2]||'','user':matches[3]||'','pass':matches[4]||'','host':matches[5],'port':matches[6]||'','path':matches[7]||'','query':matches[8]||'','fragment':matches[9]||''};return result;};String.prototype.parseUrl.re=/^(?:([a-z]+):(?:([a-z]*):)?\/\/)?(?:([^:@]*)(?::([^:@]*))?@)?((?:[a-z0-9_-]+\.)+[a-z]{2,}|localhost|(?:(?:[01]?\d\d?|2[0-4]\d|25[0-5])\.){3}(?:(?:[01]?\d\d?|2[0-4]\d|25[0-5])))(?::(\d+))?(?:([^:\?\#]+))?(?:\?([^\#]+))?(?:\#([^\s]+))?$/i;}
if(!String.prototype.trim){String.prototype.trim=function(){var trimLeft=/^\s+/;var trimRight=/\s+$/;return this.replace(trimLeft,'').replace(trimRight,'');};}
if(!Number.prototype.toRad){Number.prototype.toRad=function(){return this*Math.PI/180;}}
if(!Number.prototype.toDeg){Number.prototype.toDeg=function(){return this*180/Math.PI;}}
if(!Number.prototype.between){Number.prototype.between=function(min,max,defMin,defMax,exclusive){if(typeof min!='number')min=typeof defMin=='undefined'?Number.MIN_VALUE:defMin;if(typeof max!='number')max=typeof defMax=='undefined'?Number.MAX_VALUE:defMax;return exclusive?(this>min&&this<max):(this>=min&&this<=max);}}
Number.prototype.toFormattedString=function(grpSep,decSep){var number=this;var arrNum=number.toString().split('.');var decimals=arrNum.length>1?arrNum[1]:'';var numberOfSeparators=Math.floor(Math.log(number)/Math.log(1000));var numberParts=[];var part=0;var divisor=0;for(var i=numberOfSeparators;i>=0;i--){divisor=Math.pow(1000,i);part=Math.floor(number/divisor);number=(number-(Math.floor(number/divisor)*divisor));numberParts.push(part.toPaddedString(i<numberOfSeparators?3:0));}
    return numberParts.join(grpSep)+(decimals.length?decSep+decimals:'');}
if(!Function.prototype.curry){Function.prototype.curry=function(){var args=[]
    for(var i=0,len=arguments.length;i<len;i++){args[i]=arguments[i];}
    var f=this;return function(){args.push.apply(args,arguments)
        f.apply(f,args);}}}
if(!Function.prototype.throttle){Function.prototype.throttle=function(timeMS){var func=this;var nextCall=0;var timeout=null;return function(){var now=+(new Date());if(!!nextCall){window.clearTimeout(timeout);nextCall=now+(nextCall-now);}else
    nextCall=now+(timeMS);var args=arguments;var time=nextCall-now;timeout=window.setTimeout(function(){nextCall=0;func.apply(null,args);},time);}}}
function writeAd(src){src=src.replace('#JS:TIMESTAMP#',Date.getTicks());document.write(src);}
function constructEx(constructor,args){function F(){return constructor.apply(this,args);}
    F.prototype=constructor.prototype;return new F();}
if(typeof Draggables!='undefined'){Draggables.updateDrag=function(event){if(!this.activeDraggable)return;var pointer=[Event.pointerX(event),Event.pointerY(event)];if(this._lastPointer&&(this._lastPointer.inspect()==pointer.inspect())){Event.stop(event);return;}
    if(this._lastPointer&&(this._lastPointer.inspect()==pointer.inspect()))return;this._lastPointer=pointer;this.activeDraggable.updateDrag(event,pointer);};}
new(Class.create(Abstract.TimedObserver,{getValue:function(){return location.hash;}}))(null,0.2,function(el,value){document.fire('momondo:hashchange');});window.requestAnimFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback,element){window.setTimeout(callback,17);};})();var HoverIntent=Class.create({initialize:function(element,options){this.element=$(element);if(Object.isUndefined(options))
    options={};if(Object.isUndefined(options.groupID))
    options.groupID='__general';if(!Object.isNumber(options.openTimeout))
    options.openTimeout=0.1;if(!Object.isNumber(options.closeTimeout))
    options.closeTimeout=0.0;if(!Object.isFunction(options.onEnter))
    options.onLeave=Prototype.emptyFunction;if(!Object.isFunction(options.onLeave))
    options.onLeave=Prototype.emptyFunction;this.element.on('mouseenter',this.mouseEnter.bindAsEventListener(this));this.element.on('mouseleave',this.mouseLeave.bindAsEventListener(this));this.mouseMoveHandler=null;this.hoverIntentTimer=0;this.hoverCloseTimer=0;this.options=options;var h=HoverIntent.hoverIntents;var a=h.get(options.groupID)||[];a.push(this);h.set(options.groupID,a);},clearTimer:function(){if(this.hoverIntentTimer){window.clearTimeout(this.hoverIntentTimer);this.hoverIntentTimer=0;}},mouseEnter:function(ev){var h=HoverIntent.hoverIntents;var a=h.get(this.options.groupID)||[];a.each(function(hi){if(hi.hoverCloseTimer)
    hi.hoverClose();},this);this.mouseMoveHandler=this.element.on('mousemove',this.mouseMove.bind(this));this.mouseMove();},mouseMove:function(ev){this.clearTimer();this.hoverIntentTimer=this.intented.bind(this).delay(this.options.openTimeout);},clearIntent:function(){this.clearTimer();if(this.mouseMoveHandler){this.mouseMoveHandler.stop();this.mouseMoveHandler=null;}},intented:function(){this.clearIntent();this.options.onEnter(this.element);},mouseLeave:function(ev){this.clearIntent();this.hoverCloseTimer=this.hoverClose.bind(this).delay(this.options.closeTimeout);},hoverClose:function(){this.hoverCloseTimer=0;this.options.onLeave(this.element);},isAlive:function(){return this.element.parentNode!=null;}});HoverIntent.hoverIntents=new Hash();HoverIntent.cleanup=function(){var h=HoverIntent.hoverIntents;h.each(function(kv){var a=h.get(kv.key);a=a.filter(function(e){return e.isAlive();});if(a.length>0)
    h.set(kv.key,a);else
    h.unset(kv.key);});HoverIntent.cleanup.delay(1.0);};HoverIntent.cleanup();Element.addMethods({hoverIntent:function(element,onEnter,onLeave,options){options=options||{};options.onEnter=onEnter;options.onLeave=onLeave;return new HoverIntent(element,options);}});Array.prototype.remove=function(from,to){var rest=this.slice((to||from)+1||this.length);this.length=from<0?this.length+from:from;return this.push.apply(this,rest);};Hash.prototype.setIf=function(key,value,predicate){var doSet=true,current=this.get(key);if(current){if(typeof predicate=='function')
    doSet=predicate(current,value);else
    doSet=predicate;}
    if(doSet)
        this.set(key,value);};function triggerButtonClickOnEnter(event,target){if(event.keyCode==13){var src=event.srcElement||event.target;if(!src||(src.tagName.toLowerCase()!="textarea")){var defaultButton=document.getElementById(target);if(defaultButton&&typeof(defaultButton.click)!="undefined"){defaultButton.click();event.cancelBubble=true;if(event.stopPropagation)event.stopPropagation();return false;}}}
    return true;}
function extendNamespace(ns,ns_string){var parts=ns_string.split('.'),parent=ns,pl,i;if(parts[0]=="momondo"){parts=parts.slice(1);}
    pl=parts.length;for(i=0;i<pl;i++){if(typeof parent[parts[i]]=='undefined'){parent[parts[i]]={};}
        parent=parent[parts[i]];}
    return parent;}
var __extends=this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d;}
        __.prototype=b.prototype;d.prototype=new __();};window.performance=window.performance||{};performance.now=(function(){return performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow||function(){return new Date().getTime();};})();var MomondoCookies=new(function(){this.initialize=function()
{this.cookiesEnabled=this.testCookiesEnabled();};this.setCookie=function(name,value,expires,path,domain,secure)
{var today=new Date();today.setTime(today.getTime());if(expires)
    expires=expires*1000*60*60*24;var expiresDate=new Date(today.getTime()+(expires));document.cookie=name+"="+escape(value)+
    ((expires)?";expires="+expiresDate.toGMTString():"")+
    ((path)?";path="+path:"")+
    ((domain)?";domain="+domain:"")+
    ((secure)?";secure":"");};this.getCookie=function(name)
{var start=document.cookie.indexOf(name+"=");var len=start+name.length+1;if((!start)&&(name!=document.cookie.substring(0,name.length)))
{return null;}
    if(start==-1)
        return null;var end=document.cookie.indexOf(";",len);if(end==-1)
    end=document.cookie.length;return unescape(document.cookie.substring(len,end));};this.deleteCookie=function(name,path,domain)
{if(this.getCookie(name))
    document.cookie=name+"="+
        ((path)?";path="+path:"")+
        ((domain)?";domain="+domain:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT";};this.testCookiesEnabled=function()
{var cookieSet=false;this.setCookie('cookietest','none','','/','','');if(this.getCookie('cookietest'))
{cookieSet=true;this.deleteCookie('cookietest','/','');}
    return cookieSet;};this.initialize();});var Set_Cookie=MomondoCookies.setCookie.bind(MomondoCookies);var Get_Cookie=MomondoCookies.getCookie.bind(MomondoCookies);var Delete_Cookie=MomondoCookies.deleteCookie.bind(MomondoCookies);var TestCookiesEnabled=MomondoCookies.testCookiesEnabled.bind(MomondoCookies);var cookiesEnabled=MomondoCookies.cookiesEnabled;;var __dialogZIndex=1000;var __activeDialog=[];var Dialog=Class.create({initialize:function(options)
{if(typeof options=='undefined')
    options={};if(typeof options.fixed=='undefined')
    options.fixed=false;if(typeof options.cancelButtons=='undefined')
    options.cancelButtons=[];if(typeof options.okayButtons=='undefined')
    options.okayButtons=[];if(typeof options.onCancel=='undefined')
    options.onCancel=Prototype.emptyFunction;if(typeof options.onOkay=='undefined')
    options.onOkay=Prototype.emptyFunction;if(typeof options.onValidate=='undefined')
    options.onValidate=function(){return true;};if(typeof options.onHide=='undefined')
    options.onHide=Prototype.emptyFunction;if(typeof options.fade=='undefined')
    options.fade=false;if(typeof options.minTop=='undefined')
    options.minTop=0;if(typeof options.overlayCancel=='undefined')
    options.overlayCancel=true;options._saveDialog=false;if(typeof options.contentElement!='undefined'&&typeof options.savingElement!='undefined')
    options._saveDialog=true;this.options=options;this.visible=false;this._initialized=false;},_setup:function()
{if(this._initialized)
    return;if(typeof this.options.dialogContent!='undefined')
{if($(this.options.dialogElement)==null)
{var div=new Element('div');div.id=this.options.dialogElement;div.innerHTML=this.options.dialogContent;this.options.dialogElement=div;}}
    this.dialogElement=$(this.options.dialogElement);this.dialogElement.hide();if(this.dialogElement.parentElement!=document.body)
    document.body.appendChild(this.dialogElement);var event=this._onCancel.bindAsEventListener(this);this.options.cancelButtons.each(function(c)
{c=$(c);if(c!=null)
    c.observe('click',event);else
    throw'Cancel button '+c+' not found';});var event=this._onOkay.bindAsEventListener(this);this.options.okayButtons.each(function(c)
{c=$(c);if(c!=null)
    c.observe('click',event);else
    throw'Okay button '+c+' not found';});this.supportsFixed=true;var majorVersion=-1;var regex=/MSIE (\d+)\.(\d+).*/;if(regex.match(navigator.appVersion))
{var matches=regex.exec(navigator.appVersion);majorVersion=parseInt(matches[1],10);}
    if(Prototype.Browser.IE&&majorVersion<7)
        this.supportsFixed=false;this._initialized=true;},_createOverlay:function()
{this.overlay=$('overlay');if(this.overlay==null)
{this.overlay=new Element('div');this.overlay.id='overlay';if(this.options.overlayCancel)
{this.overlay.observe('click',function()
{var activeDialog=__activeDialog[__activeDialog.length-1];activeDialog._onCancel();});}
    $(document.body).insert(this.overlay);}
    var dimensions=document.viewport.getDimensions();var width=dimensions.width;$$('html,body').invoke('setStyle',{height:'auto'});var height=Math.max($(document.body).getHeight(),dimensions.height);$$('html,body').invoke('setStyle',{height:''});var overlay=this.overlay;var f=function()
{overlay.setStyle({position:'fixed',top:'0',left:'0',bottom:'0',right:'0',background:'black'});};f.defer();this.overlay.setOpacity(0.5);},_onScroll:function()
{this.position();},_onResize:function()
{this.position();},_onCancel:function()
{this.options.onCancel();this.hide();return false;},_onOkay:function()
{if(this.options.onValidate())
{if(this.options._saveDialog)
{this.options.savingElement.show();this.options.contentElement.hide();}
    this.options.onOkay();if(!this.options._saveDialog)
    this.hide();}
    return false;},position:function()
{this._setup();var parentContext=typeof ParentContext!=='undefined'?ParentContext:null;var dimensions=document.viewport.getDimensions();var dialogDimensions=this.dialogElement.getDimensions();var top=0;var left=Math.round((dimensions.width/2)-(this.dialogElement.getWidth()/2));if(parentContext)
{var deltaHeight=parentContext.innerHeight-this.dialogElement.getHeight();if(deltaHeight>0)
    top=Math.round(deltaHeight/2);top+=parentContext.scrollTop;}else
{top=Math.round((dimensions.height/2)-(this.dialogElement.getHeight()/2));if(top<this.options.minTop)
    top=this.options.minTop;}
    if(this.options.fixed&&this.supportsFixed)
    {this.dialogElement.setStyle({position:'fixed',top:top+'px',left:left+'px',zIndex:this.zIndex});}
    else
    {top=document.viewport.getScrollOffsets().top+top;this.dialogElement.setStyle({position:'absolute',top:top+'px',left:left+'px',zIndex:this.zIndex});}},show:function()
{if(this.visible)
    return;this._setup();if(this.options._saveDialog)
{this.options.savingElement.hide();this.options.contentElement.show();}
    __dialogZIndex+=2;this.zIndex=__dialogZIndex;this._createOverlay();this.overlay.setStyle({zIndex:__dialogZIndex-1});this.overlay.show();$$('iframe,object,embed').each(function(e){if(!e.hasClassName('nohide')&&!e.descendantOf(this.dialogElement))e.setStyle({visibility:'hidden'});},this);this.position();if(this.options.fixed&&!this.supportsFixed)
{this._onScrollHandler=this._onScroll.bindAsEventListener(this);Event.observe(window,'scroll',this._onScrollHandler);}
    this._onResizeHandler=this._onResize.bindAsEventListener(this);Event.observe(window,'resize',this._onResizeHandler);if(this.options.fade)
    new Effect.Appear(this.dialogElement,{duration:0.5});else
    this.dialogElement.show();__activeDialog.push(this);this.visible=true;},hide:function()
{if(!this.visible)
    return;if(typeof this.options.onHide=='function')
    this.options.onHide(this);this._createOverlay();__dialogZIndex-=2;if(__dialogZIndex==1000)
{this.overlay.hide();$$('iframe,object,embed').each(function(e){if(!e.hasClassName('nohide')&&!e.descendantOf(this.dialogElement))e.setStyle({visibility:'visible'});},this);}
    this.overlay.setStyle({zIndex:__dialogZIndex-1});this.dialogElement.hide();if(this.options.fixed&&!this.supportsFixed)
    Event.stopObserving(window,'scroll',this._onScrollHandler);Event.stopObserving(window,'resize',this._onResizeHandler);__activeDialog.pop();this.visible=false;}});var GenericDialog=Class.create(Dialog,{initialize:function($super,options)
{options=options||{};var container=new Element('div');container.id='genericdialog';container.innerHTML='<div class="close"></div>';var elem=options.contentElement;if(!elem)
{elem=new Element('div');elem.addClassName('content');elem.innerHTML=options.contentHtml;}
    container.appendChild(elem);options=Object.extend(options,{dialogElement:container,cancelButtons:container.select('.close')});$super(options);}});var IFrameDialog=Class.create(Dialog,{initialize:function($super,id,width,height,src,options)
{this.options=options?options:{};IFrameDialog.instances[id]=this;if(src.indexOf('?')<0)
    src+='?';else
    src+='&';src+='frameDialogId='+id;this.id=id;this.src=src;var loadingContent='<table cellpadding="0" cellspacing="0" style="margin-left:auto;margin-right:auto;margin-top:275px"><tr>';loadingContent+='<td style="padding-right:10px"><img src="/Themes/Momondo/Images/SkyGate/big_wait_purple.gif" /></td>';loadingContent+='<td style="font-size:18px">'+Language['MapItem_Loading']+'</td>';loadingContent+='</tr></table>';var styles='width:'+width+'px;height:'+height+'px;';var iframe='<iframe class="iframe nohide" style="'+styles+'" allowtransparency="false" frameborder="0"></iframe>';$super({dialogElement:id,dialogContent:'<div class="iframe-dialog" style="'+styles+'border:1px solid #333333;"><div class="loading" style="'+styles+'">'+loadingContent+'</div>'+iframe+'</div>'});},callback:function($super)
{if(this.options.onCallback)
    this.options.onCallback(arguments);},show:function($super)
{$super();this.addFrame.bind(this).defer();},addFrame:function()
{var e=$(this.id);var f=e.select('.iframe')[0];f.observe('load',this.hideLoading.bind(this));f.src=this.src;},hide:function($super)
{$super();$(this.id).remove();IFrameDialog.instances[this.id]=null;},hideLoading:function()
{var e=$(this.id);e.select('.loading')[0].hide();}});IFrameDialog.instances={};var LoaderDialog=Class.create(Dialog,{initialize:function($super,id,width,height,src,options)
{this.options=options?options:{};LoaderDialog.instances[id]=this;if(src.indexOf('?')<0)
    src+='?';else
    src+='&';src+='dialogId='+id;this.id=id;this.src=src;var loadingContent='<table cellpadding="0" cellspacing="0" style="margin-left:auto;margin-right:auto;margin-top:275px"><tr>';loadingContent+='<td style="padding-right:10px"><img src="/Themes/Momondo/Images/SkyGate/big_wait_purple.gif" /></td>';loadingContent+='<td style="font-size:18px">'+Language['MapItem_Loading']+'</td>';loadingContent+='</tr></table>';var closeButtonContent='';if(options.closeButton===true)
{closeButtonContent='<div class="close-button"><button class="pink small" onclick="return false;">'+Language['general_close']+'</button></div>';}
    var content='<div class="dialog-content"><div class="content"></div>'+closeButtonContent+'</div>';var styles='height:'+height+'px;width:'+width+'px;';this.loadMethod=LoaderWS.LoadPageHtml;if(options.control===true)
    this.loadMethod=LoaderWS.LoadControlHtml;if(typeof options.removeOnHide!='boolean')
    options.removeOnHide=true;$super({dialogElement:id,dialogContent:'<div class="loader-dialog" style="'+styles+'border:1px solid #333333;"><div class="loading" style="'+styles+'">'+loadingContent+'</div>'+content+'</div>'});},callback:function($super)
{if(this.options.onCallback)
    this.options.onCallback(arguments);},show:function($super)
{$super();this.loadContent.bind(this).defer();},loadContent:function()
{this.loadMethod(this.src,this.insertContent.bind(this),this.failure.bind(this));},failure:function()
{alert('failure');},insertContent:function(html)
{var e=$(this.id);var f=e.down('.dialog-content .content');f.update(html);var c=e.down('.close-button');if(c)
{c.down('button').on('click',this.hide.bind(this));var eh=e.measure('padding-box-height');var ch=c.measure('padding-box-height');var fp=f.measure('margin-top')+f.measure('margin-bottom');f.setStyle({height:(eh-ch-fp)+'px'});}
    this.hideLoading();},hide:function($super)
{$super();if(this.options.removeOnHide)
    $(this.id).remove();LoaderDialog.instances[this.id]=null;},hideLoading:function()
{var e=$(this.id);e.down('.loading').hide();}});LoaderDialog.instances={};var MomondoCss=new(Class.create({pollCount:0,initialize:function()
{},load:function(styleSheet,callback)
{var node=null,gecko=Prototype.Browser.Gecko,webKit=Prototype.Browser.WebKit;this.pollCount=0;if(gecko)
{node=new Element('style');node.innerHTML='@import "'+styleSheet+'";';this._pollGecko(node,callback);}
else
{node=new Element('link',{href:styleSheet,type:'text/css',rel:'stylesheet'});if(webKit)
    this._pollWebKit(node.href,callback);else
    node.on('load',callback);}
    $$('head')[0].insert(node);},_pollGecko:function(node,callback)
{var hasRules;try
{hasRules=!!node.sheet.cssRules;}
catch(ex)
{this.pollCount+=1;if(this.pollCount<200)
    this._pollGecko.bind(this).delay(0.05,node,callback);else
    hasRules&&callback();return;}
    callback();},_pollWebKit:function(stylesheet,callback)
{var styleSheets=document.styleSheets;for(var i=0,len=styleSheets.length;i<len;i++)
{if(styleSheets[i].href===stylesheet)
{callback();return;}}
    this.pollCount+=1;if(this.pollCount<200)
    this._pollWebKit.bind(this).delay(0.05,stylesheet,callback);else
    callback();}}))();var PagedDialog=Class.create(Dialog,{initialize:function($super,pages,options)
{this.id=PagedDialog.id;options=typeof options!='undefined'?options:{};var showCloseButton=options.showCloseButton!=null?options.showCloseButton:true;var closeButtonSpriteClass=options.closeButtonSpriteClass||'';this.framePadding=options.framePadding!=null?options.framePadding:10;this.id=options.id!=null?options.id:this.id;PagedDialog.dialogs.set(this.id,this);$super({dialogElement:'__momondo_pagedialog'+this.id,dialogContent:'<div style="float:right;display:'+(showCloseButton?'block':'none')+'" class="close_container"><a id="__momondo_pageddialog_close'+this.id+'" href="#" onclick="return false;">'+
(closeButtonSpriteClass!=''?'<div class="'+closeButtonSpriteClass+'"></div>':'<div class="close"><span>'+Language.general_close+'</span></div>')+'</a></div>'+'<div class="content" style="padding:'+this.framePadding+'px">'+'<div class="page1 page"></div>'+'<div class="page2 page"></div>'+'<div class="repository" style="display:none"></div>'+'</div>',cancelButtons:['__momondo_pageddialog_close'+this.id],okayButtons:[]});this.options=Object.extend(this.options,options);this.pages=pages;PagedDialog.id++;},_setup:function($super)
{if(!this._initialized)
{$super();this.dialogElement.addClassName('pageddialog');if(typeof this.options.className=='string')
    this.dialogElement.down('.content').addClassName(this.options.className);this.currentElementIndex=0;this.pageElements=[this.dialogElement.down('.page1'),this.dialogElement.down('.page2')];this.pageElements[1-this.currentElementIndex].hide();this.repositoryElement=this.dialogElement.down('.repository');}},show:function($super)
{$super();this.firstPageShow=true;if(typeof this.pages!='undefined')
{this.noTransition=true;this.currentPageIndex=-1;this.showPage(0);this.currentPageIndex=0;}},setDialogSize:function(page)
{this.pageElements.each(function(e){var cdcss=this.getContentDimensionsCss(page);var style=cdcss.parseStyle();e.setStyle(style.toObject());},this);this.dialogElement.setStyle(this.getDialogDimensionsCss(page).parseStyle().toObject());this.position();},showPage:function(arg)
{var page=null;if(typeof arg=='number')
{if(typeof this.pages=='undefined'||this.pages.length<arg)
    return;page=this.pages[arg]
    if(this.currentPageIndex==arg)
        return;this.currentPageIndex=arg;if(this.firstPageShow)
{this.firstPageShow=false;this.setDialogSize(page);}}
else if(typeof arg=='object')
    page=arg;else
    throw'Unknown argument to PagedDialog.showPage()';var hiddenPageElement=this.pageElements[1-this.currentElementIndex];switch(page.type)
{case PagedDialog.PAGETYPE_CONTROL:if(typeof page.element=='undefined')
    {this.loadedCss=false;LoaderWS.LoadControlHtml(this.addId(page.url),this.pageLoaded.bind(this,page,hiddenPageElement));}
    else
    {var element=$(page.element);if(element.up()!=hiddenPageElement)
        hiddenPageElement.update(element);this.transitionPage(page);}
        break;case PagedDialog.PAGETYPE_DOM:var element=$(page.element);if(element.up()!=hiddenPageElement)
        hiddenPageElement.update(element);this.transitionPage(page);break;}},addId:function(url)
{return url+(url.include('?')?'&':'?')+'id='+this.id;},pageLoaded:function(page,element,result)
{element.update('');element.insert(result);page.element=element.down();this.loadedPage=page;if(this.loadedCss||page.loadedCss)
    this.cssLoaded();},cssLoaded:function()
{this.loadedCss=true;if(this.loadedPage!=null)
{var page=this.loadedPage;if(typeof page.onLoaded=='function')
{page.onLoaded(page);}
    this.transitionPage.bind(this,page).delay(0.2);this.loadedPage=null;}},getContentDimensionsCss:function(page)
{return'width:'+page.width+'px;height:'+page.height+'px';},getDialogDimensionsCss:function(page)
{var l=this.dialogElement.down('.content').getLayout();return'width:'+(page.width+l.get('padding-left')+l.get('padding-right'))+'px;height:'+(page.height+l.get('padding-top')+l.get('padding-bottom'))+'px';},transitionPage:function(page)
{if(typeof page.onShow=='function')
    page.onShow();var currentPageElement=this.pageElements[this.currentElementIndex];var hiddenPageElement=this.pageElements[1-this.currentElementIndex];if(this.noTransition)
{this.noTransition=false;currentPageElement.hide();hiddenPageElement.show();}
else
{currentPageElement.fade({duration:0.5,afterFinish:function()
{hiddenPageElement.show();hiddenPageElement.setOpacity(0.0);var newSizeCss=this.getContentDimensionsCss(page);currentPageElement.setStyle(newSizeCss);this.dialogElement.morph(this.getDialogDimensionsCss(page),{duration:0.5,afterUpdate:this.position.bind(this),afterFinish:function()
{this.repositoryElement.insert(currentPageElement.down());if(typeof page.onShown=='function')
    page.onShown();hiddenPageElement.appear({duration:0.5});this.position.bind(this);}.bind(this)});hiddenPageElement.morph(this.getContentDimensionsCss(page));}.bind(this)});}
    this.currentElementIndex=1-this.currentElementIndex;}});PagedDialog.id=1;PagedDialog.dialogs=new Hash();PagedDialog.PAGETYPE_CONTROL=0;PagedDialog.PAGETYPE_DOM=1;PagedDialog._cssLoaded=function(id,callback)
{if(typeof callback=='string')
    callback=eval(callback);PagedDialog.dialogs.values().each(function(pd)
{if(pd.id==id||id=='')
{pd.cssLoaded();if(typeof callback=='function')
    callback();}});};PagedDialog.includeStylesheet=function(id,callback,href)
{if(!MomondoStyles.include(href))
{MomondoCss.load(href,PagedDialog._cssLoaded.curry(id,callback));MomondoStyles.push(href);}
else
    PagedDialog._cssLoaded(id,callback);};PagedDialog.includeStylesheets=function(id,callback,hrefs)
{var styles=[];hrefs.each(function(href)
{if(!MomondoStyles.include(href))
{MomondoStyles.push(href);styles.push(href);}},this);if(styles.length>0)
{var href='/st.ashx?s='+styles.join(',');MomondoCss.load(href,PagedDialog._cssLoaded.curry(id,callback));}
else
    PagedDialog._cssLoaded(id,callback);};PagedDialog.includeJavascript=function(src)
{if(!MomondoScripts.include(src))
{MomondoScripts.push(src);var script=new Element('script');script.writeAttribute('src',(src[0]!='/'&&!src.startsWith('http')?'/Themes/momondo/js/':'')+src);script.writeAttribute('type','text/javascript');$$('head').first().insert(script);}};PagedDialog.includeJavascripts=function(srcs)
{var scripts=[];srcs.each(function(src)
{if(!MomondoScripts.include(src))
{MomondoScripts.push(src);scripts.push(src);}},this);if(scripts.length>0)
{var script=new Element('script');script.writeAttribute('src','/sc.ashx?s='+scripts.join(','));script.writeAttribute('type','text/javascript');$$('head').first().insert(script);}};var AlertDialog=new(Class.create(Dialog,{initialize:function($super)
{$super({dialogElement:'alertdialog',dialogContent:'<div class="content clearfix">'+'<h2 id="alertdialog_header" class="boxHeader"></h2>'+'<div id="alertdialog_text"></div>'+'<div class="buttons">'+'<button id="alertdialog_cancel" class="medium darkgrey cancel"></button>'+'<button id="alertdialog_okay" class="medium orange okay"></button>'+'</div>'+'</div>',cancelButtons:['alertdialog_cancel'],okayButtons:['alertdialog_okay']});},alert:function(options)
{if(typeof options=='string')
    options={bodyText:options};if(typeof options!='object')
    options={};if(typeof options.autoHide=='undefined')
    options.autoHide=false;this.alertOptions=options;this._setup();if(typeof options.headerText!='string')
    options.headerText=Language['AlertDialog_Information'];options.bodyText=options.bodyText.replace('\n','<br />');$('alertdialog_header').update(options.headerText);$('alertdialog_text').update(options.bodyText);$('alertdialog_cancel').hide();if(typeof options.okayText!='string')
    options.okayText=Language['AlertDialog_Okay'];var okay=$('alertdialog_okay');okay.update(options.okayText);this.show();okay.focus();if(options.autoHide)
    this.hide.bind(this).delay(2);},confirm:function(options)
{if(typeof options!='object')
    options={};this.alertOptions=options;this._setup();if(typeof options.headerText!='string')
    options.headerText=Language['AlertDialog_Confirm'];options.bodyText=options.bodyText.replace('\n','<br />');$('alertdialog_header').update(options.headerText);$('alertdialog_text').update(options.bodyText);if(typeof options.cancelText!='string')
    options.cancelText=Language['AlertDialog_Cancel'];var cancel=$('alertdialog_cancel');cancel.update(options.cancelText);cancel.show();if(typeof options.okayText!='string')
    options.okayText=Language['AlertDialog_Okay'];var okay=$('alertdialog_okay');okay.update(options.okayText);this.show();},_onOkay:function($super)
{$super();if(typeof this.alertOptions.onOkay=='function')
    this.alertOptions.onOkay();},_onCancel:function($super)
{$super();if(typeof this.alertOptions.onCancel=='function')
    this.alertOptions.onCancel();}}));var alertDialog=AlertDialog;var Bubble=new(Class.create({COLOR_BLUE:0,ALIGN_LEFT:0,ALIGN_CENTER:1,ALIGN_RIGHT:2,initialize:function()
{this.ready=false;this.rendered=false;FastInit.addOnLoad(this.domLoaded.bind(this));},domLoaded:function()
{this.ready=true;},render:function()
{var html='<div id="dialog-bubble" class="bubble inline-block" style="display:none"><span class="text"></span></div>';$$('body').first().insert(html);this.dialogElement=$('dialog-bubble');this.dialogElement.on('click',function()
{this.dialogElement.hide();}.bind(this));this.rendered=true;},show:function(element,text,options)
{if(!this.ready)
    return;if(!this.rendered)
    this.render();if(!options)
    options={};if(typeof options.color=='undefined')
    options.color=this.COLOR_BLUE;if(typeof options.hAlign=='undefined')
    options.hAlign=this.ALIGN_CENTER;if(typeof options.offsetLeft=='undefined')
    options.offsetLeft=0;if(typeof options.offsetTop=='undefined')
    options.offsetTop=0;if(typeof options.autoHideDelay=='undefined')
    options.autoHideDelay=0;if(typeof options.zIndex=='undefined')
    options.zIndex=0;this.options=options;this.element=$(element);this.dialogElement.down('span.text').update(text);this.updatePosition(element);this.dialogElement.show();if(options.autoHideDelay>0)
    this.autoHideId=this.fade.bind(this).delay(options.autoHideDelay);},updatePosition:function()
{if(!this.element||!this.rendered)
    return;element=this.element;options=this.options;var layout=element.getLayout();var offsets=element.cumulativeOffset();var top=offsets.top;var left=offsets.left;var width=layout.get('border-box-width');dialogElementLayout=this.dialogElement.getLayout();var dialogWidth=dialogElementLayout.get('border-box-width');var offsetLeft=options.offsetLeft;var offsetTop=options.offsetTop;if(options.hAlign==this.ALIGN_CENTER)
    offsetLeft+=width/2;if(options.hAlign==this.ALIGN_RIGHT)
    offsetLeft+=width;this.dialogElement.setStyle({'top':(top-60)+offsetTop+'px','left':left-(dialogWidth-13)+offsetLeft+'px',zIndex:options.zIndex});},hide:function(fade)
{if(!this.rendered)
    return;if(typeof fade=='undefined')
    fade=false;if(typeof this.dialogElement.fade=='function')
    this.dialogElement.fade();else
    this.dialogElement.hide();if(this.autoHideId>0)
{window.clearTimeout(this.autoHideId);this.autoHideId=0;}},fade:function()
{this.hide(true);}}));document.on('keypress',function(ev)
{if(__activeDialog.length==0)
    return;if(document.activeElement.tagName=="TEXTAREA")
    return;var activeDialog=__activeDialog[__activeDialog.length-1];switch(ev.keyCode)
{case Event.KEY_RETURN:activeDialog._onOkay();ev.stop();break;case Event.KEY_ESC:activeDialog._onCancel();ev.stop();break;}});var ContentPartDialog=Class.create({initialize:function(name)
{this.loader=new LoaderDialog('MomondoContentPartDialog_'+name,800,600,'/Themes/momondo/controls/ContentPart.ascx?name='+name,{control:true,closeButton:true,removeOnHide:false});ContentPartDialog.instances[name]=this;},show:function()
{if(this.loader)
    this.loader.show();},hide:function()
{if(this.loader)
    this.loader.hide();}});ContentPartDialog.instances={};function MomondoShowContentPart(name)
{var dialog=ContentPartDialog.instances[name];if(dialog==null)
    dialog=new ContentPartDialog(name);dialog.show();}
var ContentDialog=Class.create({initialize:function(group)
{this.loader=new LoaderDialog('MomondoContentDialog_'+name,800,600,'/Themes/momondo/controls/Content.ascx?group='+group,{control:true,closeButton:true,removeOnHide:false});ContentDialog.instances[group]=this;},show:function()
{if(this.loader)
    this.loader.show();},hide:function()
{if(this.loader)
    this.loader.hide();}});ContentDialog.instances={};function MomondoShowContent(group)
{var dialog=ContentDialog.instances[group];if(dialog==null)
    dialog=new ContentDialog(group);dialog.show();};momondo.Settings=(function()
{function Settings()
{}
    Settings.prototype.getBool=function(key)
    {}
    return Settings;})();var LoaderWS=function(){LoaderWS.initializeBase(this);this._timeout=0;this._userContext=null;this._succeeded=null;this._failed=null;}
LoaderWS.prototype={_get_path:function(){var p=this.get_path();if(p)return p;else return LoaderWS._staticInstance.get_path();},LoadPageHtml:function(path,loadBodyOnly,succeededCallback,failedCallback,userContext){return this._invoke(this._get_path(),'LoadPageHtml',false,{path:path,loadBodyOnly:loadBodyOnly},succeededCallback,failedCallback,userContext);},LoadControlHtml:function(path,succeededCallback,failedCallback,userContext){return this._invoke(this._get_path(),'LoadControlHtml',false,{path:path},succeededCallback,failedCallback,userContext);}}
LoaderWS.registerClass('LoaderWS',Sys.Net.WebServiceProxy);LoaderWS._staticInstance=new LoaderWS();LoaderWS.set_path=function(value){LoaderWS._staticInstance.set_path(value);}
LoaderWS.get_path=function(){return LoaderWS._staticInstance.get_path();}
LoaderWS.set_timeout=function(value){LoaderWS._staticInstance.set_timeout(value);}
LoaderWS.get_timeout=function(){return LoaderWS._staticInstance.get_timeout();}
LoaderWS.set_defaultUserContext=function(value){LoaderWS._staticInstance.set_defaultUserContext(value);}
LoaderWS.get_defaultUserContext=function(){return LoaderWS._staticInstance.get_defaultUserContext();}
LoaderWS.set_defaultSucceededCallback=function(value){LoaderWS._staticInstance.set_defaultSucceededCallback(value);}
LoaderWS.get_defaultSucceededCallback=function(){return LoaderWS._staticInstance.get_defaultSucceededCallback();}
LoaderWS.set_defaultFailedCallback=function(value){LoaderWS._staticInstance.set_defaultFailedCallback(value);}
LoaderWS.get_defaultFailedCallback=function(){return LoaderWS._staticInstance.get_defaultFailedCallback();}
LoaderWS.set_enableJsonp=function(value){LoaderWS._staticInstance.set_enableJsonp(value);}
LoaderWS.get_enableJsonp=function(){return LoaderWS._staticInstance.get_enableJsonp();}
LoaderWS.set_jsonpCallbackParameter=function(value){LoaderWS._staticInstance.set_jsonpCallbackParameter(value);}
LoaderWS.get_jsonpCallbackParameter=function(){return LoaderWS._staticInstance.get_jsonpCallbackParameter();}
LoaderWS.set_path("/LoaderWS.asmx");LoaderWS.LoadPageHtml=function(path,loadBodyOnly,onSuccess,onFailed,userContext){LoaderWS._staticInstance.LoadPageHtml(path,loadBodyOnly,onSuccess,onFailed,userContext);}
LoaderWS.LoadControlHtml=function(path,onSuccess,onFailed,userContext){LoaderWS._staticInstance.LoadControlHtml(path,onSuccess,onFailed,userContext);}
var Currency=Class.create({initialize:function(selected,currencies)
{if(!selected)
    selected='EUR';this.current=selected;if(!currencies)
    currencies={};this.currencies=currencies;this.currentData=currencies?currencies[selected]:{};var numberGroupSeparator='';var decimalGroupSeparator='';var momInfo=MomondoInfo;if(momInfo)
{var numFormat=MomondoInfo.CultureInfo.CurrentCulture.numberFormat;numberGroupSeparator=numFormat.groupSeparator||numberGroupSeparator;decimalGroupSeparator=numFormat.decimalSeparator||decimalGroupSeparator;}
    this.numberGroupSeparator=numberGroupSeparator;this.decimalGroupSeparator=decimalGroupSeparator;},setCurrencies:function(currencies)
{this.currencies=currencies;},setCurrency:function(code)
{if(code)
{var code=code.toUpperCase();if(typeof Tracking!='undefined')
    Tracking.trackEvent('General','ChangedCurrency',String.format('{0}->{1}',this.current,code),null);this.current=code;var currencies=this.currencies;this.currentData=currencies[code]||{};$$('select.currency-sync').each(function(e)
{e.value=code;});if(typeof MomondoWS!='undefined'&&typeof MomondoWS.SetCurrency=='function')
    MomondoWS.SetCurrency(code);this.notify();}},notify:function()
{if(this.onChange)
    this.onChange();document.fire('currency:change');},getRate:function(code)
{var curr=this.currencies[code.toUpperCase()];if(curr==null)
    return 1.0;return curr.rate;},convertFromEUR:function(value,toCurrency)
{if(toCurrency==null)
    toCurrency=this.current;if(toCurrency=='EUR')
    return value;return value*this.getRate(toCurrency);},convertToEUR:function(value,fromCurrency)
{if(fromCurrency==null)
    fromCurrency=this.current;if(fromCurrency=='EUR')
    return value;return value/this.getRate(fromCurrency);},convert:function(value,fromCurrency,toCurrency)
{if(fromCurrency==null||toCurrency==null||fromCurrency==toCurrency)
    return value;var fromRate=this.getRate(fromCurrency);var toRate=this.getRate(toCurrency);return value*toRate/fromRate;},isCurrencyDisplayedBeforeAmount:function(currencyCode){return currencyCode==='CNY';},displayPrice:function(priceEUR,format)
{var price=Math.round(this.convertFromEUR(priceEUR));if(price>=1000)
{var str=price.toString();var parts=[];var idx=0;var p='';var sep=this.numberGroupSeparator;while(str.length>3)
{idx=str.length-3;p=sep+str.slice(idx)+p;str=str.substring(0,idx);}
    price=str+p;}
    var curr=this.currencies[this.current];if(!curr)
    curr={};if(!format)
{var format=curr.format;if(!format){format='<span class="price">{0} {1}</span>';if(curr.code==="CNY"){format='{1} <span class="price">{0}</span>';}}}
    return String.format(format,price.toString(),'<span class="currency">'+curr.code+'</span>',curr.symbol,curr.name);}});if(window.GCurrency===undefined)
{window.GCurrency=new Currency();}
function formatPriceEx(price,conv)
{if(conv)
    return GCurrency.displayPrice(price,'{0}');else
    return Math.round(price);}
function formatPrice(price)
{return GCurrency.displayPrice(price,'{0}');}
function currencyConvert(value)
{return GCurrency.convertFromEUR(value);}
function currencyConvertEUR(value)
{return GCurrency.convertToEUR(value);}
(function(factory){factory(jQuery);}(function($){return $.widget('mui.blobshow',{version:'0.1',defaultElement:'<div>',options:{parent:'section',matchHeight:null,ignoreMouse:null,autoPlayOnly:null,delay:10,allowSwipe:null,swipeContainer:null,altBg:null,fallbackBg:null,showNavigation:null,showNavigationDots:null,showNavigationArrows:null,activeClass:'_active',bgContainer:'.section-background .images',bgImageClass:'image'},_create:function(){var that=this;this.transitioning=false;if(this.options.autoPlayOnly===true){this.autoPlayTimer=false;this.options.allowSwipe=false;this.options.showNavigation=false;this.options.showNavigationDots=false;this.options.showNavigationArrows=false;}
    this.blobs=this.element.find('.mui-blobshow-blob');this.blobContainer=$('<div>',{'class':'mui-blobshow-blobs'}).appendTo(this.element);this.blobs.appendTo(this.blobContainer);this._initBlobs();this._drawNavigation();this._initSwipe();this.element.trigger('mui.blobshow.created');},_insertDefaultImage:function(){if(this.defaultImage===undefined){this.defaultImage=$('<div>',{'class':this.options.bgImageClass+' _default','style':'background-image: url('+this.options.fallbackBg+')'});this.defaultImage.prependTo(this.images);}},_insertImage:function(url,index,active){var image=$('<div>',{'class':this.options.bgImageClass+((active)?' '+this.options.activeClass:''),'style':'background-image: url('+url+')','data-blob-rel':index}).appendTo(this.images);},_initBlobs:function(){var that=this;this.drawImages=(this.options.altBg===true&&!!this.options.bgContainer.trim());if(this.drawImages){this.images=this.element.parents(this.options.parent).find(this.options.bgContainer);this.images.empty();}
    this._matchHeight();for(var i=0;i<this.blobs.length;i++){var active=(i===0),blob=$(this.blobs.get(i)),bg=blob.data('bg');if(active){this.activeBlobIndex=blob.index();}
        if(this.drawImages){if(bg!==undefined&&bg!==''){bg=bg.trim();blob.data('blob-bg',bg).attr('data-blob-rel',blob.index());this._insertImage(bg,blob.index(),active);}else{this._insertDefaultImage();if(active){this.defaultImage.addClass(this.options.activeClass);}}}
        blob.removeAttr('data-bg');blob.toggleClass(this.options.activeClass,active);}},_autoPlay:function(){var that=this;this.autoPlayTimer=setInterval(function(){that._nextBlob(false);},this.options.delay*1000);if(this.options.ignoreMouse===null||this.options.ignoreMouse===false){this.blobContainer.on('mouseenter',function(event){that.pause();}).on('mouseleave',function(event){that.play();});}},_nextBlob:function(reverse){var that=this;this.activeBlob=$(this.blobs.get(this.activeBlobIndex));this.nextBlob=(reverse)?(this.activeBlob.prev().length===0)?this.activeBlob.nextAll().last():this.activeBlob.prev():(this.activeBlob.next().length===0)?this.activeBlob.prevAll().last():this.activeBlob.next();this.activeBlobIndex=this.nextBlob.index();this.nextBlob.addClass(this.options.activeClass).siblings().removeClass(this.options.activeClass);if(this.options.showNavigationDots===true){$(this.navDots.find('.mui-blobshow-dot').get(this.activeBlobIndex)).addClass(this.options.activeClass).siblings().removeClass(this.options.activeClass);}
    this._transitionBlobs();if(this.drawImages){this.activeImage=this.images.find('.'+this.options.bgImageClass+'.'+this.options.activeClass);this.nextImage=this.images.find('.'+this.options.bgImageClass+'[data-blob-rel="'+this.nextBlob.data('blob-rel')+'"]');this.nextImage=(this.nextImage.length===0)?this.defaultImage:this.nextImage;this.nextImage.addClass(this.options.activeClass).siblings().removeClass(this.options.activeClass);if(this.nextImage.is(this.defaultImage)){this.transitioning=false;if(!this.activeImage.is(this.defaultImage)){this._transitionImages();}}else{this._transitionImages();}}},_transitionImages:function(){var that=this;this.timelineImages=new TimelineLite({delay:0,onStart:function(){that.transitioning=true;},onComplete:function(){that.transitioning=false;that.timelineImages.kill();}});this.timelineImages.add(TweenLite.fromTo(this.activeImage,1.0,{autoAlpha:1},{autoAlpha:0,ease:Linear.ease}),'-='+1.0).add(TweenLite.fromTo(this.nextImage,1.0,{autoAlpha:0},{autoAlpha:1,ease:Linear.ease}),'-='+1.0);},_transitionBlobs:function(){var that=this;this.timelineBlobs=new TimelineLite({delay:0,onStart:function(){that.transitioning=true;},onComplete:function(){that.transitioning=false;that.timelineBlobs.kill();}});this.timelineBlobs.add(TweenLite.fromTo(this.activeBlob,0.8,{autoAlpha:1},{autoAlpha:0,ease:Ease.ease}),'-='+0.8).add(TweenLite.fromTo(this.nextBlob,0.8,{autoAlpha:0},{autoAlpha:1,ease:Ease.ease}),'-='+0.8);},_drawNavigation:function(){if(this.options.showNavigation===true){if(this.options.showNavigationDots===false&&this.options.showNavigationArrows===false){this.options.showNavigation=false;}else{this.options.showNavigationDots=(this.options.showNavigationDots===null)?true:this.options.showNavigationDots;this.options.showNavigationArrows=(this.options.showNavigationArrows===null)?true:this.options.showNavigationArrows;if(this.options.showNavigationDots===true||this.options.showNavigationArrows===true){if(this.blobs.length<=1){return;}
    var that=this;this.navigation=$('<div>',{'class':'mui-blobshow-nav'});if(this.options.showNavigationArrows===true){this.navArrows=$('<div>',{'class':'mui-blobshow-arrows'});this.navArrowPrev=$('<span>',{'class':'mui-blobshow-arrow _prev'}).on('click',function(event){if(!that.transitioning){that._nextBlob(true);}}).appendTo(this.navArrows);this.navArrowNext=$('<span>',{'class':'mui-blobshow-arrow _next'}).on('click',function(event){if(!that.transitioning){that._nextBlob(false);}}).appendTo(this.navArrows);this.navArrows.appendTo(this.navigation);}
    if(this.options.showNavigationDots===true){this.navDots=$('<div>',{'class':'mui-blobshow-dots'});for(var i=0;i<this.blobs.length;i++){$('<span>',{'class':'mui-blobshow-dot'+((i===0)?' '+this.options.activeClass:'')}).appendTo(this.navDots);}
        this.navDots.appendTo(this.navigation);}
    this.navigation.appendTo(this.element);}}}},_initSwipe:function(){var that=this;if(this.options.allowSwipe===true&&this.blobs.length>1){if(this.options.swipeContainer===null){this.options.swipeContainer=this.options.parent;}
    this.element.parents(this.options.swipeContainer).swipe({allowPageScroll:'vertical',swipe:function(event,direction){if(!that.transitioning){if(direction==='left'){that._nextBlob(true);}else if(direction==='right'){that._nextBlob(false);}}}});}},_matchHeight:function(){if(this.options.matchHeight===true){this.blobs.add(this.blobContainer).matchHeight();}},_imageExists:function(url){var img=new Image();img.onerror=function(){return false;};img.onload=function(){return true;};img.src=url;},play:function(){if(this.options.autoPlayOnly===true&&this.blobs.length>1&&this.autoPlayTimer===false){this._autoPlay();}},pause:function(){if(this.options.autoPlayOnly===true&&this.blobs.length>1&&this.autoPlayTimer!==false){clearInterval(this.autoPlayTimer);this.autoPlayTimer=false;}}});}));jQuery(document).ready(function($){function initBlobs(){var blobShows=$('.mui-blobshow'),_parseJSON=function(string)
{if(string instanceof Object){return string;}
    try{return JSON.parse(string.replace(/'/g,"\""));}catch(e){return false;}};blobShows.each(function(index){var blobShow=$(this),blobShowConfig=blobShow.find('.mui-blobshow-config').first();if(blobShowConfig.hasClass('mui-blobshow-config')){var blobShowOptions=_parseJSON(blobShowConfig.data('options')),blobShowPlay=(blobShowConfig.data('blobshow-play')!==undefined&&blobShowConfig.data('blobshow-play')===true);blobShowConfig.remove();blobShow.blobshow(blobShowOptions);if(blobShowOptions.autoPlayOnly){if(blobShowPlay){blobShow.blobshow('play');}}}});}
    initBlobs();});(function(factory){factory(jQuery);}(function($){return $.widget('mui.selectbox',{version:'0.1',className:'ui-selectbox',defaultElement:'<select>',validLabel:null,options:{disabled:null,inline:false,inlineLabel:null,modifier:null,extraMenuClass:null,appendValClass:true,change:null,close:null,focus:null,open:null,select:null},_create:function(){var that=this;if(this.element.parent().hasClass(this.className)){this.wrap=this.element.parent();}else{this.wrap=$('<div>',{'class':this.className}).insertBefore(this.element);}
    this.element.appendTo(this.wrap);this.element.selectmenu({disabled:this.options.disabled,icons:{button:''},change:function(event,ui){that._trigger('change',event,ui);},focus:function(event,ui){that._trigger('focus',event,ui);},select:function(event,ui){that._trigger('select',event,ui);that._wrapClasses();that.validated(true);},open:function(event){that.wrap.addClass('ui-state-open');that._trigger('open',event);},close:function(event){that.wrap.removeClass('ui-state-open');that._trigger('close',event);}});this.selectWidget=this.element.selectmenu('widget');this.menuWrapWidget=this.element.selectmenu('menuWrapWidget');if(this.options.extraMenuClass!==undefined&&typeof this.options.extraMenuClass=='string'){this.menuWrapWidget.addClass(this.options.extraMenuClass);}
    if(this.options.modifier!==undefined&&typeof this.options.modifier=='function'){this._trigger('modifier',null,this.selectWidget);}
    this._wrapClasses();if(this.options.inline){this.selectWidget.wrapInner('<span class="ui-selectmenu-label"></span>');this.menuWrapWidget.addClass('ui-state-inline');if(this.options.inlineLabel!==undefined&&this.options.inlineLabel.trim()!==''){$('<span>',{'class':'ui-selectmenu-pre'}).append(this.options.inlineLabel).prependTo(this.selectWidget.children('.ui-selectmenu-label').prepend(' '));}}
    this._hoverable(this.wrap);if(this.options.disabled){this.wrap.addClass('ui-state-disabled');}
    this._drawInvalidLabel();},_wrapClasses:function(){this.wrap.attr('class','');this.wrap.addClass(this.className);if(this.options.inline){this.wrap.addClass('ui-state-inline');}
    if(this.options.appendValClass&&this.element.val()!==null&&this.element.val().trim()!==''){this.wrap.addClass('ui-selectbox-val-'+this.element.val());}},_drawInvalidLabel:function(){this.validLabel=$('<div>',{'class':'ui-invalid-text','text':this.options.invalidText});this.validLabel.prependTo(this.wrap);},selectWidget:function(){return this.selectWidget;},_setOption:function(key,value){if(key==='disabled'){this.element.selectmenu('option','disabled',value);this.wrap.toggleClass('ui-state-disabled',value);}
    this._super(key,value);},widgetWrap:function(){return this.wrap;},menuWrapWidget:function(){return this.menuWrapWidget;},refresh:function(){this.element.selectmenu('refresh');},setValue:function(value){this.element.val(value);this.element.selectmenu('refresh');this._wrapClasses();},getMenuWidget:function()
{return this.element.selectmenu('menuWidget');},_getCreateOptions:function(){return{disabled:this.element.prop('disabled')};},validated:function(isValid,msg){if(msg){this.validLabel.html(msg);}
    this.wrap.toggleClass('ui-state-invalid',!isValid);}});}));(function(factory)
{factory(jQuery);}(function($)
{return $.widget('mui.calendar',{version:'0.1',defaultElement:'<input>',options:{clearable:false,defaultDate:null,disabled:false,invalidText:null,maxDate:null,minDate:null,showShortMonth:true,showWeek:false,showYear:true,date:new Date(),closeText:"Done",currentText:"Today",dateFormat:"mm/dd/yy",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],firstDay:0,isRTL:false,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],nextText:"Next",prevText:"Prev",showMonthAfterYear:false,weekHeader:"Wk",yearSuffix:"",change:null,clear:null,close:null,focus:null,open:null,select:null,onBeforeShowDay:null},_create:function()
{var that=this;if(this.element.parent().hasClass('ui-calendar'))
{this.wrap=this.element.parent();}else
{this.wrap=$('<div>',{'class':'ui-calendar'}).insertBefore(this.element);}
    this.label=$('<span>',{'class':'label'}).appendTo(this.wrap);this.element.appendTo(this.wrap);var _getHighlightDates=this.options.getHighlightDates;var _highlightedDates={};var _onBeforeShow=function()
{if(_getHighlightDates)
    _highlightedDates=_getHighlightDates();}
    this.element.datepicker({showAnim:false,disabled:this.options.disabled,showWeek:this.options.showWeek,showOtherMonths:true,selectOtherMonths:true,numberOfMonths:1,minDate:this.options.minDate,maxDate:this.options.maxDate,closeText:this.options.closeText,prevText:this.options.prevText,nextText:this.options.nextText,currentText:this.options.currentText,monthNames:this.options.monthNames,monthNamesShort:this.options.monthNamesShort,dayNames:this.options.dayNames,dayNamesShort:this.options.dayNamesShort,dayNamesMin:this.options.dayNamesMin,weekHeader:this.options.weekHeader,dateFormat:this.options.dateFormat,firstDay:this.options.firstDay,isRTL:this.options.isRTL,showMonthAfterYear:this.options.showMonthAfterYear,yearSuffix:this.options.yearSuffix,beforeShowDay:!!_getHighlightDates?function(date)
    {var result=_highlightedDates[+date];if(typeof result!=='undefined')
        return[true,result['class']||'ui-datepicker-date-highlight',result.text||''];else
        return[true,'',''];}:null,beforeShow:function(input,inst)
    {that.wrap.addClass('ui-state-focus');that._trigger('open',input,inst);inst.dpDiv.addClass('ui-front');_onBeforeShow();},onClose:function(input,inst)
    {that.wrap.removeClass('ui-state-focus');that._trigger('close',input,inst);},onSelect:function(input,inst)
    {setTimeout(function()
    {var d=that.element.datepicker('getDate');that._setDate(d);that.wrap.removeClass('ui-state-nodate');that._trigger('select',input,inst);that.validated(true);},0);}}).on('focus',function(e)
    {e.preventDefault();});this._setDate(this.options.date);if(this.options.clearable)
{this._drawClearButton();}
    this._hoverable(this.wrap);this._drawInvalidLabel();},_drawInvalidLabel:function()
{this.validLabel=$('<div>',{'class':'ui-invalid-text','text':this.options.invalidText});this.validLabel.prependTo(this.wrap);},getDate:function()
{return this.element.datepicker('getDate');},setDate:function(date,updateLabel)
{updateLabel=typeof updateLabel==='undefined'?true:updateLabel;this._setDate(date,updateLabel);},_setDate:function(date,updateLabel)
{var day=date.getDate();var month=this.options[this.options.showShortMonth?'monthNamesShort':'monthNames'][date.getMonth()];var year=date.getFullYear();var fullDate="";if(MomondoInfo.CultureInfo.CurrentCulture.Code=="zh-CN"||MomondoInfo.CultureInfo.CurrentCulture.Code=='zh-HK')
    fullDate=((this.options.showYear)?'<span class="year">'+year+'</span> ':'')+'<span class="month">'+month+'</span> <span class="day">'+day+'</span>';else
    fullDate='<span class="day">'+day+'</span> <span class="month">'+month+'</span>'+((this.options.showYear)?' <span class="year">'+year+'</span>':'');if(!(updateLabel===false))
    this.label.html(fullDate);this.element.datepicker('setDate',date);},setCleared:function(cleared,date)
{if(cleared)
{this.label.html('—');this.wrap.addClass('ui-state-nodate');}else
{this.element.datepicker('setDate',(date||new Date()));this.wrap.removeClass('ui-state-nodate');}},open:function()
{this.element.datepicker('show');},_drawClearButton:function()
{var that=this;this.wrap.addClass('ui-calendar-hasbutton');this.clearbutton=$('<span>',{'class':'ui-calendar-button','tabindex':'-1'}).appendTo(this.wrap).button({disabled:this.options.disabled}).empty().on('click',function(event)
{event.preventDefault();that.setCleared(true);that._trigger('clear',event);})
    this._hoverable(this.clearbutton);},validated:function(isValid,msg)
{if(msg)
{this.validLabel.html(msg);}
    this.wrap.toggleClass('ui-state-invalid',!isValid);},getWidget:function()
{return this.element.datepicker('widget');}});}));(function(factory)
{factory(jQuery);}(function($)
{return $.widget('mui.paxselect',{version:'0.1',defaultElement:'<div>',options:{appendTo:null,disabled:false,width:300,labels:{closeBtn:'Close',adults:'Adults',adultsStrings:{0:'{i} adults',1:'{i} adult',2:'{i} adults'},children:'Children',childrenAge:'Child age {i}',childrenStrings:{0:'{i} children',1:'{i} child',2:'{i} children'},passengers:{0:'{i} passengers',1:'{i} passenger',2:'{i} passengers'}},formatters:{formatAgeOfChild:null,formatPassengers:null},adults:1,minAdults:1,maxAdults:9,children:0,minChildren:0,maxChildren:7,minChildAge:0,maxChildAge:17,defaultChildAge:8,childrenAges:null,showAdults:true,showChildren:true,showClose:true,position:{my:'left top',at:'left bottom',collision:'none'},change:null,close:null,open:null,changeAdults:null,changeChildren:null,changeAge:null,select:null},_formatAgeOfChild:function(age){var that=this;return this.options.labels.childrenAge.replace('{i}',age);},_formatPassengers:function(count){var that=this;count=Math.min(2,parseInt(count,10));return this.options.labels.passengers[count].replace('{i}',count);},_create:function()
{var paxselectId=this.element.uniqueId().attr('id');this._validateOptions();this.formatters=this.options.formatters;this.ids={element:paxselectId,selectbox:paxselectId+'-selectbox',dropdown:paxselectId+'-paxselect-menu'};this.adultsOnly=(this.options.showAdults&&!this.options.showChildren)?true:false;if(this.adultsOnly)
{this._drawSelectmenu();}
else
{if(this.options.disabled)
{this.disable();}
    this._drawButton();this._drawDropdownMenu();this._updateButtonLabel();}},_drawButton:function()
{var tabindex=this.element.attr('tabindex');this.element.html('').addClass('ui-paxselect-button').toggleClass('ui-state-disabled',this.options.disabled).attr('tabindex',tabindex||this.options.disabled?-1:0);$('<span>',{'class':'ui-paxselect-label'}).appendTo(this.element);this.buttonLabel=this.element.find('.ui-paxselect-label');this._on(true,this.element,this._buttonEvents);this._hoverable(this.element);this._focusable(this.element);},_drawDropdownMenu:function()
{this.dropdown=$('<div>',{'class':'ui-paxselect-menu ui-front','id':this.ids.dropdown});this.menu=$('<div>',{'class':'ui-paxselect-menu-items'}).width(this.options.width);this.menu.appendTo(this.dropdown);this.dropdown.appendTo(this._appendTo());this._renderAdultsChilds();this._drawCloseButton();},_drawCloseButton:function()
{var that=this;if(this.options.showClose)
{this.footer=$('<div>',{'class':'ui-paxselect-menu-close'});$('<span>').html(this.options.labels.closeBtn).on('click',function(event)
{that.close(event);event.preventDefault();}).appendTo(this.footer);this.footer.appendTo(this.menu);}},_drawSelectmenu:function()
{var that=this,adults=this.options.adults;this.selectboxWrap=$('<div>',{'class':'mui-selectmenu'});this.selectbox=$('<select>',{'id':this.ids.selectbox}).appendTo(this.selectboxWrap);for(var i=this.options.minAdults;i<=this.options.maxAdults;i++)
{var option=$('<option>',{'value':i,text:this._getPassengerString(this.options.labels.adultsStrings,i).replace('{i}',i)});if(i==this.options.adults)
{option.attr('selected','selected');}
    option.appendTo(this.selectbox);}
    this.selectboxWrap.appendTo(this.element);this.selectboxWrap.find('select').selectmenu({disabled:this.options.disabled,icons:{button:''},open:function(event)
{that.selectboxWrap.addClass('_open');that._trigger('open',event);},close:function(event)
{that.selectboxWrap.removeClass('_open');that._trigger('close',event);},select:function(event,item)
{that._trigger('select',event,item);}}).val(adults);},open:function(event)
{if(this.options.disabled)
{return;}
    if(!this.adultsOnly)
    {this.isOpen=true;this._toggleAttr();this._position();this._on(this.document,this._documentClick);this._on(this.window,{resize:function(event)
    {if(this.isOpen)
    {this._position();}}});}
    this._trigger('open',event);},close:function(event)
{if(!this.adultsOnly)
{if(!this.isOpen)
{return;}
    this.isOpen=false;this._toggleAttr();this._off(this.document);}
    this._trigger('close',event);},changeAdults:function(event)
{this._trigger('changeAdults',event);this._trigger('paxChanged');},changeChildren:function(event)
{this._trigger('changeChildren',event);this._trigger('paxChanged');},changeAge:function(event)
{this._trigger('changeAge',event);this._trigger('paxChanged');},childrenAges:function()
{return this.options.childrenAges;},childrenAgesSelected:function()
{var children=this.options.children,obj={};if(jQuery.isEmptyObject(children))
{return false;}
    for(var i=1;i<=children;i++)
    {obj[i]=this.options.childrenAges[i];}
    return obj;},getData:function(){return{adults:this.options.adults,childrenAges:this.options.childrenAges};},_toggleAttr:function()
{this.element.toggleClass('ui-state-active',this.isOpen);this.dropdown.toggleClass('ui-paxselect-open',this.isOpen);},_position:function()
{this.dropdown.position($.extend({of:this.element},this.options.position));},_appendTo:function()
{var element=this.options.appendTo;if(element)
{element=element.jquery||element.nodeType?$(element):this.document.find(element).eq(0);}
    if(!element||!element[0])
    {element=this.element.closest('.ui-front');}
    if(!element.length)
    {element=this.document[0].body;}
    return element;},_renderAdultsChilds:function()
{var that=this;if(this.options.showAdults)
{this.adultsSpinner=this._renderItem(this.ids.element+'-adults-total',this.options.labels.adults,this.options.adults).appendTo(this.menu);var adultsSpinnerInput=this.menu.find('#'+this.ids.element+'-adults-total').spinner({min:this.options.minAdults,max:this.options.maxAdults,numberFormat:'n',icons:{down:'',up:''},spin:function(event,ui)
{that.options.adults=ui.value;that._updateButtonLabel();that._position();},stop:function(event,ui)
{that._updateChildrenAges();that.changeAdults(event);}}).val(this.options.adults);if(this.options.adults<this.options.minAdults)this.options.adults=this.options.minAdults;adultsSpinnerInput.val(this.options.adults);}
    if(this.options.showChildren)
    {this.childsSpinner=this._renderItem(this.ids.element+'-childs-total',this.options.labels.children,this.options.children).appendTo(this.menu);var childsSpinnerInput=this.menu.find('#'+this.ids.element+'-childs-total').spinner({min:this.options.minChildren,max:this.options.maxChildren,numberFormat:'n',icons:{down:'',up:''},spin:function(event,ui)
    {that.options.children=ui.value;that._updateButtonLabel();that._refreshChildAges();that._position();},stop:function(event,ui)
    {that._updateChildrenAges();that.changeChildren(event);}});if(this.options.children<this.options.minChildren)this.options.children=this.options.minChildren;childsSpinnerInput.val(this.options.children);this._renderChildAges();}},_renderChildAges:function()
{var that=this;this.wrapKidsAge=$('<div>',{'class':'ui-paxselect-children-ages'}).toggleClass('_active',this.options.children>0);for(var i=0;i<this.options.maxChildren;i++)
{var id=this.ids.element+'-childage'+(i+1),label=(this.options.formatters.formatAgeOfChild!==null)?this.options.formatters.formatAgeOfChild(i+1):this._formatAgeOfChild(i+1),value=0,itm=this._renderItem(id,label,value).toggleClass('_active',i+1<=this.options.children);itm.appendTo(this.wrapKidsAge);}
    this.wrapKidsAge.appendTo(this.menu);this.wrapKidsAge.find('.ui-spinner-ext').each(function(index,item)
{var spinner=$(item),input=spinner.find('input'),val=that.options.defaultChildAge;if(that.options.childrenAges!==null&&!isNaN(that.options.childrenAges[index+1]))
{var age=that.options.childrenAges[index+1];if(age<that.options.minChildAge||age>that.options.maxChildAge)
{val=that.options.minChildAge;}else
{val=age;}}
    input.spinner({min:that.options.minChildAge,max:that.options.maxChildAge,numberFormat:'n',icons:{down:'',up:''},spin:function(event,ui)
    {},stop:function(event,ui)
    {that._updateChildrenAges();that.changeAge(event);}}).val(val);});},_renderItem:function(id,label,value)
{var itmWrap=$('<div>',{'class':'ui-spinner-ext'}),itmLabel=$('<span>',{'class':'label'}).text(label),itmSpinner=$('<div>',{'class':'ui-spinner-ext-value'}),itmSpinnerContainer=$('<div>',{'class':'container'}).appendTo(itmSpinner),itmSpinnerInput=$('<input>',{'id':id,'name':'value','readonly':'readonly'}).appendTo(itmSpinnerContainer);itmLabel.appendTo(itmWrap);itmSpinner.appendTo(itmWrap);return itmWrap;},_updateButtonLabel:function()
{var paxCount=this.totalPassengers=this._countPassengers();this.buttonLabel.html((this.options.formatters.formatPassengers!==null)?this.options.formatters.formatPassengers(paxCount):this._formatPassengers(paxCount));},_updateChildrenAges:function()
{var that=this;var childrenAges=function()
{var obj={};if(that.options.children===0)
{return null;}
    for(var i=1;i<=that.options.children;i++)
    {obj[i]=that.wrapKidsAge.find('.ui-spinner-ext:nth-child('+i+') input').val();}
    return obj;};this.options.childrenAges=childrenAges();},_refreshChildAges:function()
{var that=this;this.wrapKidsAge.toggleClass('_active',that.options.children!==0);this.wrapKidsAge.find('.ui-spinner-ext').each(function(index,item)
{$(item).toggleClass('_active',index+1<=that.options.children);});},_countPassengers:function()
{return this.options.children+(this.options.showAdults?this.options.adults:0);},_validateOptions:function()
{if(this.options.adults<this.options.minAdults||this.options.adults>this.options.maxAdults)
{this.options.adults=this.options.minAdults;}
    if(this.options.children<this.options.minChildren||this.options.children>this.options.maxChildren)
    {this.options.children=this.options.minChildren;}},_toggle:function(event)
{this[this.isOpen?'close':'open'](event);},_documentClick:{mousedown:function(event)
{if(!this.isOpen)
{return;}
    if(!$(event.target).closest('.ui-paxselect-menu, #'+this.ids.element).length)
    {this.close(event);}}},_buttonEvents:{click:'_toggle',keydown:function(event)
{var preventDefault=true;switch(event.keyCode)
{case $.ui.keyCode.TAB:case $.ui.keyCode.ESCAPE:this.close(event);preventDefault=false;break;case $.ui.keyCode.SPACE:this._toggle(event);break;default:preventDefault=false;}
    if(preventDefault)
    {event.preventDefault();}}},_getPassengerString:function(obj,val)
{var getClosestValues=function(a,x)
{var lo=-1,hi=a.length;while(hi-lo>1)
{var mid=Math.round((lo+hi)/2);if(a[mid]<=x)
{lo=mid;}else
{hi=mid;}}
    if(a[lo]==x)hi=lo;return[a[lo],a[hi]];};var keys=Object.keys(obj);keys.sort(function(a,b){return a-b;});return obj[getClosestValues(keys,val)[0]]},getMenu:function(){return this.menu;}});}));(function(factory)
{jQuery.ui.autocomplete.prototype._renderItem=function(ul,item)
{var term=this.term.split(' ').join('|'),re=new RegExp('('+term+')','gi'),hl='<span class="highlight">$1</span>',label=$('<div>',{'class':'label'}),labelName=$('<div>',{'class':'name'}),icon=$('<div>',{'class':'icon','aria-hidde':'true'}),t=item.label.replace(re,hl);return $('<li>',{'class':'ui-geolocate-item'}).data('ui-autocomplete-item',item).append(label.append(labelName.append(t))).appendTo(ul);};factory(jQuery);}(function($)
{return $.widget('mui.geolocate',{version:'0.1',validLabel:null,defaultElement:'<input>',options:{appendTo:null,disabled:false,placeholder:null,type:null,source:null,autoFocus:false,delay:300,minLength:2,change:null,close:null,focus:null,open:null,response:null,search:null,select:null,blur:null,renderItem:null,renderMenu:null,showGeoButton:true,clickGeoButton:null,openDropdown:null,closeDropdown:null,selectDropdown:null},_create:function()
{var that=this;var geolocateId=this.element.uniqueId().attr('id');this.dataService=this.options.dataService;this.fakeGeoData={};this.ids={autocomplete:geolocateId+'-autocomplete',dropdown:geolocateId+'-geolocate-dropdown'}
    this.inFocus=false;this.isDropdownOpen=false;this.geoButtonIsDown=false;if(this.element.parent().hasClass('ui-geolocate'))
{this.wrap=this.element.parent();}else
{this.wrap=$('<div>',{'class':'ui-geolocate'}).insertBefore(this.element);}
    this.element.appendTo(this.wrap);if(this.options.showGeoButton)
{this._drawGeoButton();this._drawDropdown();}
    this._drawAutocomplete();this._drawInvalidLabel();},_drawInvalidLabel:function(){this.validLabel=$('<div>',{'class':'ui-invalid-text','text':this.options.invalidText});this.validLabel.prependTo(this.wrap);},_drawDropdown:function()
{this.dropdown=$('<div>',{'class':'ui-geolocate-dropdown ui-front','id':this.ids.dropdown}).hide();this._drawDropdownReturn();this._drawGeoMenu();this.dropdown.appendTo(this._appendTo());},_drawGeoMenu:function()
{return;var that=this;this.dropdownMenu=$('<ul>',{'class':'ui-geolocate-dropdown-menu'})
    this._renderGeoMenu(this.fakeGeoData);this.dropdownMenuInstance=this.dropdownMenu.menu({role:'listbox',select:function(event,ui)
{event.preventDefault();var geoData=ui.item.data('geodata');that._renderGeoMenu(that.fakeGeoData);that.dropdownMenu.menu('refresh').menu('focus',null,that.dropdownMenu.find('.ui-menu-item:first'));that._position(that.dropdown);that._trigger('selectDropdown',event,ui);}});this.dropdownMenuInstance._closeOnDocumentClick=function()
{return false;};this.dropdownMenuInstance._isDivider=function()
{return false;};this.dropdownMenu.appendTo(this.dropdown)},setDirty:function()
{if(this.element.val()==='')
    this.cleanse();else
    this.dirty=true;},cleanse:function()
{this.dirty=false;},_drawAutocomplete:function()
{var that=this;var element=this.element.attr('autocomplete','off').attr('autocorrect','off').attr('autocapitalize','off')
    var source=function(options,response)
    {var term=options.term;that.lookupHandle=that.dataService.LookupCities(term,10,function(result)
    {delete that.lookupHandle;response(result);if(that.autoSelect)
    {that.autoSelect=false;that._onBlur();that.element.autocomplete('close');}
        that.cleanse();},function()
    {delete that.lookupHandle;that.cleanse();},that);};this.element.autocomplete({source:source,autoFocus:true,minLength:this.options.minLength,change:function(event,ui)
{that._trigger('change',event,ui);},response:function(event,ui)
{that._trigger('response',event,ui);},search:function(event,ui)
{that._trigger('search',event,ui);},select:function(event,ui)
{that._trigger('select',event,ui);that.validated(true);},open:function(event,ui)
{that.wrap.addClass('ui-state-focus').addClass('ui-state-open');that._trigger('open',event,ui);},focus:function(event,ui)
{that.wrap.addClass('ui-state-focus');that._trigger('focus',event,ui);},close:function(event,ui)
{that.wrap.removeClass('ui-state-open');that._trigger('close',event,ui);}}).on('focus',function(event)
{element.select();that.inFocus=true;that._toggleAttr();}).on('blur',function(event)
{if(that.dirty)
{if(that.lookupHandle)
    that.lookupHandle.abort();that.autoSelect=true;var query=that.element.val();that.element.autocomplete('search',query);}
else
{that._onBlur(event);}}).on('keyup',function(event)
{var keyCode=event.keyCode;var keyCodes=$.ui.keyCode;switch(keyCode)
{case keyCodes.DOWN:case keyCodes.END:case keyCodes.ESCAPE:case keyCodes.HOME:case keyCodes.LEFT:case keyCodes.PAGE_DOWN:case keyCodes.PAGE_UP:case keyCodes.RIGHT:case keyCodes.TAB:case keyCodes.UP:case 16:break;default:that.setDirty();break;}}).autocomplete('widget').addClass('ui-geolocate-autocomplete');this.element.autocomplete('widget').addClass('ui-geolocate-autocomplete-'+this.options.type);this.element.data('ui-autocomplete')._renderItem=this.options.renderItem;if(this.options.renderMenu)
    this.element.data('ui-autocomplete')._renderMenu=this.options.renderMenu;this.element.data('ui-autocomplete')._suggest=this.AutoSelectFirstItemHack;},_onBlur:function(event)
{if(!this.geoButtonIsDown)
{this.inFocus=false;}
    this._toggleAttr();this._trigger('blur',event);this.validated(true);},AutoSelectFirstItemHack:function(items)
{var ul=this.menu.element.empty();this._renderMenu(ul,items);this.isNewMenu=true;this.menu.refresh();ul.show();this._resizeMenu();ul.position($.extend({of:this.element},this.options.position));if(this.options.autoFocus)
{for(i=0,S=null;S=items[i];i++)
{if(S.group)
{this.menu.next();}else
{this.menu.next();break;}}}},_renderGeoMenu:function(data)
{this.dropdownMenu.empty();for(var i=0;i<data['d'].length;i++)
{var itemData=data['d'][i];var item=this._renderGeoMenuItem(itemData);item.appendTo(this.dropdownMenu);};},_renderGeoMenuItem:function(itemData)
{var item=$('<li>',{'class':'geotype-'+itemData['Type']}).data('geodata',itemData)
    split=itemData['Text'].split(','),city=split[0],country=split[1],itmLabel=$('<div>',{'class':'label'}).html(city).appendTo(item);return item;},_drawGeoButton:function()
{var that=this;this.wrap.addClass('ui-geolocate-hasbutton');this.geobutton=$('<span>',{'class':'ui-geolocate-button','tabindex':'-1'}).appendTo(this.wrap).button({disabled:this.options.disabled}).html('').on('click',function(event)
{event.preventDefault();that._trigger('clickGeoButton',event);})
    this._on(this.geobutton,this._buttonEvents);this._hoverable(this.wrap);this._hoverable(this.geobutton);},_drawDropdownReturn:function()
{this.returnBtn=$('<div>',{'class':'ui-geolocate-dropdown-nav'});this.returnBtnLabel=$('<span>',{'class':'label'}).appendTo(this.returnBtn);this.returnBtn.prependTo(this.dropdown);},openDropdown:function(event)
{return;if(this.options.disabled)
{return;}
    this.inFocus=true;this.isDropdownOpen=true;this._toggleAttr();this.dropdown.show().css({'width':this.wrap.outerWidth()+'px'})
    this._position(this.dropdown);this.dropdownMenu.focus();this._on(this.document,this._documentEvents);this._trigger('openDropdown',event);},closeDropdown:function(event)
{this.isDropdownOpen=false;this._toggleAttr();this._off(this.document);this._trigger('closeDropdown',event);},_toggleDropdown:function(event)
{this[this.isDropdownOpen?'closeDropdown':'openDropdown'](event);},_toggleAttr:function()
{this.wrap.toggleClass('ui-state-focus',(this.geoButtonIsDown)?true:this.inFocus);if(this.options.showGeoButton)
{this.wrap.toggleClass('ui-state-open',this.isDropdownOpen);this.dropdown.toggleClass('ui-state-open',this.isDropdownOpen);}},_position:function(what)
{what.position($.extend({of:this.wrap},this.options.position));},_appendTo:function()
{var element=this.options.appendTo;if(element)
{element=element.jquery||element.nodeType?$(element):this.document.find(element).eq(0);}
    if(!element||!element[0])
    {element=this.element.closest('.ui-front');}
    if(!element.length)
    {element=this.document[0].body;}
    return element;},_documentEvents:{mousedown:function(event)
{if(!this.isDropdownOpen)
{return;}
    if(!$(event.target).closest('.ui-geolocate-dropdown, #'+this.ids.dropdown).length)
    {this.inFocus=false;this.closeDropdown(event);}},keydown:function(event)
{if(!this.isDropdownOpen)
{return;}
    var preventDefault=true;switch(event.keyCode)
{case $.ui.keyCode.TAB:this.inFocus=false;this.closeDropdown(event);preventDefault=false;break;case $.ui.keyCode.ESCAPE:this.closeDropdown(event);preventDefault=false;break;default:preventDefault=false;}
    if(preventDefault)
    {event.preventDefault();}}},_buttonEvents:{click:'_toggleDropdown',mousedown:function(event)
{this.geoButtonIsDown=true;this._toggleAttr();},mouseup:function(event)
{this.geoButtonIsDown=false;}},validated:function(isValid,msg){if(msg){this.validLabel.html(msg);}
    this.wrap.toggleClass('ui-state-invalid',!isValid);},pending:function()
{return!!this.lookupHandle;},getMenu:function()
{return this.element.autocomplete('widget');}});}));var MMControls;(function(MMControls){var ModalControl=(function(){function ModalControl(){}
    ModalControl.prototype.CreateModalConfirmationPopup=function(title,content,showCancel,onConfirm,onCancel){if(typeof showCancel==="undefined"){showCancel=true;}
        var lang=Language;var cancel=(showCancel)?(lang['General.Cancel']||"Cancel"):"";var ok=(lang['General.OK']||"OK");var popupHtml=String.format('<div class="mui-popup _modal mui-popup-hotelguests">'+'   <div class="container">'+'       <div class="title">'+'           <h2>{0}</h2>'+'       </div>'+'       <div class="content">'+'           <div class="ui-guestlist">{1}</div>'+'       </div>'+'       <div class="confirms">'+'           <div class="confirm _cancel">'+'               <span class="label">{2}</span>'+'           </div>'+'           <div class="confirm _ok">'+'               <span class="label">{3}</span>'+'           </div>'+'       </div>'+'   </div>'+'</div>',title,content,cancel,ok);var popup=jQuery(popupHtml);var magnificPopup=jQuery.magnificPopup;var confirms=popup.find('.confirms');var confirmCancel=confirms.children('._cancel');var confirmOk=confirms.children('._ok');var closePopup=function(){magnificPopup.close();};confirmCancel.click(function(){if(onCancel)
            onCancel();closePopup();});confirmOk.click(function(){if(onConfirm)
            onConfirm();closePopup();});magnificPopup.open({items:{src:popup,type:'inline'},modal:true,showCloseBtn:false,alignTop:true});return popup;};return ModalControl;})();MMControls.ModalControl=ModalControl;})(MMControls||(MMControls={}));jQuery(document).ready(function($)
{$('body').on('click','[data-prevent-default]:not([data-trigger])',function(originalEvent)
{var preventDefault=$(this).data('prevent-default');if(preventDefault===undefined||preventDefault==true)
{originalEvent.preventDefault();}});});jQuery(document).ready(function($)
{$('body').on('click','[data-trace]',function(originalEvent)
{var $this=$(this);var eventName='Trace.'+$this.data('trace');var args=$this.data('trace-args');$(this).trigger(eventName,args);if(eventName==="Trace.FrontImageBanner-CarDestPromo-Clicked"){Tracking.trackEvent("MomonodoBlobPromos","CarDestPromoClick","Destination: "+args.dest,"");}
    if(eventName==="Trace.FrontImageBanner-FlightDestPromo-Clicked"){Tracking.trackEvent("MomonodoBlobPromos","FlightDestPromoClick","Destination: "+args.dest,"");}
    if(eventName==="Trace.FrontImageBanner-HotelDestPromo-Clicked"){Tracking.trackEvent("MomonodoBlobPromos","HotelDestPromoClick","Destination: "+args.dest,"");}
    if(eventName==="Trace.FrontImageBanner-CarKsp-Clicked"){Tracking.trackEvent("MomonodoBlobPromos","CarKspClick","CarKsp","");}
    if(eventName==="Trace.FrontImageBanner-FlightKsp-Clicked"){Tracking.trackEvent("MomonodoBlobPromos","FlightKspClick","FlightKsp","");}
    if(eventName==="Trace.FrontImageBanner-FlightAppPromo-Clicked"){Tracking.trackEvent("MomonodoBlobPromos","FlighAppPromoClick","FlightAppPromo","");Delay(args.url);}
    if(eventName==="Trace.FrontImageBanner-HotelAppPromo-Clicked"){Tracking.trackEvent("MomonodoBlobPromos","HotelAppPromoClick","HotelAppPromo","");Delay(args.url);}
    if(eventName==="Trace.FrontImageBanner-HotelPriceGuarantee-Clicked"){Tracking.trackEvent("MomonodoBlobPromos","HotelPriceGuaranteeClick","HotelPriceGuarantee","");}
    if(eventName==="Trace.FrontImageBanner-MomondoToolPromo-Clicked"){Tracking.trackEvent("MomonodoBlobPromos","MomondoToolPromoClick","MomondoToolPromo","");Delay(args.url);}});function Delay(url){var delayDuration=300;setTimeout(function(){window.location.href=url;},delayDuration);}});jQuery(document).ready(function($)
{$('body').on('click','[data-trigger]',function(originalEvent)
{var $this=$(this);var eventName='Trigger.'+$this.data('trigger');var args=[$this.data('trigger-args'),originalEvent];var preventDefault=$this.data('prevent-default');if(preventDefault===undefined||preventDefault==true)
{originalEvent.preventDefault();}
    console.log('Event: '+eventName,args);$(this).trigger(eventName,args);});});jQuery(document).ready(function($){$('body').on('click','[data-toggle]:not(.ui-state-disabled)',function(event){var $this=$(this),$target=$($this.data('toggle')),forceToggle=$this.data('toggle-force'),toggleClass=$this.data('toggle-class');toggleClass=(toggleClass!==undefined&&toggleClass.trim()!=='')?toggleClass:'_open';if(forceToggle!==undefined&&forceToggle.trim()!==''){switch(forceToggle.trim().toLowerCase()){case'on':$target.addClass(toggleClass);break;case'off':$target.removeClass(toggleClass);break;}}else{$target.toggleClass(toggleClass);}
    if($this.is('a')||$this.is('button')){event.preventDefault();}});});jQuery(document).ready(function($){$('body').on('click','[data-popup]',function(event){var $this=$(this),popupArgs={type:'inline',modal:false,alignTop:true},popupContent=decodeURIComponent($this.data('popup')),args=$this.data('popup-args');args=(args&&args.constructor===Object)?args:{};var $popupContent=$(popupContent);if($popupContent.length===1&&$popupContent[0].tagName==="SCRIPT"&&$popupContent[0].getAttribute("type")==="text/template")
{popupContent=$popupContent.html();}
    $.extend(true,popupArgs,args,{items:{src:popupContent}});$.magnificPopup.open(popupArgs);event.preventDefault();});});(function($,window,document,undefined){var $window=$(window);$.fn.lazyload=function(options){var elements=this;var $container;var settings={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:window,data_attribute:"original",skip_invisible:true,appear:null,load:null,placeholder:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="};function update(){var counter=0;elements.each(function(){var $this=$(this);if(settings.skip_invisible&&!$this.is(":visible")){return;}
    if($.abovethetop(this,settings)||$.leftofbegin(this,settings)){}else if(!$.belowthefold(this,settings)&&!$.rightoffold(this,settings)){$this.trigger("appear");counter=0;}else{if(++counter>settings.failure_limit){return false;}}});}
    if(options){if(undefined!==options.failurelimit){options.failure_limit=options.failurelimit;delete options.failurelimit;}
        if(undefined!==options.effectspeed){options.effect_speed=options.effectspeed;delete options.effectspeed;}
        $.extend(settings,options);}
    $container=(settings.container===undefined||settings.container===window)?$window:$(settings.container);if(0===settings.event.indexOf("scroll")){$container.bind(settings.event,function(){return update();});}
    this.each(function(){var self=this;var $self=$(self);self.loaded=false;if($self.attr("src")===undefined||$self.attr("src")===false){if($self.is("img")){$self.attr("src",settings.placeholder);}}
        $self.one("appear",function(){if(!this.loaded){if(settings.appear){var elements_left=elements.length;settings.appear.call(self,elements_left,settings);}
            $("<img />").bind("load",function(){var original=$self.attr("data-"+settings.data_attribute);$self.hide();if($self.is("img")){$self.attr("src",original);}else{$self.css("background-image","url('"+original+"')");}
                $self[settings.effect](settings.effect_speed);self.loaded=true;var temp=$.grep(elements,function(element){return!element.loaded;});elements=$(temp);if(settings.load){var elements_left=elements.length;settings.load.call(self,elements_left,settings);}}).attr("src",$self.attr("data-"+settings.data_attribute));}});if(0!==settings.event.indexOf("scroll")){$self.bind(settings.event,function(){if(!self.loaded){$self.trigger("appear");}});}});$window.bind("resize",function(){update();});if((/(?:iphone|ipod|ipad).*os 5/gi).test(navigator.appVersion)){$window.bind("pageshow",function(event){if(event.originalEvent&&event.originalEvent.persisted){elements.each(function(){$(this).trigger("appear");});}});}
    $(document).ready(function(){update();});return this;};$.belowthefold=function(element,settings){var fold;if(settings.container===undefined||settings.container===window){fold=(window.innerHeight?window.innerHeight:$window.height())+$window.scrollTop();}else{fold=$(settings.container).offset().top+$(settings.container).height();}
    return fold<=$(element).offset().top-settings.threshold;};$.rightoffold=function(element,settings){var fold;if(settings.container===undefined||settings.container===window){fold=$window.width()+$window.scrollLeft();}else{fold=$(settings.container).offset().left+$(settings.container).width();}
    return fold<=$(element).offset().left-settings.threshold;};$.abovethetop=function(element,settings){var fold;if(settings.container===undefined||settings.container===window){fold=$window.scrollTop();}else{fold=$(settings.container).offset().top;}
    return fold>=$(element).offset().top+settings.threshold+$(element).height();};$.leftofbegin=function(element,settings){var fold;if(settings.container===undefined||settings.container===window){fold=$window.scrollLeft();}else{fold=$(settings.container).offset().left;}
    return fold>=$(element).offset().left+settings.threshold+$(element).width();};$.inviewport=function(element,settings){return!$.rightoffold(element,settings)&&!$.leftofbegin(element,settings)&&!$.belowthefold(element,settings)&&!$.abovethetop(element,settings);};$.extend($.expr[":"],{"below-the-fold":function(a){return $.belowthefold(a,{threshold:0});},"above-the-top":function(a){return!$.belowthefold(a,{threshold:0});},"right-of-screen":function(a){return $.rightoffold(a,{threshold:0});},"left-of-screen":function(a){return!$.rightoffold(a,{threshold:0});},"in-viewport":function(a){return $.inviewport(a,{threshold:0});},"above-the-fold":function(a){return!$.belowthefold(a,{threshold:0});},"right-of-fold":function(a){return $.rightoffold(a,{threshold:0});},"left-of-fold":function(a){return!$.rightoffold(a,{threshold:0});}});})(jQuery,window,document);jQuery(function($)
{$("img.lazyload, section.lazyload").lazyload({threshold:200,skip_invisible:false});$j("div.lazyload").lazyload({threshold:200,skip_invisible:true});});(function(factory)
{factory(jQuery);}(function($)
{if(typeof Language=='undefined'&&isVNext)
{window.Language=momondo.resources.strings;}
    return $.widget('mui.localesettings',{version:'0.1',defaultElement:'<a>',options:{labels:{title:'Locale settings',description:null,country:Language["General.Location.Country"],language:Language["toolbar_language"],currency:Language["toolbar_currency"],ok:Language["General.OK"],cancel:Language["General.Cancel"]},flags:null,country:0,language:0,currency:0,currencies:null,countries:null,confirm:null},_create:function()
    {if(this.options.flags===undefined||this.options.currencies===undefined||this.options.countries===undefined)
    {return;}
        var that=this,localeId=this.element.uniqueId().attr('id');this.changedCountry=false;this.changedLanguage=false;this.changedCurrency=false;this.country=this.options.country;this.language=this.options.language;this.currency=this.options.currency;this._updateLocale();this.ids={element:localeId,country:localeId+'-country',language:localeId+'-language',currency:localeId+'-currency',popup:localeId+'-popup'};this._drawButton();},_drawButton:function()
    {var that=this;this.element.removeAttr('href').attr('id',this.ids.element);this._renderButton();this.element.on('click',function(event)
    {that._drawPopup();that._openPopup();event.preventDefault();});},_renderButton:function()
    {this.element.empty();this.buttonCountry=$('<span>',{'class':'country __flag __'+this.options.countries[this.country].code});if(MomondoInfo.CultureInfo.CurrentCulture.Code!=="es-US"){this.buttonCountry.appendTo(this.element);}
        this.element.append(' ');this.buttonLanguage=$('<span>',{'class':'language','text':this.options.countries[this.country].language[this.language].name}).appendTo(this.element);this.element.append(' ');this.buttonCurrency=$('<span>',{'class':'currency','text':'('+this.options.currencies[this.currency].code+')'}).appendTo(this.element);},_drawPopup:function()
    {var that=this;this.popup=$('<div>',{'class':'mui-popup _modal mui-popup-localesettings','id':this.ids.popup});var container=$('<div>',{'class':'container'}).appendTo(this.popup),title=$('<div>',{'class':'title'}).appendTo(container),content=$('<div>',{'class':'content'}).appendTo(container),settings=$('<div>',{'class':'settings'}).appendTo(content);$('<h2>',{'text':this.options.labels.title}).appendTo(title);if(this.options.labels.description!==undefined&&this.options.labels.description.trim()!=='')
    {$('<div>',{'class':'description','text':this.options.labels.description}).appendTo(title);}
        this.settingCountry=$('<div>',{'class':'setting _country'}).appendTo(settings);this.settingLanguage=$('<div>',{'class':'setting _language'}).appendTo(settings);this.settingCurrency=$('<div>',{'class':'setting _currency'}).appendTo(settings);this._renderConfirms().appendTo(container);this._drawCountrySelector();this._drawCurrencySelector();},_openPopup:function()
    {this.changedCountry=false;this.changedLanguage=false;this.changedCurrency=false;$.magnificPopup.open({items:{src:this.popup,type:'inline'},modal:true,showCloseBtn:false,alignTop:true});},_closePopup:function()
    {$.magnificPopup.close();this._resetSettings();this.popup.remove();},_renderConfirms:function()
    {var that=this,confirms=$('<div>',{'class':'confirms'});this.confirmCancel=$('<a>',{'class':'confirm _cancel','tabindex':0}).append($('<span>',{'class':'label','text':Language["General.Cancel"]}));this.confirmOK=$('<a>',{'class':'confirm _ok','tabindex':0}).append($('<span>',{'class':'label','text':Language["General.OK"]}));this.confirmOK.on('click',function(event)
    {that._updateSettings();that._trigger('confirm',event,that.locale);});this.confirmCancel.add(this.confirmOK).on('click',function(event)
    {that._closePopup();event.preventDefault();});this.confirmCancel.appendTo(confirms);this.confirmOK.appendTo(confirms);return confirms;},_drawCountrySelector:function()
    {this.settingCountry.empty();var that=this,label=$('<span>',{'class':'label','text':Language["General.Location.Country"]}),select=this._renderSelectbox(this.ids.country,this.options.countries,this.country);this.settingCountry.append(label);this.settingCountry.append(' ');this.settingCountry.append(select);select.selectbox({extraMenuClass:'ui-selectmenu-menu-locale',modifier:function(event,ui)
    {var button=$(ui[0]);$('<span>',{'class':'ui-selectmenu-icon __flag __'+ui.context.value}).prependTo(button);},change:function(event,ui)
    {var icon=$(event.target).siblings('.ui-selectmenu-button').find('.ui-selectmenu-icon');icon.attr('class','ui-selectmenu-icon __flag __'+ui.item.value);},select:function(event,ui)
    {that.country=ui.item.index;that.language=0;that._drawLanguageSelector(that.country);that.changedCountry=(that.country!=that.options.country);that.changedLanguage=true;}}).data('ui-selectmenu')._renderItem=function(ul,item)
    {var li=$('<li>');$('<span>',{'class':'icon __flag __'+item.value}).appendTo(li),$('<span>',{'class':'label','text':item.label}).appendTo(li);if(item.disabled)
    {li.addClass('ui-state-disabled');}
        return li.wrapInner($('<span>',{'class':'container'})).appendTo(ul);};this._drawLanguageSelector(select[0].selectedIndex);},_drawLanguageSelector:function(id)
    {this.settingLanguage.empty();var that=this,label=$('<span>',{'class':'label','text':Language["toolbar_language"]});var select=this._renderSelectbox(this.ids.language,this.options.countries[id].language,this.language);this.settingLanguage.append(label);this.settingLanguage.append(' ');this.settingLanguage.append(select);select.selectbox({modifier:function(event,ui)
    {var button=$(ui[0]),curr=ui.context.options.selectedIndex+1,total=ui.context.length;$('<span>',{'class':'ui-selectmenu-count','text':'('+curr+'/'+total+')'}).appendTo(button);},change:function(event,ui)
    {var counter=$(event.target).siblings('.ui-selectmenu-button').find('.ui-selectmenu-count'),curr=ui.item.index+1,total=event.target.length;counter.html('('+curr+'/'+total+')');},select:function(event,ui)
    {that.language=ui.item.index;that.changedLanguage=(that.language!=that.options.language);}});},_drawCurrencySelector:function()
    {var that=this,label=$('<span>',{'class':'label','text':Language["toolbar_currency"]}),select=this._renderSelectbox(this.ids.currency,this.options.currencies,this.currency);this.settingCurrency.append(label);this.settingCurrency.append(' ');this.settingCurrency.append(select);select.selectbox({extraMenuClass:'ui-selectmenu-menu-currency',modifier:function(event,ui)
    {var button=$(ui[0]),id=ui.context.options[ui.context.selectedIndex].index,abbr=that.options.currencies[id].code,name=that.options.currencies[id].name;$('<span>',{'class':'ui-selectmenu-icon'+' ui-icon-currency-'+abbr.toLowerCase()}).prependTo(button);$('<span>',{'class':'ui-selectmenu-abbr','text':abbr.toUpperCase()}).appendTo(button);button.find('.ui-selectmenu-text').html(name);},select:function(event,ui)
    {var button=$(event.target).siblings('.ui-selectmenu-button'),id=ui.item.index,abbr=that.options.currencies[id].code,name=that.options.currencies[id].name;button.find('.ui-selectmenu-icon').attr('class','ui-selectmenu-icon'+' ui-icon-currency-'+abbr.toLowerCase());button.find('.ui-selectmenu-text').html(name);button.find('.ui-selectmenu-abbr').html(abbr.toUpperCase());that.currency=ui.item.index;that.changedCurrency=(that.currency!=that.options.currency);}}).data('ui-selectmenu')._renderItem=function(ul,item)
    {var id=item.index,abbr=that.options.currencies[id].code,name=that.options.currencies[id].name;var li=$('<li>');$('<span>',{'class':'icon'+' ui-icon-currency-'+abbr.toLowerCase()}).appendTo(li);$('<span>',{'class':'label','text':name}).appendTo(li);$('<span>',{'class':'abbr','text':abbr.toUpperCase()}).appendTo(li);if(item.disabled)
    {li.addClass('ui-state-disabled');}
        return li.appendTo(ul);};},_renderSelectbox:function(id,data,selectedId)
    {var select=$('<select>',{'id':id});for(var itm in data)
    {if(data.hasOwnProperty(itm))
    {var option=$('<option>',{'value':data[itm].code,'text':data[itm].name,'selected':(itm==selectedId)});option.appendTo(select);}}
        return select;},_resetSettings:function()
    {this.country=this.options.country;this.language=this.options.language;this.currency=this.options.currency;},_updateSettings:function()
    {this.options.country=this.country;this.options.language=this.language;this.options.currency=this.currency;this._updateLocale();this._renderButton();},_updateLocale:function()
    {var country=this.options.countries[this.country];var cultureSuffix=typeof country.alternateCode!='undefined'?country.alternateCode.toUpperCase():country.code.toUpperCase();this.locale={language:country.language[this.language],country:{code:country.code,name:country.name},currency:this.options.currencies[this.currency],locale:country.language[this.language].code+'-'+cultureSuffix,changedCountry:this.changedCountry,changedLanguage:this.changedLanguage,changedCurrency:this.changedCurrency};},getLocale:function()
    {return this.locale;}});}));(function(){var $Prototype=$;var localeSettingsInit=function(){var $=jQuery;var countries=[{code:'ar',name:'Argentina',alternateCode:'us',language:[{code:'es',name:'Español',domain:'momondo.com/es'}]},{code:'au',name:'Australia',language:[{code:'en',name:'English',domain:'momondo.com.au'}]},{code:'be',name:'België (Belgique)',language:[{code:'nl',name:'Nederlands',domain:'momondo.be'},{code:'fr',name:'Français',domain:'momondo.be/fr'}]},{code:'bo',name:'Bolivia',alternateCode:'us',language:[{code:'es',name:'Español',domain:'momondo.com/es'}]},{code:'br',name:'Brasil',language:[{code:'pt',name:'Português',domain:'momondo.com.br'}]},{code:'ca',name:'Canada',language:[{code:'en',name:'English',domain:'momondo.ca'}]},{code:'co',name:'Colombia',alternateCode:'us',language:[{code:'es',name:'Español',domain:'momondo.com/es'}]},{code:'cr',name:'Costa Rica',alternateCode:'us',language:[{code:'es',name:'Español',domain:'momondo.com/es'}]},{code:'cl',name:'Chile',alternateCode:'us',language:[{code:'es',name:'Español',domain:'momondo.com/es'}]},{code:'cz',name:'\u010Cesk\u00E1 republika',language:[{code:'cs',name:'\u010C\u0065\u0161\u0074\u0069\u006E\u0061',domain:'momondo.cz'}]},{code:'dk',name:'Danmark',language:[{code:'da',name:'Dansk',domain:'momondo.dk'}]},{code:'de',name:'Deutschland',language:[{code:'de',name:'Deutsch',domain:'momondo.de'}]},{code:'do',name:'Dominican republic',alternateCode:'us',language:[{code:'es',name:'Español',domain:'momondo.com/es'}]},{code:'ec',name:'Ecuador',alternateCode:'us',language:[{code:'es',name:'Español',domain:'momondo.com/es'}]},{code:'sv',name:'El Salvador',alternateCode:'us',language:[{code:'es',name:'Español',domain:'momondo.com/es'}]},{code:'es',name:'España',language:[{code:'es',name:'Español',domain:'momondo.es'}]},{code:'fr',name:'France',language:[{code:'fr',name:'Français',domain:'momondo.fr'}]},{code:'gt',name:'Guatemala',alternateCode:'us',language:[{code:'es',name:'Español',domain:'momondo.com/es'}]},{code:'hn',name:'Honduras',alternateCode:'us',language:[{code:'es',name:'Español',domain:'momondo.com/es'}]},{code:'in',name:'India',language:[{code:'en',name:'English',domain:'momondo.in'}]},{code:'ie',name:'Ireland',language:[{code:'en',name:'English',domain:'momondo.ie'}]},{code:'it',name:'Italia',language:[{code:'it',name:'Italiano',domain:'momondo.it'}]},{code:'mx',name:'México',language:[{code:'es',name:'Español',domain:'momondo.mx'}]},{code:'nl',name:'Nederland',language:[{code:'nl',name:'Nederlands',domain:'momondo.nl'}]},{code:'nz',name:'New Zealand',language:[{code:'en',name:'English',domain:'momondo.co.nz'}]},{code:'ni',name:'Nicaragua',alternateCode:'us',language:[{code:'es',name:'Español',domain:'momondo.com/es'}]},{code:'no',name:'Norge',language:[{code:'nb',name:'Norsk',domain:'momondo.no'}]},{code:'at',name:'Österreich',language:[{code:'de',name:'Deutsch',domain:'momondo.at'}]},{code:'pa',name:'Panama',alternateCode:'us',language:[{code:'es',name:'Español',domain:'momondo.com/es'}]},{code:'py',name:'Paraguay',alternateCode:'us',language:[{code:'es',name:'Español',domain:'momondo.com/es'}]},{code:'pe',name:'Peru',alternateCode:'us',language:[{code:'es',name:'Español',domain:'momondo.com/es'}]},{code:'pr',name:'Puerto Rico',alternateCode:'us',language:[{code:'es',name:'Español',domain:'momondo.com/es'}]},{code:'pl',name:'Polska',language:[{code:'pl',name:'Polski',domain:'momondo.pl'}]},{code:'pt',name:'Portugal',language:[{code:'pt',name:'Português',domain:'momondo.pt'}]},{code:'ro',name:'România',language:[{code:'ro',name:'Română',domain:'momondo.ro'}]},{code:'ch',name:'Schweiz (Suisse / Svizzera)',language:[{code:'de',name:'Deutsch',domain:'momondo.ch'},{code:'fr',name:'Français',domain:'momondo.ch/fr'},{code:'it',name:'Italiano',domain:'momondo.ch/it'}]},{code:'za',name:'South Africa',language:[{code:'en',name:'English',domain:'momondo.co.za'}]},{code:'fi',name:'Suomi',language:[{code:'fi',name:'Suomi',domain:'momondo.fi'}]},{code:'se',name:'Sverige',language:[{code:'sv',name:'Svenska',domain:'momondo.se'}]},{code:'tr',name:'Türkiye',language:[{code:'tr',name:'Türkçe',domain:'momondo.com.tr'}]},{code:'gb',name:'United Kingdom',language:[{code:'en',name:'English',domain:'momondo.co.uk'}]},{code:'us',name:'United States (Estados Unidos)',language:[{code:'en',name:'English',domain:'momondo.com'},{code:'es',name:'Español',domain:'momondo.com/es'}]},{code:'ru',name:'\u0420\u043E\u0441\u0441\u0438\u044F',language:[{code:'ru',name:'\u0420\u0443\u0441\u0441\u043A\u0438\u0439\u0020\u044F\u0437\u044B\u043A',domain:'momondo.ru'}]},{code:'ua',name:'\u0423\u043A\u0440\u0430\u0457\u043D\u0430',language:[{code:'uk',name:'\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430',domain:'momondo.ua'},{code:'ru',name:'\u0420\u0443\u0441\u0441\u043A\u0438\u0439\u0020\u044F\u0437\u044B\u043A',domain:'momondo.ua/ru'}]},{code:'uy',name:'Uruguay',alternateCode:'us',language:[{code:'es',name:'Español',domain:'momondo.com/es'}]},{code:'ve',name:'Venezuela',alternateCode:'us',language:[{code:'es',name:'Español',domain:'momondo.com/es'}]},{code:'cn',name:'\u4E2D\u56FD (China)',language:[{code:'zh',name:'\u7B80\u4F53\u4E2D\u6587',domain:'momondo.com.cn'}]},{code:'hk',name:'\u4E2D\u56FD\u9999\u6E2F (Hong Kong)',language:[{code:'zh',name:'\u7E41\u9AD4\u4E2D\u6587',domain:'momondo.hk'}]},{code:'tw',name:'\u53F0\u6E7E (Taiwan)',language:[{code:'zh',name:'\u7E41\u9AD4\u4E2D\u6587',domain:'momondo.tw'}]}];var culture,currencies,currencyCode;if(typeof isVNext!='undefined'&&isVNext){culture=momondo.config.user.locale.culture.toLowerCase();currencies=momondo.config.site.supportedCurrencies;currencyCode=momondo.config.user.locale.currency;}
else{culture=MomondoInfo.CultureInfo.CurrentCulture.Code.toLowerCase();currencies=[];for(var i in GCurrency.currencies){currencies.push({code:GCurrency.currencies[i].code,name:GCurrency.currencies[i].name});}
    currencyCode=GCurrency.current;}
    var currency=currencies.filter(function(x){return x.code==currencyCode})[0];var country=countries.filter(function(x){return x.code==culture.split('-')[1]})[0];var language=country.language.filter(function(x){return x.code==culture.split('-')[0]})[0];$('#localesettings').localesettings({labels:{title:'',description:'',country:'Country',language:'Language',currency:'Currency',ok:'OK',cancel:'Cancel'},flags:'/assets/images/flags/32/',currencies:currencies,countries:countries,currency:currencies.indexOf(currency),country:countries.indexOf(country),language:country.language.indexOf(language),confirm:function(event,data){function getCookie(name){var start=document.cookie.indexOf(name+"=");var len=start+name.length+1;if((!start)&&(name!=document.cookie.substring(0,name.length))){return null;}
        if(start==-1)
            return null;var end=document.cookie.indexOf(";",len);if(end==-1)
            end=document.cookie.length;return unescape(document.cookie.substring(len,end));}
        if(typeof isVNext!='undefined'&&isVNext){if(data.changedCurrency){$.ajax({async:false,type:"POST",url:"/FlightWS.asmx/SetCurrency",data:{currency:data.currency.code}});}
            if(data.changedCountry||data.changedLanguage){if(momondo.config.server.configuration==='Debug'||momondo.config.server.configuration=='Test'){window.location.href="http://"+window.location.host+"?lang="+data.locale+"&currency="+data.currency.code;}
            else{var simigvis=getCookie('SIVISITOR');window.location.href="http://www."+data.language.domain+"/?simigvis="+simigvis+"&currency="+data.currency.code+"&plr=false";}}
            else if(data.changedCurrency){window.location.reload();}}
        else if(typeof GCurrency!=="undefined"){if(data.changedCurrency){GCurrency.setCurrency(data.currency.code);$.ajax({type:"POST",url:"/FlightWS.asmx/SetCurrency",data:{currency:data.currency.code}});$Prototype(document).fire('momondo:currencyChanged',{currencyCode:data.currency.code});$ev.fire('momondo:currencyChanged',{data:data});}
            if(data.changedCountry||data.changedLanguage){setTimeout(function(){if($mm.isTestServer){window.location.href="http://"+window.location.host+"?lang="+data.locale+"&currency="+data.currency.code;}
            else{var simigvis=getCookie("SIVISITOR");window.location.href="http://www."+data.language.domain+"/?simigvis="+simigvis+"&currency="+data.currency.code+"&plr=false";}},200);}}}});};if(typeof FastInit!="undefined"){FastInit.addOnLoad(-999,localeSettingsInit);}
else{jQuery(localeSettingsInit);}})();var __extends=this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d;}
        __.prototype=b.prototype;d.prototype=new __();};var MomondoServices;(function(MomondoServices){var Cache=(function(){function Cache(){this.data={};}
    Cache.prototype.get=function(key){return this.data[key];};Cache.prototype.set=function(key,value){this.data[key]=value;};return Cache;})();var FlightResult=(function(){function FlightResult(){}
    return FlightResult;})();var ServiceBase=(function(){function ServiceBase(serviceBaseURL){this.serviceBaseURL=serviceBaseURL;this.outputErr=function(msg){if(typeof console!=='undefined'&&!!console.error){console.error(msg);}};this.cache=new Cache();}
    ServiceBase.prototype.buildURL=function(path,params,baseURL){if(baseURL===void 0){baseURL=this.serviceBaseURL;}
        return baseURL+path+'?'+jQuery.param(params);};ServiceBase.prototype.setCookie=function(name,value,domain,expires,path,secure){if(domain===void 0){domain='';}
        if(expires===void 0){expires=365;}
        if(path===void 0){path='/';}
        if(secure===void 0){secure='';}
        var today=new Date();today.setTime(today.getTime());if(expires)
            expires=expires*1000*60*60*24;var expiresDate=new Date(today.getTime()+(expires));document.cookie=name+"="+escape(value)+((expires)?";expires="+expiresDate.toGMTString():"")+((path)?";path="+path:"")+((domain)?";domain="+domain:"")+((secure)?";secure":"");};ServiceBase.prototype.getCookie=function(key){var start=document.cookie.indexOf(name+"=");var len=start+name.length+1;if((!start)&&(name!=document.cookie.substring(0,name.length))){return null;}
        if(start==-1)
            return null;var end=document.cookie.indexOf(";",len);if(end==-1)
            end=document.cookie.length;return unescape(document.cookie.substring(len,end));};return ServiceBase;})();MomondoServices.ServiceBase=ServiceBase;var FlightService=(function(_super){__extends(FlightService,_super);function FlightService(culture){var _this=this;_super.call(this,'/api/3.0/');this.culture=culture;this.LookupCities=function(text,maxCount,onLoad,onError,context){context=context||_this;onError=onError||function(options){};var cacheKey="lookup:"+text.toUpperCase()+'-'+maxCount;var results=_this.cache.get(cacheKey);if(!!results){onLoad(results);return;}
    if(!!context.jXHR)
        context.jXHR.abort();return context.jXHR=jQuery.ajax({url:_this.buildURL('Airport/',{query:text,maxCount:maxCount,cultureCode:_this.culture}),dataType:'json',type:'GET',success:function(results){var sanitizedResult=_this.sanitizeLookupResult(results);_this.cache.set(cacheKey,sanitizedResult);onLoad(sanitizedResult);},error:function(jqx,status,error){if(status!=='abort')
        onError(arguments);}});};}
    FlightService.prototype.sanitizeLookupResult=function(results){var mainCity;for(var i=0,len=results.length;i<len;i++){var result=results[i];if(result.Type===1){mainCity=result;}
    else if(!!mainCity&&result.MainCityCode===mainCity.Iata){mainCity.IsParent=true;result.IsChild=true;}}
        return results;};FlightService.prototype.GetCityByKey=function(code,onLoad,onError,context){var _this=this;onError=onError||function(){};context=context||this;if(!!context.jXHR)
        context.jXHR.abort();var requestCode=code.slice(0,3);var requestUrl=this.buildURL('Airport/',{iataCode:requestCode,cultureCode:this.culture});context.jXHR=jQuery.ajax({url:requestUrl,dataType:'json',type:'GET',success:function(result){if(result.Type===3&&/-{1}/.exec(code)){result.Iata=code;result.Type=2;}
        onLoad(result);},error:function(jqx,status,error){if(status!=='abort')
        _this.outputErr('Failed to retrieve airport');}});};FlightService.prototype.PersistModel=function(value){var cookieDomain='';var cookieValue=value instanceof Array?value.join('&'):value;this.setCookie('flightsearchmulti',cookieValue,cookieDomain);};FlightService.prototype.GetPersistedModel=function(){return this.getCookie('flightsearchmulti');};return FlightService;})(ServiceBase);MomondoServices.FlightService=FlightService;var HotelService=(function(_super){__extends(HotelService,_super);function HotelService(cultureCode,version){var _this=this;_super.call(this,'/api/3.0/HotelSearch/');this.cultureCode=cultureCode;this.version=version;this.LookupCities=function(query,maxCount,onLoad,onError,context){context=context||_this;onError=onError||function(options){};if(!!context.jXHR)
    context.jXHR.abort();var cacheKey='lookup:'+query.toUpperCase()+'-'+maxCount;var results=_this.cache.get(cacheKey);if(!!results){onLoad(results);return;}
    return context.jXHR=jQuery.ajax({url:_this.buildURL('AutoComplete',{query:query,culture:_this.cultureCode,limit:maxCount}),dataType:'json',type:'GET',success:function(results){var sanitizedResult=_this.sanitizeLookupResult(results);_this.cache.set(cacheKey,sanitizedResult);onLoad(sanitizedResult);},error:function(jqx,status,error){if(status!=='abort')
        onError(arguments);}});};var cultureParts=cultureCode.split('-');var languageCode=cultureParts[0].toUpperCase();var countryCode=cultureParts[1].toUpperCase();if(typeof HotelUtils!=='undefined')
    languageCode=HotelUtils.getLanguageCode();this.languageCode=languageCode;this.countryCode=countryCode;}
    HotelService.prototype.sanitizeLookupResult=function(results){var destinations=results,groups={},groupIndex=0,version=this.version;for(var i=0,len=destinations.length;i<len;i++){var d=destinations[i],type=d.t;var typeName=d.tn,group=groups[type]||(groups[type]={locations:[],name:typeName,index:groupIndex++});group.locations.push({countryCode:d.cc,hotelCountLabel:d.h,hotelCount:d.hc,key:d.k,name:d.n,place:d.p,type:type,searchable:d.s});}
        var groupList=[],arr=[],i=0;for(var obj in groups){groupList[i++]=groups[obj];}
        groupList.sort(function(a,b){return a.index-b.index;});var parsedResults=[];for(var i=0,len=groupList.length;i<len;i++){var group=groupList[i];parsedResults.push({group:true,name:group.name});parsedResults.push.apply(parsedResults,group.locations);}
        return parsedResults;};HotelService.prototype.GetCityByKey=function(code,onLoad,onError,context){var _this=this;onError=onError||function(){};context=context||this;if(!!context.jXHR)
        context.jXHR.abort();context.jXHR=jQuery.ajax({url:this.buildURL('HotelSearch/GetHotelCity',{IataCode:code,CultureCode:this.languageCode},'/api/3.0/'),type:'GET',dataType:'json',success:function(result){onLoad(result);},error:function(jqx,status,error){if(status!=='abort')
        _this.outputErr('unable to get data from source');}});};HotelService.prototype.GetPlaceByFileName=function(fileName,onLoad,onError,context){var _this=this;onError=onError||function(){};context=context||this;if(!!context.jXHR)
        context.jXHR.abort();context.jXHR=jQuery.ajax({url:this.buildURL('HotelSearch/GetPlaceByFileName',{FileName:fileName,CultureCode:this.languageCode},'/api/3.0/'),type:'GET',dataType:'json',success:function(result){onLoad(result);},error:function(jqx,status,error){if(status!=='abort')
        _this.outputErr('unable to get data from source');}});};HotelService.prototype.PersistModel=function(value){var cookieDomain='';var cookieValue=value instanceof Array?value.join(';'):value;this.setCookie('hc-search-data',cookieValue,cookieDomain);};HotelService.prototype.GetPersistedModel=function(){var cookieValue=this.getCookie('hc-search-data');var modelData=cookieValue!=null?cookieValue.split(';'):[];return modelData;};return HotelService;})(ServiceBase);MomondoServices.HotelService=HotelService;var CarService=(function(_super){__extends(CarService,_super);function CarService(defaultMaxCount,cultureCode){var _this=this;_super.call(this,'/api/3.0/');this.defaultMaxCount=defaultMaxCount;this.cultureCode=cultureCode;this.LookupCities=function(text,maxCount,onComplete,onError,context){context=context||_this;onError=onError||function(options){};if(!!context.jXHR)
    context.jXHR.abort();var cacheKey='lookup:'+text+'-'+maxCount;var results=_this.cache.get(cacheKey);if(!!results){onComplete(results);return;}
    return context.jXHR=jQuery.ajax({url:_this.buildURL('CarLocation/',{query:text,maxCount:_this.defaultMaxCount,cultureCode:_this.cultureCode}),dataType:'json',type:'GET',success:function(results){var parsedResults=_this.sanitizeLookupResult(results);_this.cache.set(cacheKey,parsedResults);onComplete(parsedResults);},error:function(jqx,status,error){if(status!=='abort')
        _this.outputErr(error);}});};}
    CarService.prototype.sanitizeLookupResult=function(results){var locations=[];for(var i=0,len=results.length;i<len;i++){var result=results[i];locations.push(new CarLocation(result.Id,result.Label||result.Name,result.CountryCode,result.CountryName,result.StateName,result.IataCode));}
        return locations;var parsedResults=[];var groups={};var getPriorityByType=function(type){switch(type){case 0:return 0;case 1:return 1;default:return 2;}};for(var i=0,len=results.length;i<len;i++){var result=results[i];var group=groups[result.LocationType]||(groups[result.LocationType]={locations:[],name:'Resolve location name: '+result.LocationType,index:getPriorityByType(result.LocationType)});group.locations.push(new CarLocation(result.Id,result.Label||result.Name,result.CountryCode,result.CountryName,result.StateName,result.IataCode));}
        var groupList=[],arr=[],i=0;for(var obj in groups){groupList[i++]=groups[obj];}
        groupList.sort(function(a,b){return a.index-b.index;});for(var i=0,len=groupList.length;i<len;i++){var group=groupList[i];parsedResults.push({group:true,name:group.name});parsedResults.push.apply(parsedResults,group.locations);}
        return parsedResults;};CarService.prototype.GetCityByKey=function(code,onLoad,onError,context){var _this=this;onError=onError||function(){};context=context||this;if(!!context.jXHR)
        context.jXHR.abort();context.jXHR=jQuery.ajax({url:this.buildURL('CarLocation/',{IATACode:code,cultureCode:this.cultureCode}),dataType:'json',type:'GET',success:function(result){onLoad(result);},error:function(jqx,status,error){if(status!=='abort')
        _this.outputErr(error);}});};CarService.prototype.PersistModel=function(value){var cookieDomain='';var cookieValue=value instanceof Array?value.join(";"):value;this.setCookie('ct-search-data',cookieValue,cookieDomain);};CarService.prototype.GetPersistedModel=function(){return this.getCookie('ct-search-data');};return CarService;})(ServiceBase);MomondoServices.CarService=CarService;})(MomondoServices||(MomondoServices={}));var Translation;(function(_Translation)
{var ZERO='zero';var ONE='one';var TWO='two';var FEW='few';var MANY='many';var OTHER='other';var DefaultLanguageResource=(function()
{function DefaultLanguageResource()
{this.language=Language;}
    DefaultLanguageResource.prototype.GetText=function(key)
    {return this.language[key];};return DefaultLanguageResource;})();var Translation=(function()
{function Translation(culture,resourceManager)
{this.culture=culture;var c=this.constructor;var instance=c.Instance;if(!!instance)
    return instance;else
    c.Instance=this;if(!resourceManager)
    this.resourceManager=new DefaultLanguageResource();else
    this.resourceManager=resourceManager;this.cache={};}
    Translation.prototype.getTranslation=function(key,variant)
    {var cacheKey=key+'.'+variant;var translation=this.cache[cacheKey];if(!!translation)
        return translation;var parsedKey=this.parseKey(key,variant);var translation=this.resourceManager.GetText(parsedKey);return translation;};Translation.prototype.getTranslationWithPluralization=function(resourceName,parameters)
{if(!!translation)
    return translation;var translation=this.resourceManager.GetText(resourceName);try
{if(translation)
    translation=this.HandlePluralizations(translation,parameters);}
catch(e)
{if(console&&console.log)
    console.log("Error in HandlePluralizations");}
    if(!translation)
        translation='';return translation;};Translation.prototype.HandlePluralizations=function(text,parameters)
{var output=text;if(text.indexOf('{#')>0)
{startIndex=text.indexOf('{#');var temp=text.substring(startIndex+2);endIndex=temp.indexOf('}');var placeholderString=temp.substring(0,endIndex);var placeholderItems=placeholderString.split(' ');var translation='';if(placeholderItems.length>0)
{var placeholderName=placeholderItems[0];for(var i=0;i<=parameters.length-1;i++)
{var parameter=parameters[i];if(placeholderName==parameter.name)
{for(var i=1;i<=placeholderItems.length-1;i++)
{var pluralform=this.getPluralForm(parameter.value)||OTHER;if(placeholderItems[i].lastIndexOf(pluralform,0)===0)
{var items=placeholderItems[i].split(':');translation=items[1].substring(1,items[1].length-1);}}}}}
    var replaceString=text.replace('{#'+placeholderString+'}',translation);output=this.HandlePluralizations(replaceString,parameters);}
    return output;}
    Translation.prototype.parseKey=function(key,variant)
    {switch(typeof variant)
    {case'number':return key+'.'+(this.getPluralForm(variant)||OTHER);break;}
        return key;};Translation.prototype.getPluralForm=function(number,culture)
{if(typeof culture==="undefined"){culture=this.culture;}
    var getPluralForm=function(number)
    {return OTHER;};switch(culture.TwoLetterISOLanguageName)
{case'lt':getPluralForm=function(number)
    {if(((number%10)==1)&&(((number%100)<11||(number%100)>19)))
        return ONE;if((((number%10)>=2&&(number%10)<=9))&&(((number%100)<11||(number%100)>19)))
        return FEW;};break;case'lv':getPluralForm=function(number)
    {if(number==0)
        return ZERO;if(((number%10)==1)&&((number%100)!=11))
        return ONE;};break;case'cy':getPluralForm=function(number)
    {if(number==2)
        return TWO;if(number==3)
        return FEW;if(number==0)
        return ZERO;if(number==1)
        return ONE;if(number==6)
        return MANY;};break;case'be':case'bs':case'hr':case'ru':case'sh':case'sr':case'uk':getPluralForm=function(number)
    {if(((number%10)==1)&&((number%100)!=11))
        return ONE;if((((number%10)>=2&&(number%10)<=4))&&(((number%100)<12||(number%100)>14)))
        return FEW;if(((number%10)==0)||(((number%10)>=5&&(number%10)<=9))||(((number%100)>=11&&(number%100)<=14)))
        return MANY;};break;case'ksh':getPluralForm=function(number)
    {if(number==0)
        return ZERO;if(number==1)
        return ONE;};break;case'shi':getPluralForm=function(number)
    {if((number>=2&&number<=10))
        return FEW;if((number>=0&&number<=1))
        return ONE;};break;case'he':getPluralForm=function(number)
    {if(number==2)
        return TWO;if(number==1)
        return ONE;if((number!=0)&&((number%10)==0))
        return MANY;};break;case'cs':case'sk':getPluralForm=function(number)
    {if(number==1)
        return ONE;if((number>=2&&number<=4))
        return FEW;};break;case'br':getPluralForm=function(number)
    {if((number!=0)&&((number%1000000)==0))
        return MANY;if(((number%10)==1)&&(((number%100)!=11)&&((number%100)!=71)&&((number%100)!=91)))
        return ONE;if(((number%10)==2)&&(((number%100)!=12)&&((number%100)!=72)&&((number%100)!=92)))
        return TWO;if((((number%10)>=3&&(number%10)<=4)||((number%10)==9))&&(((number%100)<10||(number%100)>19)&&((number%100)<70||(number%100)>79)&&((number%100)<90||(number%100)>99)))
        return FEW;};break;case'sl':getPluralForm=function(number)
    {if((number%100)==2)
        return TWO;if((number%100)==1)
        return ONE;if(((number%100)>=3&&(number%100)<=4))
        return FEW;};break;case'lag':getPluralForm=function(number)
    {if(number==0)
        return ZERO;if(((number>=0&&number<=2))&&(number!=0)&&(number!=2))
        return ONE;};break;case'pl':getPluralForm=function(number)
    {if(number==1)
        return ONE;if((((number%10)>=2&&(number%10)<=4))&&(((number%100)<12||(number%100)>14)))
        return FEW;if(((number!=1)&&(((number%10)>=0&&(number%10)<=1)))||(((number%10)>=5&&(number%10)<=9))||(((number%100)>=12&&(number%100)<=14)))
        return MANY;};break;case'gd':getPluralForm=function(number)
    {if((number==2)||(number==12))
        return TWO;if((number==1)||(number==11))
        return ONE;if((number>=3&&number<=10)||(number>=13&&number<=19))
        return FEW;};break;case'gv':getPluralForm=function(number)
    {if((((number%10)>=1&&(number%10)<=2))||((number%20)==0))
        return ONE;};break;case'mk':getPluralForm=function(number)
    {if(((number%10)==1)&&(number!=11))
        return ONE;};break;case'mt':getPluralForm=function(number)
    {if(number==1)
        return ONE;if(((number%100)>=11&&(number%100)<=19))
        return MANY;if((number==0)||(((number%100)>=2&&(number%100)<=10)))
        return FEW;};break;case'mo':case'ro':getPluralForm=function(number)
    {if(number==1)
        return ONE;if((number==0)||((number!=1)&&(((number%100)>=1&&(number%100)<=19))))
        return FEW;};break;case'ga':getPluralForm=function(number)
    {if(number==2)
        return TWO;if(number==1)
        return ONE;if((number>=3&&number<=6))
        return FEW;if((number>=7&&number<=10))
        return MANY;};break;case'ff':case'fr':case'kab':getPluralForm=function(number)
    {if(((number>=0&&number<=2))&&(number!=2))
        return ONE;};break;case'iu':case'kw':case'se':case'naq':case'sma':case'smi':case'smj':case'smn':case'sms':getPluralForm=function(number)
    {if(number==2)
        return TWO;if(number==1)
        return ONE;};break;case'ak':case'am':case'bh':case'hi':case'ln':case'mg':case'ti':case'tl':case'wa':case'fil':case'guw':case'nso':getPluralForm=function(number)
    {if((number>=0&&number<=1))
        return ONE;};break;case'tzm':getPluralForm=function(number)
    {if(((number>=0&&number<=1))||((number>=11&&number<=99)))
        return ONE;};break;case'af':case'bg':case'bn':case'ca':case'da':case'de':case'dv':case'ee':case'el':case'en':case'eo':case'es':case'et':case'eu':case'fi':case'fo':case'fy':case'gl':case'gu':case'ha':case'is':case'it':case'kk':case'kl':case'ks':case'ku':case'ky':case'lb':case'lg':case'ml':case'mn':case'mr':case'nb':case'nd':case'ne':case'nl':case'nn':case'no':case'nr':case'ny':case'om':case'or':case'os':case'pa':case'ps':case'pt':case'rm':case'sn':case'so':case'sq':case'ss':case'st':case'sv':case'sw':case'ta':case'te':case'tk':case'tn':case'ts':case'ur':case've':case'vo':case'xh':case'zu':case'asa':case'ast':case'bem':case'bez':case'brx':case'cgg':case'chr':case'ckb':case'fur':case'gsw':case'haw':case'jgo':case'jmc':case'kaj':case'kcg':case'kkj':case'ksb':case'mas':case'mgo':case'nah':case'nnh':case'nyn':case'pap':case'rof':case'rwk':case'saq':case'seh':case'ssy':case'syr':case'teo':case'tig':case'vun':case'wae':case'xog':getPluralForm=function(number)
    {if(number==1)
        return ONE;};break;case'ar':getPluralForm=function(number)
    {if(number==2)
        return TWO;if(number==1)
        return ONE;if(number==0)
        return ZERO;if(((number%100)>=3&&(number%100)<=10))
        return FEW;if(((number%100)>=11&&(number%100)<=99))
        return MANY;};break;}
    this.getPluralForm=getPluralForm;return this.getPluralForm(number);};return Translation;})();_Translation.Translation=Translation;})(Translation||(Translation={}));var SearchForm;(function(SearchForm){'use strict';var Calendar=(function(){function Calendar(element,options){var lang=Language;var _options={minDate:options.minDate,maxDate:"+1y",clearable:options.clearable,date:options.date||new Date(),defaultDate:null,closeText:lang["General.Calendar.Done"],prevText:lang["General.Calendar.Previous"],nextText:lang["General.Calendar.Next"],currentText:lang["General.Calendar.Today"],monthNames:options.monthNames,monthNamesShort:options.monthNamesShort,dayNames:options.dayNames,dayNamesShort:options.dayNamesShort,dayNamesMin:options.dayNamesShort,weekHeader:lang["General.Calendar.Week"],dateFormat:"mm/dd/yy",firstDay:options.firstDayOfWeek,getHighlightDates:options.getHighlightDates||null,change:null,close:null,focus:null,open:function(ev){if(!!element){var menu=element.calendar('getWidget');$ev.fire('widget:popup-opened',menu);}
    if(options.onOpen==='function')
        options.onOpen();},select:options.onSelect,clear:options.onClear};element.calendar(_options);this.calendar=element;}
    Calendar.prototype.getDate=function(){return this.calendar.calendar('getDate');};Calendar.prototype.setDate=function(date,updateLabel){if(updateLabel===void 0){updateLabel=true;}
        this.calendar.calendar('setDate',date,updateLabel);};Calendar.prototype.setCleared=function(cleared){this.calendar.calendar('setCleared',cleared);};Calendar.prototype.validated=function(state,msg){this.calendar.calendar("validated",state,msg);};Calendar.prototype.open=function(){this.calendar.calendar('open');};return Calendar;})();SearchForm.Calendar=Calendar;var ControlFactory=(function(){function ControlFactory(){var dateTimeFormat=MomondoInfo.CultureInfo.CurrentCulture.dateTimeFormat;this.monthNames=dateTimeFormat.MonthNames;this.monthNamesShort=dateTimeFormat.AbbreviatedMonthNames;this.dayNames=dateTimeFormat.DayNames;this.dayNamesShort=dateTimeFormat.ShortestDayNames;this.firstDayOfWeek=dateTimeFormat.FirstDayOfWeek;}
    ControlFactory.prototype.CreateCalendar=function(input,options){options.monthNames=this.monthNames,options.monthNamesShort=this.monthNamesShort,options.dayNames=this.dayNames,options.dayNamesShort=this.dayNamesShort,options.dayNamesMin=this.dayNamesMin;options.firstDayOfWeek=this.firstDayOfWeek;return new Calendar(input,options);};ControlFactory.prototype.CreateCompleter=function(element,type,dataService,watermark,formatCityName,formatItem,formatMenu,onSelect){var lastFocusedItem;var oldValue;var elementId=element.uniqueId().attr('id');var evPending=null;var ua=navigator.userAgent;var isIOS=ua.indexOf('iPad')>-1||ua.indexOf('iPhone')>-1;var onBlur=function(ev){var item=lastFocusedItem;if(item){if(!item.hasOwnProperty("group")&&item.displayName){var name=item["displayName"]();element.val(name);oldValue=name;lastFocusedItem=null;onSelect(ev,{item:item});}}
    else if(oldValue){element.val(oldValue);}};var onItemSelected=function(ev,options){if(!ev.key||ev.key!=='Tab'){ev.preventDefault();element.blur();}
        lastFocusedItem=null;var item=options.item;var name=item.displayName();element.val(name);oldValue=name;onSelect(ev,options);};jQuery(element[0]).on('click',function(evt){this.select();});var onResponse=function(){$ev.fire(String.format('control:autocomplete.{0}',elementId));};var options={appendTo:null,disabled:false,dataService:dataService,placeholder:null,type:type,autoFocus:true,delay:300,minLength:2,change:null,close:null,focus:function(event,ui){},open:function(event,ui){},response:function(evt,ui){lastFocusedItem=null;var content=ui.content;var contentLength=content.length;if(contentLength>0){var index=0;while(index<contentLength){if(!content[index].hasOwnProperty('group')){lastFocusedItem=content[index];break;}
        index++;}}
        onResponse();},blur:onBlur,search:null,select:onItemSelected,watermark:'-- watermark --',showGeoButton:false,clickGeoButton:null,openDropdown:null,closeDropdown:null,selectDropdown:null,renderItem:formatItem,renderMenu:formatMenu};element.geolocate(options);jQuery(element[0]).on('focus',function(evt){if(!isIOS){jQuery(element[0]).select().on('mouseup',function(e){e.preventDefault();jQuery(this).unbind("mouseup");});oldValue=element.val();}
    else{var value=jQuery(this).val()||'';var input=jQuery(this)[0];setTimeout(function(){input.setSelectionRange(0,value.length);},200);}});WatermarkManager.add(element[0].id,{watermarkText:watermark});var loadCity=function(key,onLoad,onError){var context=jQuery(element[0]);dataService.GetCityByKey(key,function(result,onLoad){if(typeof formatCityName==='function')
        completer.setText(formatCityName(result));if(typeof onLoad==='function')
        onLoad(result);},function(){if(typeof onError==='function')
        onError();},context);};var completer={getText:function(){return element.val();},setText:function(text){element.val(text);},validated:function(state,msg){element.geolocate("validated",state,msg);},pending:function(callback){var isPending=element.geolocate('pending');if(isPending){if(evPending){evPending.stop();}
        evPending=$ev.observe(String.format('control:autocomplete.{0}',elementId),function(){callback();});}
        return isPending;},focus:function(){element.focus();},loadCity:loadCity};return completer;};ControlFactory.prototype.CreateGuestList=function(container,data,onConfirm,onCancel){var lang=Language;var title=lang['SearchForm.Hotel.Guests.Title'];var cancel=lang['General.Cancel'];var ok=lang['General.OK'];var popupHtml=String.format('<div class="mui-popup _modal mui-popup-hotelguests">'+'<div class="container">'+'<div class="title">'+'<h2>{0}</h2>'+'</div>'+'<div class="content"></div>'+'<div class="confirms">'+'<div class="confirm _cancel">'+'<span class="label">{1}</span>'+'</div>'+'<div class="confirm _ok">'+'<span class="label">{2}</span>'+'</div>'+'</div>'+'</div>'+'</div>',title,cancel,ok);var popup=jQuery(popupHtml);var magnificPopup=jQuery.magnificPopup;var confirms=popup.find('.confirms');var confirmCancel=confirms.children('._cancel');var confirmOk=confirms.children('._ok');var closePopup=function(){magnificPopup.close();};confirmCancel.click(function(){closePopup();onCancel();});confirmOk.click(function(){var rooms=popup.find('.content').guestlist('getRoomsString');onConfirm(rooms);closePopup();});var maxChildAge=17;popup.find('.content').guestlist({rooms:data,maxChildAge:maxChildAge,label:{room:lang['General.Room'],newRoom:lang['HotelSearchForm.AddRoom'],header:{room:'',adults:lang['General.Adults'],children:lang['General.Children'],childrenAge:lang['HotelSearchForm.AgeOfChildren']},ok:lang['General.OK'],cancel:lang['General.Cancel']}});magnificPopup.open({items:{src:popup,type:'inline'},modal:true,showCloseBtn:false,alignTop:true});return popup;};ControlFactory.prototype.CreateSelectBox=function(element,appendValClass,onChange){element.selectbox({positionOptions:{collision:'none'},appendValClass:appendValClass,inline:element.data('inline'),inlineLabel:element.data('inline-label'),change:function(ev,data){var value=data.item.value;onChange(value);},open:function(evt){var menu=element.selectbox('getMenuWidget');$ev.fire('widget:popup-opened',menu);}});var ret={setValue:function(value){element.selectbox('setValue',value);},setDisabled:function(value){element.selectbox('option','disabled',value);},validated:function(state,msg){element.selectbox("validated",state,msg);},element:element};return ret;};ControlFactory.prototype.CreateSubmitButton=function(element,onClick,onMouseEnter,onMouseLeave){var removeClass=(function(){element.removeClass('_shine');}).throttle(1000);var _shine=function(){element.addClass('_shine');removeClass();};element.click(onClick);element.mouseenter(onMouseEnter);element.mouseleave(onMouseLeave);return{shine:_shine};};return ControlFactory;})();SearchForm.ControlFactory=ControlFactory;})(SearchForm||(SearchForm={}));var WatermarkManager;if(typeof Class=='undefined')
{WatermarkManager={add:function(){console.log('WARNING: Mock implementation of WatermarkManager was used!');}};}
else
{var Watermark=Class.create({initialize:function(element,options)
{this.element=$(element);this.options=options;this.update();this.element.on('focus',this._onFocus.bind(this));this.element.on('blur',this._onBlur.bind(this));},update:function(force)
{if(typeof document.activeElement=='undefined')
    return;if(typeof force=='undefined')
    force=false;if(force)
{this.element.value='';this.element.removeClassName('watermark');}
    try
    {if(document.activeElement==this.element)
        this._onFocus();else
        this._onBlur();}
    catch(e)
    {}},_onFocus:function()
{if(this.element.value==this.options.watermarkText)
{this.element.value='';this.element.removeClassName('watermark');}},_onBlur:function()
{if(this.element.value==''||this.element.value==this.options.watermarkText)
{this.element.value=this.options.watermarkText;this.element.addClassName('watermark');}
else
    this.element.removeClassName('watermark');}});WatermarkManager=new(Class.create({initialize:function()
{this.watermarksToBeLoaded=new Hash();this.watermarks=new Hash();this.loaded=false;FastInit.addOnLoad(this._onLoad.bind(this));},add:function(id,options)
{if(this.loaded)
    this._addWatermark(id,options);else
    this.watermarksToBeLoaded.set(id,options);},update:function(element)
{element=$(element);var watermark=this.watermarks.get(element.id);if(watermark!=null)
    watermark.update();},_onLoad:function()
{var wmgr=this;this.watermarksToBeLoaded.each(function(w)
{wmgr._addWatermark(w[0],w[1]);});this.loaded=true;},_addWatermark:function(id,options)
{this.watermarks.set(id,new Watermark(id,options));}}));}
var SearchForm;(function(SearchForm){'use strict';(function(TripType){TripType[TripType["ONEWAY"]=1]="ONEWAY";TripType[TripType["RETURN"]=2]="RETURN";TripType[TripType["MULTI"]=4]="MULTI";})(SearchForm.TripType||(SearchForm.TripType={}));var TripType=SearchForm.TripType;(function(AirportType){AirportType[AirportType["UNSPECIFIED"]=-1]="UNSPECIFIED";AirportType[AirportType["MAINCITY"]=0]="MAINCITY";AirportType[AirportType["AIRPORT"]=1]="AIRPORT";})(SearchForm.AirportType||(SearchForm.AirportType={}));var AirportType=SearchForm.AirportType;var SearchFormFlight=(function(){function SearchFormFlight(name,element,factory,dataService,textManager,init,model,currencyCode,getParentSearchIntent){this.name=name;this.element=element;this.factory=factory;this.dataService=dataService;this.textManager=textManager;this.init=init;this.model=model;this.currencyCode=currencyCode;this.getParentSearchIntent=getParentSearchIntent;this.maxSegmentCount=4;this.UIValid=true;this.pendingSearchIntent=false;this.watermarkOrigin=Language['SearchForm.Flight.Watermark.Origin'];this.watermarkDestination=Language['SearchForm.Flight.Watermark.Destination'];this.prepareModel();}
    SearchFormFlight.prototype.getSearchIntent=function(){return this.getParentSearchIntent()||this.pendingSearchIntent;};SearchFormFlight.prototype.prepareModel=function(){this.tripType=this.getTripType();this.sanitizeModelDates();this.model.SegmentsMulti=this.cloneSegments(this.model.Segments);this.model.Segments.length=Math.min(this.model.Segments.length,2);this.searchBehavior=this.model.SearchBehavior;};SearchFormFlight.prototype.cloneSegments=function(segments){var copy=JSON.parse(JSON.stringify(segments));for(var i=0,len=copy.length;i<len;i++){copy[i].Depart=new Date(segments[i].Depart);}
        return copy;};SearchFormFlight.prototype.cloneSegment=function(segment){var copy=JSON.parse(JSON.stringify(segment));copy.Depart=new Date(segment.Depart.getTime());return copy;};SearchFormFlight.prototype.sanitizeModelDates=function(){var re=/^\d{4}-\d{1,2}-\d{1,2}T\d{1,2}:\d{1,2}:\d{1,2}/;var model=this.model;var segments=model.Segments;for(var i=0,len=segments.length;i<len;i++){var segment=segments[i];var match=re.exec(segment.Depart);if(match&&match.length)
        segment.Depart=Date.fromISO(match[0]);else
        segment.Depart=new Date();}};SearchFormFlight.prototype.setTripType=function(tripType,userTriggered){switch(tripType){case 1:var calendarReturn=this.segmentRowRoundTrip.controls['return-date'];calendarReturn.setCleared(true);break;case 2:var model=this.model;var segments=model.Segments;var segmentHomeBound=segments[1];if(!segmentHomeBound){segmentHomeBound=this.cloneSegments([segments[0]])[0];}
        var calendarReturn=this.segmentRowRoundTrip.controls['return-date'];var controlReturnDate=calendarReturn.getDate();var returnDate=segmentHomeBound.Depart;segmentHomeBound.Destination=segments[0].Origin;segmentHomeBound.Origin=segments[0].Destination;calendarReturn.setCleared(false,returnDate);calendarReturn.setDate(returnDate);break;case 4:if(userTriggered){var previousTripType=this.tripType;this.copyRoundTripToMultidestinationIfEmpty(previousTripType);}
        break;}
        this.initPaxSelector(tripType);this.selectTripType.setValue(tripType+'');this.tripType=tripType;if(userTriggered)
            this.tripTypeChanged(tripType,userTriggered);};SearchFormFlight.prototype.copyRoundTripToMultidestinationIfEmpty=function(previousTripType){if(this.model.SegmentsMulti[0].Origin!==""){return;}
        this.model.SegmentsMulti[0]=this.cloneSegment(this.model.Segments[0]);this.segmentRowsMulti[0].controls['origin'].setText(this.segmentRowRoundTrip.controls['origin'].getText());this.segmentRowsMulti[0].controls['destination'].setText(this.segmentRowRoundTrip.controls['destination'].getText());this.segmentRowsMulti[0].controls['depart-date'].setDate(this.segmentRowRoundTrip.controls['depart-date'].getDate());if(previousTripType!==1){if(this.segmentRowsMulti.length===1){this.addMultiSegment(false);}
            this.model.SegmentsMulti[1]=this.cloneSegment(this.model.Segments[1]);this.segmentRowsMulti[1].controls['origin'].setText(this.segmentRowRoundTrip.controls['destination'].getText());this.segmentRowsMulti[1].controls['destination'].setText(this.segmentRowRoundTrip.controls['origin'].getText());this.segmentRowsMulti[1].controls['depart-date'].setDate(this.segmentRowRoundTrip.controls['return-date'].getDate());}};SearchFormFlight.prototype.initForm=function(){var _this=this;var that=this;var element=this.element;var model=this.model;var segments=model.Segments;var ticketClass=model.TicketClass;var includeNearby=model.IncludeNearby;var directOnly=model.DirectOnly;var factory=this.factory;var dataService=this.dataService;var element=this.element;var getCheckedChangedHandler=function(func){return function(ev){var checked=jQuery(ev.target).prop('checked');func.call(null,checked);};};var chkDirect=this.chkDirect=element.find('input#chk_direct');chkDirect.prop('checked',directOnly?'checked':null);chkDirect.change(getCheckedChangedHandler(function(checked){model.DirectOnly=checked;_this.formChanged('direct-only',checked);}));var chkNearby=this.chkNearby=element.find('input#chk_nearby');chkNearby.prop('checked',(includeNearby?'checked':null));chkNearby.change(getCheckedChangedHandler(function(checked){model.IncludeNearby=checked;_this.formChanged('include-nearby',checked);}));var selectTripType=element.find('#flights-triptype');selectTripType.val(this.tripType);this.selectTripType=factory.CreateSelectBox(selectTripType,true,function(value){_this.setTripType(TripType[TripType[value]],true);});var selectTicketClass=element.find('#flights-ticketclass');selectTicketClass.val(ticketClass);this.selectTicketClass=factory.CreateSelectBox(selectTicketClass,false,function(ticketClass){model.TicketClass=ticketClass;_this.formChanged('ticket-class',ticketClass);});this.initSegmentsRoundTrip();this.initSegmentsMulti();this.parentSearchBox=this.element.parents('.mui-searchbox');this.initForm=function(){_this.setFormScope();if(!_this.getValid()){_this.updateUI();}};this.initPaxSelector(this.tripType);this.element.find('.on-init-remove').remove();this.setFormScope();};SearchFormFlight.prototype.updateUI=function(){var tripType=this.tripType;var model=this.model;var segments;switch(tripType){case 4:segments=model.SegmentsMulti;var segmentRowsMulti=this.segmentRowsMulti;for(var i=0,len=segments.length;i<len;i++){segmentRowsMulti[i].controls['depart-date'].setDate(segments[i].Depart);}
        break;default:segments=model.Segments;var segmentRowRoundTrip=this.segmentRowRoundTrip;segmentRowRoundTrip.controls['depart-date'].setDate(segments[0].Depart);if(this.tripType===2)
        segmentRowRoundTrip.controls['return-date'].setDate(segments[1].Depart);break;}
        var controlData=this.getPaxControlData();if(!(controlData.adultCount===model.AdultCount&&(controlData.childAges||[]).toString()===model.ChildAges.toString()))
            this.initPaxSelector(tripType);this.setValid(true);};SearchFormFlight.prototype.getPaxControlData=function(){var data=this.paxElement.paxselect('getData');var adultCount=data.adults;var childAges=[];var childrenAges=data.childrenAges;if(childrenAges instanceof Array&&childrenAges.length){childAges=childrenAges.slice(1);}
    else{if(!!childrenAges){jQuery.map(childrenAges,function(age){childAges.push(age);});}}
        var result={adultCount:adultCount,childAges:childAges};return result;};SearchFormFlight.prototype.initPaxSelector=function(tripType){var _this=this;var paxElement=jQuery('<div class="input _passengers"><div></div></div>');switch(tripType){case 1:this.segmentRowRoundTrip.element.find('.input._passengers').replaceWith(paxElement);break;case 2:this.segmentRowRoundTrip.element.find('.input._passengers').replaceWith(paxElement);break;case 4:this.segmentRowsMulti[0].element.find('.input._passengers').replaceWith(paxElement);break;}
        paxElement=paxElement.children(':first');var element=this.element;var model=this.model;var adultCount=model.AdultCount;var childAges=model.ChildAges;var paxChanged=function(){var paxData=_this.getPaxControlData();model.AdultCount=paxData.adultCount;model.ChildAges=paxData.childAges;_this.formChanged('pax',{});return"";};var numberOfChildren=!!childAges?childAges.length:0;var arrChildAges=!!numberOfChildren?[numberOfChildren]:null;if(!!arrChildAges)
            arrChildAges.push.apply(arrChildAges,childAges);var lang=Language;paxElement.paxselect({showAdults:true,showClose:false,labels:{closeBtn:lang['general_close'],adults:lang['General.Adults'],children:lang['General.Children'],childrenAge:'Age of child {i}',passengers:{0:'{i} passengers',1:'{i} passenger',2:'{i} passengers',5:'{i} passengers'}},formatters:{formatAgeOfChild:function(number){return String.format(lang['General.Pax.AgeOfChild'],number);},formatPassengers:function(count){return String.format(_this.textManager.getTranslation('General.Pax.Passenger',count),count.toString());}},adults:model.AdultCount,childrenAges:arrChildAges,children:numberOfChildren,showChildren:true,position:{my:'right top',at:'right bottom'},close:paxChanged,open:function(){var item=paxElement.paxselect('getMenu');$ev.fire('widget:popup-opened',item);}});this.paxElement=paxElement;};SearchFormFlight.prototype.initSegmentsRoundTrip=function(){var _this=this;var model=this.model;var segments=model.Segments;var element=this.element;var factory=this.factory;var dataService=this.dataService;var segmentRowRoundTrip=element.find('.inputs._roundtrip');var t=this;var segmentOut=segments[0];var segmentHome=segments[1];if(!segmentHome){segmentHome=this.cloneSegments([segmentOut])[0];var origin=segmentHome.Origin;segmentHome.Origin=segmentHome.Destination;segmentHome.Destination=origin;segments[1]=segmentHome;}
        this.segmentRowRoundTrip=this.initSegmentRow(segmentOut,segmentRowRoundTrip,segmentHome);$ev.observe('control:flight-searchform-changed',function(options){if(_this.getSearchIntent())
            return;var key=options.key;if(key==='segment'){var value=options.value||{};var index=value.index;var rowControls;var isMulti=_this.tripType===4;if(isMulti)
            rowControls=_this.segmentRowsMulti[index].controls;else
            rowControls=_this.segmentRowRoundTrip.controls;switch(value.part){case'origin':rowControls['destination'].focus();break;case'destination':var ev=value.ev||{};if(ev.shiftKey)
            rowControls['origin'].focus();else
            rowControls['depart-date'].open();break;case'depart':if(_this.tripType===2&&index===0)
            rowControls['return-date'].open();else if(_this.tripType===4){var segRow=_this.segmentRowsMulti[index+1];if(!!segRow)
            segRow.controls['origin'].focus();}
            break;}}},this,false);};SearchFormFlight.prototype.formChanged=function(key,value){$ev.fire('control:flight-searchform-changed',{key:key,value:value});};SearchFormFlight.prototype.tripTypeChanged=function(tripType,userTriggered){this.setFormScope();if(userTriggered)
        this.formChanged('triptype',tripType);};SearchFormFlight.prototype.segmentChanged=function(segmentIndex,part,value,isMulti,triggeredByUser,ev){var segments=isMulti?this.model.SegmentsMulti:this.model.Segments;var segment=segments[segmentIndex];switch(part){case'origin':segment.Origin=value.Iata;break;case'destination':segment.Destination=value.Iata;break;case'depart':segment.Depart=value;break;}
        if(triggeredByUser){if(isMulti)
            this.checkDatesMulti(segmentIndex);else{this.checkDatesRoundTrip(segmentIndex);}
            this.formChanged('segment',{part:part,index:segmentIndex,segment:segment,ev:ev});}};SearchFormFlight.prototype.checkDatesRoundTrip=function(srcIndex){var segments=this.model.Segments;if(+segments[1].Depart<+segments[0].Depart){if(srcIndex===0){segments[1].Depart=new Date(segments[0].Depart+"");this.segmentRowRoundTrip.controls['return-date'].setDate(segments[1].Depart,this.tripType===2);}
    else{segments[0].Depart=new Date(segments[1].Depart+"");this.segmentRowRoundTrip.controls['depart-date'].setDate(segments[0].Depart);}}};SearchFormFlight.prototype.checkDatesMulti=function(srcIndex){var model=this.model;var segments=model.SegmentsMulti;var segmentRowsMulti=this.segmentRowsMulti;var dateControl=null;var d=Date,today=(new Date()).getDateOnly(),dates=segments.map(function(s){return s.Depart;}),d1=dates[0],d2,changed=false;if(d1<today){d1=today;dateControl=!!segmentRowsMulti&&!!segmentRowsMulti[0]?segmentRowsMulti[0].controls['depart-date']:null;if(!!dateControl)
        dateControl.setDate(d1);changed=true;}
        if(dates.length>1){for(var i=0,len=dates.length;i<len;i++){d2=dates[i+1];if(d2){if(d1>d2){changed=true;var index=srcIndex==i?i+1:i;var date=(srcIndex===i?d1:d2);segments[index].Depart=date;dateControl=!!segmentRowsMulti&&!!segmentRowsMulti[index]?segmentRowsMulti[index].controls['depart-date']:null;if(!!dateControl)
            dateControl.setDate(date);this.checkDatesMulti(index);break;}}
        else
            break;d1=d2;}}
        return changed;};SearchFormFlight.prototype.resolveSegmentIndex=function(element){var index=-1;switch(this.tripType){case 4:var row=element.closest('.inputs._multi').first();index=this.element.find('.inputs._multi').index(row);break;default:return 0;break;}
        return index;};SearchFormFlight.prototype.initSegmentRow=function(segment,row,segmentHome){var _this=this;if(segmentHome===void 0){segmentHome=null;}
        var isMulti=!segmentHome;var factory=this.factory;var dataService=this.dataService;var originCode=segment.Origin;var destinationCode=segment.Destination;var departDate=segment.Depart;var inputOrigin=row.find('.input._origin input');var inputDestination=row.find('.input._destination input');var inputDepart=row.find('.input._date-depart input').attr('id','');var buttonSwapAirports=row.find('.swap-route');var removeButton=row.find('.remove-trip');var rowControls={};removeButton.on('click',function(){_this.removeMultiSegment(row);});rowControls['origin']=factory.CreateCompleter(inputOrigin,"flights",dataService,Language["SearchForm.Flight.Watermark.Origin"],this.formatCityName,this.getCompleterItemFormatter(),null,function(ui,options){var item=options.item;var target=ui.target;var index=_this.resolveSegmentIndex(row);_this.segmentChanged(index,'origin',item,isMulti,true,ui);if(!!segmentHome)
            _this.segmentChanged(1,'destination',item,false,false,ui);});rowControls['destination']=factory.CreateCompleter(inputDestination,"flights",dataService,Language["SearchForm.Flight.Watermark.Destination"],this.formatCityName,this.getCompleterItemFormatter(),null,function(ui,options){var item=options.item;var target=ui.target;var index=_this.resolveSegmentIndex(row);_this.segmentChanged(index,'destination',item,isMulti,true,ui);if(!!segmentHome)
            _this.segmentChanged(1,'origin',item,false,false,ui);$ev.fire('control:flight-searchform-destination-changed',{key:options});});var calendarDepart=rowControls['depart-date']=this.factory.CreateCalendar(inputDepart,{minDate:new Date(),firstDay:1,date:departDate,onSelect:function(ui,data){var target=ui.target;var index=_this.resolveSegmentIndex(row);var day=data.selectedDay;var month=data.selectedMonth;var year=data.selectedYear;var date=new Date(year,month,day);_this.segmentChanged(index,'depart',date,isMulti,true,ui);ui.target.blur();},getHighlightDates:function(){var dates={};switch(_this.tripType){case 2:dates[+_this.model.Segments[1].Depart]={'class':'ui-datepicker-date-highlight-return',text:'Return date'};break;case 4:break;}
            return dates;}});if(!!segmentHome){var returnDate=segmentHome.Depart;var inputReturn=row.find('.input._date-return input');var calendarReturn=rowControls['return-date']=this.factory.CreateCalendar(inputReturn,{minDate:new Date(),firstDay:1,date:returnDate,onSelect:function(ui,data){var target=ui.target;var day=data.selectedDay;var month=data.selectedMonth;var year=data.selectedYear;var date=new Date(year,month,day,0,0,0,0);if(_this.tripType===1){_this.model.Segments[1].Depart=date;_this.setTripType(2,false);}
            $ev.fire("control:searchform-return-datechanged",{newDate:date});_this.segmentChanged(1,'depart',date,isMulti,true,ui);ui.target.blur();},clearable:true,onClear:function(){_this.setTripType(1,true);},getHighlightDates:function(){var dates={};dates[+_this.model.Segments[0].Depart]={'class':'ui-datepicker-date-highlight-depart',text:'Departure date'};return dates;}});if(this.tripType===1)
            calendarReturn.setCleared(true);}
        buttonSwapAirports.on('click',function(ev){var target=jQuery(ev.target);var index=_this.resolveSegmentIndex(jQuery(target));_this.swapAirports(index);});return{origin:originCode,destination:destinationCode,depart:departDate,element:row,controls:rowControls};};SearchFormFlight.prototype.doSwap=function(segment,segmentRow){if(segmentRow===void 0){segmentRow=null;}
        var origin=segment.Origin;var destination=segment.Destination;if(!origin||!destination)
            return;segment.Destination=origin;segment.Origin=destination;if(!!segmentRow){var completerOrigin=segmentRow.controls['origin'];var completerDestination=segmentRow.controls['destination'];var valueOrigin=completerOrigin.getText();var valueDestination=completerDestination.getText();completerOrigin.setText(valueDestination);completerDestination.setText(valueOrigin);}
        return this;};SearchFormFlight.prototype.swapAirports=function(index){switch(this.tripType){case 4:this.doSwap(this.model.SegmentsMulti[index],this.segmentRowsMulti[index]);break;default:this.doSwap(this.model.Segments[0],this.segmentRowRoundTrip).doSwap(this.model.Segments[1],null);break;}
        this.formChanged('segment',{part:'airport-swap',index:index});};SearchFormFlight.prototype.initSegmentsMulti=function(){var model=this.model;var segments=model.SegmentsMulti;var segmentDOMRows=[];var segRows=this.element.find('.inputs._multi');var rowTemplate=this.rowTemplate=segRows.first().clone();rowTemplate.find('.remove-trip').show();for(var i=0,len=segments.length;i<len;i++){var segment=segments[i];var origin=segment.Origin;var destination=segment.Destination;var depart=segment.Depart;var segRow=segRows.eq(i);if(!segRow)
        segRow=this.createSegmentRow();if(!!i){var removeTrip=segRow.find('.remove-trip');removeTrip.show();}
        segmentDOMRows.push(this.initSegmentRow(segment,segRow,null));}
        this.segmentRowsMulti=segmentDOMRows;this.element.find('.inputs._newtrip').on('click',this.addMultiSegment.bind(this));};SearchFormFlight.prototype.addMultiSegment=function(triggerFormScopeChange){if(triggerFormScopeChange===void 0){triggerFormScopeChange=true;}
        var model=this.model;var segments=model.SegmentsMulti;var segmentCount=segments.length;if(segmentCount>=this.maxSegmentCount)
            return;var lastSegment=segments[segmentCount-1];var rows=this.segmentRowsMulti;var lastRow=rows[segmentCount-1];var lastElement=jQuery(lastRow.element);var newSegment=jQuery.extend({},lastSegment);newSegment.Origin=newSegment.Destination;newSegment.Destination=null;var newRow=this.rowTemplate.clone();var newOriginText=lastElement.find('.input._destination input').val();newOriginText=newOriginText!==this.watermarkDestination?newOriginText:this.watermarkOrigin;newRow.find('.input._origin input').val(newOriginText);newRow.find('.input._destination input').val(this.watermarkDestination);rows.push(this.initSegmentRow(newSegment,newRow));newRow.insertAfter(lastElement);segments.push(newSegment);if(triggerFormScopeChange)
            this.setFormScope();};SearchFormFlight.prototype.removeMultiSegment=function(row,triggerFormScopeChange){if(triggerFormScopeChange===void 0){triggerFormScopeChange=true;}
        var index=this.element.find('.inputs._multi').index(row);var model=this.model;var segments=model.SegmentsMulti;var rows=this.segmentRowsMulti;segments.splice(index,1);rows.splice(index,1);row.remove();if(triggerFormScopeChange)
            this.setFormScope();};SearchFormFlight.prototype.createSegmentRow=function(){var domelement=null;return domelement;};SearchFormFlight.prototype.setFormScope=function(){var tripType=this.tripType;switch(tripType){case 1:case 2:this.parentSearchBox.removeClass('mui-searchbox-flights-multi _1 _2 _3 _4');break;case 4:this.parentSearchBox.removeClass(' _1 _2 _3 _4').addClass('mui-searchbox-flights-multi _'+this.model.SegmentsMulti.length);break;}
        this.setSegmentVisibility();};SearchFormFlight.prototype.setSegmentVisibility=function(){var hideElement=function(e){e.hide();};var showElement=function(e){e.show();};var element=this.element;var segmentRowRoundtrip=[this.segmentRowRoundTrip.element];var segmentRowsMulti=jQuery.map(this.segmentRowsMulti,function(row){return row.element;});var segmentRowMultiNew=[element.find('.inputs._newtrip').first()];var setVisibility=function(elements,func){if(!!elements.each)
        elements.each(func);else{for(var i=0,e;e=elements[i];i++){func(e);}}};switch(this.tripType){case 4:setVisibility(segmentRowRoundtrip,hideElement);setVisibility(segmentRowsMulti,showElement);if(this.model.SegmentsMulti.length<this.maxSegmentCount)
        setVisibility(segmentRowMultiNew,showElement);else
        setVisibility(segmentRowMultiNew,hideElement);break;default:setVisibility(segmentRowRoundtrip,showElement);setVisibility(segmentRowsMulti,hideElement);setVisibility(segmentRowMultiNew,hideElement);break;}};SearchFormFlight.prototype.setCurrency=function(currencyCode){this.currencyCode=currencyCode;};SearchFormFlight.prototype.onClose=function(){this.parentSearchBox.removeClass(' ');};SearchFormFlight.prototype.getTripType=function(){var model=this.model;var segments=model.Segments;var tripType=0;switch(true){case segments.length===1:tripType=1;break;case segments.length===0||(segments.length===2&&segments[0].Origin===segments[1].Destination&&segments[1].Origin===segments[0].Destination):tripType=2;break;default:tripType=4;break;}
        return tripType;};SearchFormFlight.prototype.getCompleterItemFormatter=function(){var _this=this;var parentItemClass='ui-geolocate-item-parent';var childItemClass='ui-geolocate-item-child';function escapeRegExp(str){return typeof str!=='undefined'?str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"):'';}
        var formatCompleterItem=function(ul,item){var term=this.term.split(' ').join('|'),isChild=item.IsChild,re=new RegExp('('+escapeRegExp(term)+')','gi'),hl='<span class="highlight">$1</span>',stateName=item.StateName,countryName=(!!stateName?stateName+', ':'')+item.CountryName,cityName=(item.MainCityCode==item.Iata)?item.MainCityName:(item.MainCityName==item.Name)?item.Name:item.MainCityName+", "+item.Name,label=jQuery('<div>',{'class':'label'}),labelName=jQuery('<div>',{'class':'name'}).append(cityName.replace(re,hl)).appendTo(label),labelPlaceName=jQuery('<div>',{'class':'place-name'}).append(countryName.replace(re,hl)).appendTo(label),labelIata=jQuery('<div>',{'class':'iata'}).append(item.Iata.slice(0,3).replace(re,hl)).appendTo(label),icon=jQuery('<div>',{'class':'icon'});item.displayName=function(){return _this.formatCityName(item);};var cssClass='ui-geolocate-item';if(item.IsParent)
            cssClass+=' '+parentItemClass;else if(item.IsChild)
            cssClass+=' '+childItemClass;return jQuery('<li>',{'class':cssClass}).data('ui-autocomplete-item',item).append(icon).append(label).appendTo(ul);};this.getCompleterItemFormatter=function(){return formatCompleterItem;};return this.getCompleterItemFormatter();};SearchFormFlight.prototype.formatCityName=function(city){var iata=city.Iata;var isMainCity=iata===city.MainCityCode;var stateName=city.StateName;stateName=!stateName?"":", "+stateName;var airportName=isMainCity?"":", "+city.Name;return String.format("{1}{2} ({0}){3}, {4}",iata.slice(0,3),city.MainCityName,airportName,stateName,city.CountryName);};SearchFormFlight.prototype.buildSearchUrl=function(){var model=this.model;var tripType=this.tripType;var segments=[];segments.push.apply(segments,(tripType!==4)?model.Segments:model.SegmentsMulti);if(tripType===1)
        segments.length=1;var adultCount=model.AdultCount;var childAges=model.ChildAges||[];var directOnly=model.DirectOnly;var includeNearby=model.IncludeNearby;var ticketClass=model.TicketClass;var result='Search=true&TripType='+tripType;var len=segments.length;result+='&SegNo='+len;for(var i=0;i<len;i++){var segment=segments[i];result+='&SO'+i+'='+segment.Origin;result+='&SD'+i+'='+segment.Destination;var depart=segment.Depart;if(typeof depart==='string'&&depart.length){depart=new Date(depart);}
        depart=!!depart?depart.toMomondoDate():'';result+='&SDP'+i+'='+depart;}
        result+='&AD='+adultCount;if(childAges.length>0)
            result+='&CA='+childAges.join(',');if(ticketClass)
            result+='&TK='+ticketClass;if(tripType==2||tripType==1)
            result+='&DO='+(!!directOnly?'true':'false');result+='&NA='+(includeNearby?'true':'false');return result;};SearchFormFlight.prototype.isValid=function(onPendingAction){if(onPendingAction===void 0){onPendingAction=function(){};}
        var errorCnt=0;var pendingCount=0;var model=this.model;var validateCompleter=function(completer,value,toolTip){if(completer.pending(function(){pendingCount--;if(pendingCount===0){onPendingAction();}})){pendingCount++;}
        else if(!value){errorCnt++;completer.validated(false,toolTip);}};switch(this.tripType){case 1:if(model.Segments[0].Depart.constructor!=Date||model.Segments[0].Depart==null){errorCnt++;this.segmentRowRoundTrip.controls['depart-date'].validated(false,Language["HotelSearchForm.InvalidDate"]);}
            validateCompleter(this.segmentRowRoundTrip.controls['origin'],model.Segments[0].Origin,Language["HotelSearchForm.InvalidCity"]);validateCompleter(this.segmentRowRoundTrip.controls['destination'],model.Segments[0].Destination,Language["HotelSearchForm.InvalidCity"]);break;case 2:for(var i=0,segment;segment=model.Segments[i];i++){if(segment.Depart.constructor!=Date||segment.Depart==null){errorCnt++;this.segmentRowRoundTrip.controls[i===0?'depart-date':'return-date'].validated(false,Language["HotelSearchForm.InvalidDate"]);}
            if(i===0){validateCompleter(this.segmentRowRoundTrip.controls['origin'],segment.Origin,Language["HotelSearchForm.InvalidCity"]);validateCompleter(this.segmentRowRoundTrip.controls['destination'],segment.Destination,Language["HotelSearchForm.InvalidCity"]);}}
            break;case 4:for(var i=0,segment;segment=model.SegmentsMulti[i];i++){if(segment.Depart.constructor!=Date||segment.Depart==null){errorCnt++;this.segmentRowsMulti[i].controls['depart-date'].validated(false,Language["HotelSearchForm.InvalidDate"]);}
            validateCompleter(this.segmentRowsMulti[i].controls['origin'],segment.Origin,Language["HotelSearchForm.InvalidCity"]);validateCompleter(this.segmentRowsMulti[i].controls['destination'],segment.Destination,Language["HotelSearchForm.InvalidCity"]);}
            break;}
        var validationResult={isValid:errorCnt==0,isPending:pendingCount>0};return validationResult;};SearchFormFlight.prototype.setValid=function(value){this.UIValid=value;};SearchFormFlight.prototype.getValid=function(){return this.UIValid;};SearchFormFlight.prototype.getTimespan=function(){var model=this.model;var segments=this.tripType===4?model.SegmentsMulti:model.Segments;return{start:segments[0].Depart,end:!!segments[1]?segments[1].Depart:null};};SearchFormFlight.prototype.setTimespan=function(timespan){var model=this.model;var segments=this.tripType===4?model.SegmentsMulti:model.Segments;if(!!timespan.start)
        segments[0].Depart=timespan.start;if(!!timespan.end&&!!segments[1])
        segments[1].Depart=timespan.end;if(this.tripType===4)
        this.checkDatesMulti(0);this.setValid(false);};SearchFormFlight.prototype.getSegments=function(){return this.tripType===4?this.model.SegmentsMulti:this.model.Segments;};SearchFormFlight.prototype.getDestination=function(){var segments=this.getSegments();return{key:segments[0].Destination.slice(0,3),type:1};};SearchFormFlight.prototype.setDestination=function(code){var _this=this;var onload=function(city){var cityName=_this.formatCityName(city);var segments=_this.model.Segments;var segmentsMulti=_this.model.SegmentsMulti;var segments=_this.getSegments();var destination=code;segments[0].Destination=destination;!!segments[1]?segments[1].Origin=destination:null;var segmentRows=_this.tripType===4?_this.segmentRowsMulti:[_this.segmentRowRoundTrip];segmentRows[0].controls['destination'].setText(cityName);if(segmentRows.length>1)
        segmentRows[1].controls['origin'].setText(cityName);};var onError=function(){};this.dataService.GetCityByKey(code,onload,onError);};SearchFormFlight.prototype.getPax=function(){var model=this.model,adultCount=model.AdultCount,childAges=model.ChildAges||[];return{adultCount:adultCount,childAges:childAges};};SearchFormFlight.prototype.setPax=function(adultCount,childAges){var model=this.model;var maxAdultCount=9;var maxChildCount=7;model.AdultCount=Math.min(Math.max(adultCount,1),9);model.ChildAges=!!childAges&&!!childAges.length?childAges.slice(0,maxChildCount):[];this.setValid(false);};SearchFormFlight.prototype.persistModel=function(){var model=this.model;var adultCount=model.AdultCount;var childAges=model.ChildAges;var directOnly=model.DirectOnly;var includeNearby=model.IncludeNearby;var tripType=this.tripType;var segments=tripType===4?model.SegmentsMulti:model.Segments.slice(0,(tripType===1?1:2));var ticketClass=model.TicketClass;var modelData=[];for(var i=0;i<segments.length;i++){var segment=segments[i];var departDate=segment.Depart;var dateString=departDate.getDate()+'-'+(departDate.getMonth()+1)+'-'+departDate.getFullYear();modelData.push('seg-'+i+'='+segment.Origin+':'+segment.Destination+':'+dateString);}
        modelData.push('adultCount='+adultCount);if(!!childAges&&!!childAges.length)
            modelData.push('childAges='+childAges.join(','));modelData.push('ticketClass='+ticketClass);modelData.push('timestamp='+new Date().toISOString());modelData.push('directOnly='+directOnly);modelData.push('includeNearby='+includeNearby);this.dataService.PersistModel(modelData);};SearchFormFlight.prototype.startSearch=function(newWindow){var _this=this;var validationResult=this.isValid(function(){setTimeout(function(){_this.startSearch(newWindow);},0);});if(!validationResult.isValid||validationResult.isPending){this.pendingSearchIntent=validationResult.isPending;return;}
        this.persistModel();var searchString=this.buildSearchUrl();switch(this.searchBehavior){case 0:var searchUrl=this.model.SearchBasePath+'/?'+searchString;searchUrl=searchUrl.replace("http://","[http]").replace("//","/").replace("[http]","http://");if(newWindow)
            window.open(searchUrl);else
            window.location.href=searchUrl;break;case 1:var model=this.model;var tripType=this.tripType;window.location.hash=searchString;$ev.fire('control:flightsearch-start',{tripType:this.tripType,model:this.model});break;}};SearchFormFlight.prototype.searchByHash=function(){var preModel=this.model;var hashString=window.location.hash.toUpperCase();var queryModel=this.getModelByQuery(hashString);var segments=queryModel.segments;var tripType=queryModel.getTripType();var segmentCount=segments.length;if(tripType!=this.tripType)
        this.setTripType(tripType,true);switch(tripType){case 1:break;case 2:break;case 4:var preSegmentCount=preModel.SegmentsMulti.length;if(segmentCount!==preModel.SegmentsMulti.length){var i=segmentCount;if(i<preSegmentCount){var rows=this.segmentRowsMulti;while(i++<preSegmentCount){this.removeMultiSegment(rows[rows.length-1].element,i===preSegmentCount);}}
    else if(i>preSegmentCount){while(i-->preSegmentCount){this.addMultiSegment(i===preSegmentCount);}}}
        break;}
        switch(true){case tripType===2:var modelSegmentHomebound=this.model.Segments[1];var segmentRoundTrip=this.segmentRowRoundTrip;var querySegmentHomebound=segments[1];var returnDate=querySegmentHomebound.Depart;modelSegmentHomebound.Origin=querySegmentHomebound.Origin;modelSegmentHomebound.Destination=querySegmentHomebound.Destination;modelSegmentHomebound.Depart=returnDate;var calendarReturn=segmentRoundTrip.controls['return-date'];calendarReturn.setDate(returnDate);case tripType===1:var modelSegmentOutbound=this.model.Segments[0];var querySegmentOutbound=segments[0];var segmentRoundTrip=this.segmentRowRoundTrip;var originCompleter=segmentRoundTrip.controls['origin'];var destinationCompleter=segmentRoundTrip.controls['destination'];var calendarDepart=segmentRoundTrip.controls['depart-date'];modelSegmentOutbound.Origin=querySegmentOutbound.Origin;modelSegmentOutbound.Destination=querySegmentOutbound.Destination;modelSegmentOutbound.Depart=querySegmentOutbound.Depart;calendarDepart.setDate(querySegmentOutbound.Depart);originCompleter.loadCity(querySegmentOutbound.Origin,function(){},function(){});destinationCompleter.loadCity(querySegmentOutbound.Destination);break;case tripType===4:var segmentRows=this.segmentRowsMulti;var modelSegments=this.model.SegmentsMulti;for(var i=0,len=segments.length;i<len;i++){var segment=segments[i];var originCode=segment.Origin;var destinationCode=segment.Destination;var departDate=segment.Depart;var modelSegment=modelSegments[i]||(modelSegments[i]={Origin:'',Destination:'',Depart:new Date()});modelSegment.Origin=originCode;modelSegment.Destination=destinationCode;modelSegment.Depart=departDate;var segmentRow=segmentRows[i];var controls=segmentRow.controls;var originCompleter=controls['origin'];var destinationCompleter=controls['destination'];var departCalendar=controls['depart-date'];originCompleter.loadCity(originCode);destinationCompleter.loadCity(destinationCode);departCalendar.setDate(departDate);}
            break;}
        var ticketClass=this.model.TicketClass=queryModel.ticketClass;this.selectTicketClass.setValue(ticketClass);var directOnly=this.model.DirectOnly=queryModel.directOnly;this.chkDirect.prop('checked',directOnly?'checked':null);var includeNearby=this.model.IncludeNearby=queryModel.includeNearby;this.chkNearby.prop('checked',includeNearby?'checked':null);this.model.AdultCount=queryModel.adults||1;this.model.ChildAges=queryModel.childAges||[];this.initPaxSelector(tripType);this.startSearch(false);};SearchFormFlight.prototype.getModelByQuery=function(queryString){if(!queryString)
        return null;queryString=queryString.replace(/^\?|^\#/,'');var members=queryString.split(/\&/);if(members.length===0)
        return null;var query={};for(var i=0,len=members.length;i<len;i++){var member=members[i].split('=');query[member[0]]=member[1]||'';}
        var prfxOrigin='SO';var prfxDestination='SD';var prfxDepart='SDP';var segments=[];var i=0;while(true){var origin=query[prfxOrigin+i];var destination=query[prfxDestination+i];if(!origin||!destination)
            break;var depart=query[prfxDepart+i]||'';var aDate=depart.split('-');depart=aDate.length===3?new Date(parseInt(aDate[2],10),parseInt(aDate[1],10)-1,parseInt(aDate[0],10),12):new Date();segments.push({Origin:origin,Destination:destination,Depart:depart});i++;}
        var adultCount=parseInt(query['AD'],10)||1;var childAges=!!query['CA']?query['CA'].split(','):[];var ticketClass=query['TK']||'ECO';var directOnly=query['DO']==='TRUE'?true:false;var includeNearby=query['NA']==='TRUE'?true:false;var i=childAges.length;while(i--){var age=childAges[i]=parseInt(childAges[i],10);if(isNaN(age))
            childAges.splice(i,1);}
        var model={segments:segments,ticketClass:ticketClass,adults:adultCount,childAges:childAges,directOnly:directOnly,includeNearby:includeNearby,getTripType:function(){var model=this.model;var tripType=2;var segments=this.segments;var segmentCount=segments.length;switch(true){case segmentCount===1:tripType=1;break;case segmentCount===2:var segment1=segments[0];var segment2=segments[1];if(segment1.Origin===segment2.Destination&&segment1.Destination===segment2.Origin){tripType=2;break;}
            case segmentCount>2:tripType=4;break;}
            return(this.getTripType=function(){return tripType;})();}};return model;};return SearchFormFlight;})();SearchForm.SearchFormFlight=SearchFormFlight;var Airport=(function(){function Airport(Code,Type){this.Code=Code;this.Type=Type;this.toString=function(){return this.Code;};}
    return Airport;})();SearchForm.Airport=Airport;})(SearchForm||(SearchForm={}));(function(factory){factory(jQuery);}(function($){return $.widget('mui.guestlist',{version:'0.1',defaultElement:'<div>',options:{disabled:null,label:{room:'Room',newRoom:'Add another room',header:{room:'',adults:'Adults',children:'Children',childrenAge:'Age of children'},ok:'OK',cancel:'Cancel'},rooms:'1:',minRooms:1,maxRooms:null,minAdults:0,maxAdults:10,minChildren:0,maxChildren:4,minChildAge:0,maxChildAge:14},_create:function(){var that=this,guestlistId=this.element.uniqueId().attr('id');this.totalRooms=0;this.ids={wrap:'ui-guestlist-'+guestlistId,room:'ui-guestlist-'+guestlistId+'-room'};this.wrap=$('<div>',{'class':'ui-guestlist','id':this.ids.wrap});this._drawRoomsList();this.wrap.appendTo(this.element);},_drawAddRoom:function(){var that=this;this.addNewRoom=$('<a>',{'class':'ui-guestlist-newroom'}).on('click',function(event){that._addRoom();event.preventDefault();});this.addNewRoomLabel=$('<span>',{'class':'label','text':this.options.label.newRoom}).appendTo(this.addNewRoom);this.addNewRoom.appendTo(this.wrap);},_parseRooms:function(){var that=this,rooms=this.options.rooms.split(',').filter(function(n){return(n==='')?false:n;}),data={0:{'adults':0,'children':0}};var minChildAge=this.options.minChildAge;var maxChildAge=this.options.maxChildAge;var minChildren=this.options.minChildren;for(var i=0;i<rooms.length;i++){var guests=rooms[i].split(':'),adults=guests[0],children=minChildren;this.totalRooms++;data[i]={};data[i].adults=parseInt(adults);if(guests[1]!==undefined){children=guests[1].split('-').filter(function(n){return!isNaN(that._validateInt(n,minChildAge,maxChildAge));});data[i].children=children.length;data[i].childrenAge={0:minChildAge,1:minChildAge,2:minChildAge,3:minChildAge};if(children.length>0){for(var j=0;j<children.length;j++){data[i].childrenAge[j]=parseInt(children[j]);}}}}
    return data;},_drawRooms:function(){var roomData=this._parseRooms(),totalRooms=this.totalRooms;for(var i=0;i<totalRooms;i++){this._drawRoom(i,roomData[i]).appendTo(this.roomList);}
    this._refreshRooms();},_drawRoomsList:function(){this.wrap.empty();var listHeader=$('<div>',{'class':'ui-guestlist-header'}),listHeaderRoom=$('<div>',{'class':'room','text':this.options.label.header.room}).appendTo(listHeader),listHeaderAdults=$('<div>',{'class':'adults','text':this.options.label.header.adults}).appendTo(listHeader),listHeaderChildren=$('<div>',{'class':'children','text':this.options.label.header.children}).appendTo(listHeader),listHeaderChildrenAge=$('<div>',{'class':'children-age','text':this.options.label.header.childrenAge}).appendTo(listHeader);listHeader.appendTo(this.wrap);this.roomList=$('<div>',{'class':'ui-guestlist-rooms'}).appendTo(this.wrap);this._drawAddRoom();this._drawRooms();},_validateInt:function(val,min,max){var parsedVal=parseInt(val);if(parsedVal<min||parsedVal>max){return min;}
    return parsedVal;},_drawRoom:function(id,roomData){var that=this,numId=id,id=this.ids.room+id,roomWrap=$('<div>',{'class':'ui-guestlist-room','id':id}),container=$('<div>',{'class':'container'}).appendTo(roomWrap),room=$('<div>',{'class':'room'}).appendTo(container),roomContainer=$('<div>',{'class':'container'}).appendTo(room),roomLabel=$('<div>',{'class':'label','text':this._roomLabelString(numId)}).appendTo(roomContainer),removeRoom=$('<div>',{'class':'remove-room'}).appendTo(roomContainer).on('click',function(event){that.totalRooms--;roomWrap.remove();that._refreshRooms();}),adults=$('<div>',{'class':'adults'}).appendTo(container),children=$('<div>',{'class':'children'}).appendTo(container),childrenAge=$('<div>',{'class':'children-age'}).appendTo(container),adultsInput=this._renderInputSelect(id+'-adults',this.options.minAdults,this.options.maxAdults,roomData.adults,false).appendTo(adults),childrenInput=this._renderInputSelect(id+'-children',this.options.minChildren,this.options.maxChildren,roomData.children,false).appendTo(children);for(var i=0;i<4;i++){var childAge=$('<div>',{'class':'child-age'}),childAgeInput=this._renderInputSelect(id+'-childage'+i,this.options.minChildAge,this.options.maxChildAge,roomData.childrenAge[i],(i<roomData.children)?false:true).appendTo(childAge);childAge.appendTo(childrenAge);childAgeInput.selectbox({change:function(event,ui){that._updateRoomData(roomWrap);}});}
    adultsInput.selectbox({change:function(event,ui){that._updateRoomData(roomWrap);}});childrenInput.selectbox({change:function(event,ui){var val=ui.item.value,parent=$(this).parents('.ui-guestlist-room');parent.find('.children-age .child-age select').selectbox('option','disabled',true);parent.find('.children-age .child-age:nth-child(-n+'+val+') select').selectbox('option','disabled',false);that._updateRoomData(roomWrap);}});that._updateRoomData(roomWrap);return roomWrap;},_addRoom:function(){if((this.options.maxRooms!==undefined&&this.options.maxRooms==this.totalRooms)){return;}
    var roomData={'adults':0,'children':0,'childrenAge':{0:0,1:0,2:0,3:0}};this._drawRoom(this.totalRooms,roomData).appendTo(this.roomList);this.totalRooms++;this._refreshRooms();},_renderInputSelect:function(id,min,max,value,disabled){var select=$('<select>',{'id':id,'disabled':disabled});for(var i=min;i<=max;i++){var option=$('<option>',{'value':i,'text':i});if(value==i){option.attr('selected',true);}
    option.appendTo(select);}
    return select;},_roomLabelString:function(i){return this.options.label.room+' '+i;},_refreshRooms:function(){if(this.totalRooms==1){$(this.roomList.find('.ui-guestlist-room .remove-room').get(0)).hide();}else{$(this.roomList.find('.ui-guestlist-room .remove-room').get(0)).show();}
    this.wrap.toggleClass('ui-guestlist-nonew',(this.options.maxRooms!==undefined&&this.options.maxRooms==this.totalRooms));this._updateLabels();this._setRoomsData();},_updateLabels:function(){var that=this;this.roomList.find('.ui-guestlist-room .room .label').each(function(index){$(this).html(that._roomLabelString(index+1));});},_updateRoomData:function(roomWrap){var data={},adults=parseInt(roomWrap.find('.adults select').val()),children=parseInt(roomWrap.find('.children select').val());data.adults=adults;data.children=children;data.childrenAge={};for(var i=0;i<children;i++){data.childrenAge[i]=parseInt(roomWrap.find('.children-age .child-age:nth-child('+(i+1)+') select').val());}
    roomWrap.data('room',data);this._setRoomsData();},_setRoomsData:function(){var data={};this.roomList.find('.ui-guestlist-room').each(function(index){data[index]=$(this).data('room');});this.wrap.data('rooms',data);},_getRoomsJSON:function(){return this.wrap.data('rooms');},getRoomsString:function(){var rooms=this._getRoomsJSON(),string='';for(var room in rooms){var adults=rooms[room].adults,children=rooms[room].children,childrenAge=rooms[room].childrenAge;if(adults!==0||children!==0){string+=adults;string+=':';if(children!==0){for(var childAge in childrenAge){string+=childrenAge[childAge];string+='-';}
    string=string.substring(0,string.length-1);}
    string+=',';}}
    return string.substring(0,string.length-1);}});}));var SearchForm;(function(SearchForm){'use strict';var SearchFormHotel=(function(){function SearchFormHotel(name,element,factory,dataService,textManager,model,currencyCode,getParentSearchIntent){this.name=name;this.element=element;this.factory=factory;this.dataService=dataService;this.textManager=textManager;this.model=model;this.currencyCode=currencyCode;this.getParentSearchIntent=getParentSearchIntent;this.pendingSearchIntent=false;this.UIValid=true;this.buildRoomDistribution=function(rooms){var r=null;var roomNumber=1;var components=[];var adults=0;var childAges=[];for(var i=0,r;r=rooms[i];i++){adults=r.AdultCount;childAges=r.ChildAges||[];components.push((adults||0)+(childAges&&childAges.length?('-'+childAges.join('-')):''));}
    return components.join(',');};this.buildRoomDistribution_DEPRECATED=function(rooms){var r=null;var roomNumber=1;var components=[];var adults=0;var childAges=[];var format='{0}_{1}={2}';for(var i=0,r;r=rooms[i];i++){roomNumber=i+1;adults=r.AdultCount;childAges=r.ChildAges;if(!!adults)
    components.push(String.format(format,'adults',roomNumber.toString(),adults.toString()));if(!!childAges&&!!childAges.length)
    components.push(String.format(format,'childAges',roomNumber.toString(),encodeURIComponent(childAges.join(','))));}
    return components.join('&');};this.sanitizeModel(this.model);}
    SearchFormHotel.prototype.sanitizeModel=function(model){var matchUTC=/^\d{4}-\d{1,2}-\d{1,2}T\d{1,2}:\d{1,2}:\d{1,2}/;var getDateFromUTCString=function(str){var result=null;var match=matchUTC.exec(str);if(!!match&&!!match.length)
        result=Date.fromISO(match[0]);else
        result=new Date();return result;};model.CheckIn=getDateFromUTCString(model.CheckIn);model.CheckOut=getDateFromUTCString(model.CheckOut);model.Today=getDateFromUTCString(model.Today);this.searchBehavior=this.model.SearchBehavior;};SearchFormHotel.prototype.getSearchIntent=function(){return this.getParentSearchIntent()||this.pendingSearchIntent;};SearchFormHotel.prototype.persistModel=function(){var model=this.model;var location=model.Location;var locationKey=location.Key;var anyTime=this.model.AnyTime;var cityName=location.DisplayName||location.Name;var cityKey=location.Key;var checkIn=HotelUtils.formatDate(model.CheckIn).replace(/-/g,"");var checkOut=HotelUtils.formatDate(model.CheckOut).replace(/-/g,"");if(!cityName||!cityKey)
        return false;var modelData=[cityName,cityKey,checkIn,checkOut,this._getPax(),new Date().toISOString(),anyTime];this.dataService.PersistModel(modelData);};SearchFormHotel.prototype.formChanged=function(key,value){$ev.fire('control:hotel-searchform-changed',{key:key,value:value});};SearchFormHotel.prototype.locationChanged=function(item){var key=item.key;var name=item.name;var countryName=item.country;var countryCode=item.countryCode;var location=this.model.Location={Key:item.key,Name:item.name,Country:item.place.join(', '),CountryCode:item.countryCode,HotelCount:item.hotelCount,DisplayName:item.displayName(),Overview:!item.searchable};$ev.fire('control:hotel-searchform-destination-changed',{location:location});this.formChanged('location',location);};SearchFormHotel.prototype.toggleAnyTime=function(on){var disabled=on;this.selectGuests.setDisabled(on);this.calendarCheckIn.setCleared(on);this.calendarCheckOut.setCleared(on);if(!on){this.calendarCheckIn.setDate(this.model.CheckIn);this.calendarCheckOut.setDate(this.model.CheckOut);}
        jQuery(this.chkAnytime).find(":checkbox").prop("checked",on);this.model.AnyTime=on;this.formChanged('anytime',on);};SearchFormHotel.prototype.updateGuestListSelectedValue=function(){var guestList=this.selectGuests.element;var pax=this._getPax();guestList.val(pax);if(!guestList.val()){var result=this.decodePax(pax);var textManager=this.textManager;var adultCount=parseInt(result[1].toString(),10);var childCount=parseInt(result[2].toString(),10);var roomCount=parseInt(result[3].toString(),10);var guests=String.format('{0}, {1}',String.format(textManager.getTranslation("General.Pax.Adult",adultCount),adultCount.toString()),String.format(textManager.getTranslation("General.Pax.Child",childCount),childCount.toString()));var label=String.format(textManager.getTranslation("General.Pax.PaxInRoom",roomCount),guests,roomCount.toString());this.insertAtIndex(guestList,5,"<option value='"+pax+"'>"+label+"</option > ");guestList.val(pax);guestList.selectmenu("instance").refresh();}};SearchFormHotel.prototype.updateDateValues=function(){var model=this.model;var checkInDate=model.CheckIn;var checkOutDate=model.CheckOut;try{if(!this.model.AnyTime&&!!checkInDate&&!!checkOutDate){this.calendarCheckIn.setDate(checkInDate);this.calendarCheckOut.setDate(checkOutDate);this.toggleAnyTime(false);}
    else{this.toggleAnyTime(true);}}
    catch(ex){}};SearchFormHotel.prototype.updateLocationValue=function(){var model=this.model;var location=model.Location;var displayName=location.DisplayName;if(!!displayName)
        this.cityCompleter.setText(displayName);else if(!!location.Key)
        this.setDestination(location.Key);};SearchFormHotel.prototype.updateUI=function(){this.updateDateValues();this.updateLocationValue();this.updateGuestListSelectedValue();this.setValid(true);};SearchFormHotel.prototype.setModel=function(_model){var model=this.model;var location=_model.Location;if(!model.Location||(location.Key&&model.Location.Key!=location.Key)){model.Location={Key:location.Key,Name:location.Name||'',Country:location.Country||'',CountryCode:location.CountryCode||'',DisplayName:location.DisplayName||'',HotelCount:location.HotelCount||-1,Overview:false};}
        model.CheckIn=_model.CheckIn||null;model.CheckOut=_model.CheckOut||null;model.Rooms=_model.Rooms||null;model.AnyTime=!_model.CheckIn||!_model.CheckOut;this.updateUI();};SearchFormHotel.prototype.validateDates=function(source){var model=this.model;var checkInDate=model.CheckIn;var checkOutDate=model.CheckOut;var today=model.Today;if(+checkInDate>=+checkOutDate){if(source=='check-in'){var newDate=new Date(model.CheckIn+"");newDate.setDate(newDate.getDate()+1);model.CheckOut=newDate;}
    else if(source=='check-out'){model.CheckIn=new Date(model.CheckOut+"");var newDate=new Date(model.CheckIn+"");newDate.setDate(newDate.getDate()-1);if(newDate<today){var days=Math.round((+today-(+newDate))/86400000);newDate.setDate(newDate.getDate()+days);model.CheckOut.setDate(checkOutDate.getDate()+days);}
        model.CheckIn=newDate;}
        this.updateUI();}};SearchFormHotel.prototype.dateChanged=function(type,date){var dateIdentifier='';var model=this.model;switch(type){case'check-in':model.CheckIn=date;break;case'check-out':model.CheckOut=date;break;}
        this.validateDates(type);this.formChanged(type,date);};SearchFormHotel.prototype.checkInDateSelected=function(date){this.dateChanged('check-in',date);};SearchFormHotel.prototype.checkOutDateSelected=function(date){this.dateChanged('check-out',date);};SearchFormHotel.prototype.insertAtIndex=function(container,index,element){if(container.children().length>6)
        jQuery(container.children()[5]).remove();var lastIndex=jQuery(container.children()).size();if(index<0){index=0;}
        container.append(element);if(index<lastIndex){container.children().eq(index).before(container.children().last());}};SearchFormHotel.prototype.initForm=function(){var _this=this;var element=this.element;var inputCity=element.find('.input._where input');var inputDates=element.find('.input._dates .input');var inputCheckIn=inputDates.filter('._date-depart').find('input');var inputCheckOut=inputDates.filter('._date-return').find('input');var guestList=element.find('._guests select');var model=this.model;this.calendarCheckIn=this.factory.CreateCalendar(inputCheckIn,{minDate:new Date(),firstDay:1,date:model.CheckIn,clearable:true,onClear:function(){if(model.AnyTime===false)
        _this.toggleAnyTime(true);},onSelect:function(event,data){var day=data.selectedDay;var month=data.selectedMonth;var year=data.selectedYear;var date=new Date(year,month,day);_this.checkInDateSelected(date);inputCheckIn.blur();if(model.AnyTime===true)
        _this.toggleAnyTime(false);},getHighlightDates:function(){var dates={};dates[+_this.model.CheckOut]={'class':'ui-datepicker-date-highlight-return',text:'Check out date'};return dates;}});$ev.observe('control:hotel-searchform-changed',function(options){if(_this.getSearchIntent())
        return;switch(options.key){case'location':if(_this.model.AnyTime===false){_this.calendarCheckIn.open();}
        break;case'check-in':_this.calendarCheckOut.open();break;case'check-out':break;}},this,true);this.calendarCheckOut=this.factory.CreateCalendar(inputCheckOut,{minDate:new Date(),firstDay:1,date:model.CheckOut,clearable:true,onClear:function(){if(model.AnyTime===false)
        _this.toggleAnyTime(true);},onSelect:function(event,data){var day=data.selectedDay;var month=data.selectedMonth;var year=data.selectedYear;var date=new Date(year,month,day);_this.checkOutDateSelected(date);inputCheckOut.blur();if(model.AnyTime===true)
        _this.toggleAnyTime(false);},getHighlightDates:function(){var dates={};dates[+_this.model.CheckIn]={'class':'ui-datepicker-date-highlight-depart',text:'Check in date'};return dates;}});this.cityCompleter=this.factory.CreateCompleter(inputCity,"hotels",this.dataService,Language["HotelSearchForm.CityCompleter.Watermark"],function(item){return'TODO: Implement hotel city display name formatter';},this.formatCompleterItem,null,function(ev,options){var item=!!options?options.item:{};_this.locationChanged(item);});var openExtendedGuestList=function(pax){var _pax=(pax)?pax:'2:0,2:0';_this.guestListExt=_this.factory.CreateGuestList(element,_pax,function(rooms){var result=_this.decodePax(rooms);model.Rooms=result[0];_this.updateGuestListSelectedValue();_this.formChanged('pax',model.Rooms);},function(){_this.updateGuestListSelectedValue();});};var guestListChanged=function(value){var showExtended=(value==='0');if(showExtended)
        openExtendedGuestList(_this._getPax());else{var config=guestList.val();model.Rooms=[];switch(config){case"1-1":model.Rooms=[{AdultCount:1,ChildAges:null}];break;case"2-1":model.Rooms=[{AdultCount:2,ChildAges:null}];break;case"3-1":model.Rooms=[{AdultCount:3,ChildAges:null}];break;case"4-1":model.Rooms=[{AdultCount:4,ChildAges:null}];break;case"2-2":model.Rooms=[{AdultCount:1,ChildAges:null},{AdultCount:1,ChildAges:null}];break;default:model.Rooms=_this.decodePax(config)[0];break;}
        _this.formChanged('pax',model.Rooms);}};var onChange=function(value){guestListChanged(value);};this.selectGuests=this.factory.CreateSelectBox(guestList,false,onChange);this.updateGuestListSelectedValue();var options=element.find('.options');this.chkAnytime=options.children('._anytime');this.chkAnytime.change(function(ev){_this.toggleAnyTime(ev.target.checked);});var anyTime=model.AnyTime;if(anyTime){setTimeout(function(){_this.toggleAnyTime(true);},20);}
        $(document).on('momondo:currencyChanged',function(event){_this.currencyCode=event.memo.currencyCode;});this.initForm=function(){if(!_this.getValid()){_this.validateDates('check-in');_this.updateUI();}};$ev.observe('Momondo.Hotels.StateChanged',function(data){var model=!!data?data.model:null;if(!!model)
            _this.setModel(model);});$ev.observe('Momondo.Hotels.RequestUserInput',function(data){var _model=!!data?data.model:null;var model=jQuery.extend({},_this.model);model.Location=_model.Location;if(!!model){_this.setModel(model);}
            _this.calendarCheckIn.open();});};SearchFormHotel.prototype.setCurrency=function(currencyCode){this.currencyCode=currencyCode;};SearchFormHotel.prototype.getSearchBasePath=function(searchType){var urlName='';switch(searchType){case 1:urlName='SingleHotelSearch';break;default:urlName='MultipleHotelSearch';break;}
        var result=jQuery.grep(this.model.BaseURLs,function(u){return u.Name===urlName;});var url=result.length===1?result[0].Path:null;return url;};SearchFormHotel.prototype.buildSearchUrl=function(){var url='';var model=this.model;var location=this.model.Location;var locationKey=location.Key;var typeResult=/^(place|hotel):/i.exec(locationKey);var placeType=typeResult&&typeResult.length?typeResult[0]:'place:';if(locationKey.lastIndexOf(placeType)!==0)
        locationKey=placeType+locationKey;var useDates=!this.model.AnyTime;var checkIn=null,checkOut=null;if(useDates){checkIn=HotelUtils.formatDate(model.CheckIn);checkOut=HotelUtils.formatDate(model.CheckOut);}
        var rooms=model.Rooms;var roomCount=rooms.length;var roomDistribution=this.buildRoomDistribution(rooms);var url='';switch(placeType){case'hotel:':var hotelFileName=this.formatPlaceIdForUrl(locationKey,'hotel');url=String.format('{0}{1}?checkin={2}&checkout={3}&rooms={4}',this.getSearchBasePath(1),hotelFileName,checkIn,checkOut,roomDistribution);break;default:var placeFileName=this.formatPlaceIdForUrl(locationKey,'place');url=String.format('{0}{1}?checkin={2}&checkout={3}&rooms={4}&overview={5}',this.getSearchBasePath(0),placeFileName,checkIn,checkOut,roomDistribution,model.Location.Overview.toString());break;}
        return url;};SearchFormHotel.prototype.formatPlaceIdForUrl=function(placeIdForRequest,defaultPlaceType){if(defaultPlaceType==null){defaultPlaceType='place';}
        return placeIdForRequest.replace(/^([^:]*?:)?(.*)$/,function($0,$1,$2){return($1==null||$1===defaultPlaceType+':'?'':$1)+$2.replace(/-/g,'~').replace(/_/g,'-').replace(/~/g,'_').toLowerCase();});};SearchFormHotel.prototype.buildSearchUrl_DEPRECATED=function(){var url='';var model=this.model;var baseURL=model.BaseURLs[0].Path;var location=this.model.Location;var locationKey=location.Key;var version=model.Version;if(!(/^(place|hotel):/i.exec(locationKey)))
        locationKey='place:'+locationKey;var useDates=!this.model.AnyTime;var checkIn=null,checkOut=null;if(!useDates||(/^hotel:/i).exec(locationKey))
        baseURL=baseURL.replace("searchresults.aspx","SearchTermTypeRedirection.ashx");if(useDates){checkIn=HotelUtils.formatDate(model.CheckIn);checkOut=HotelUtils.formatDate(model.CheckOut);}
    else if(version!=='9'){baseURL+="&destination="+locationKey+"&useStored=false";return baseURL;}
        var rooms=model.Rooms;var roomCount=rooms.length;var roomDistribution=this.buildRoomDistribution_DEPRECATED(rooms);var languageCode=HotelUtils.getLanguageCode();var currencyCode=this.currencyCode;var url=""+String.format('{0}&destination={1}&checkin={2}&checkout={3}&Rooms={4}&{5}',baseURL,locationKey,checkIn,checkOut,roomCount.toString(),roomDistribution);var currencyString='currencyCode='+currencyCode;var reCurrency=/currencyCode=\w{3}/i;if(!!reCurrency.exec(url+'')){url=url.replace(reCurrency,currencyString);}
        else{url+='&'+currencyString;}
        return url;};SearchFormHotel.prototype._getPax=function(){var rooms=this.model.Rooms;var roomConfig=[];for(var i=0;i<rooms.length;i++){var room=rooms[i];var adults=room.AdultCount;var children=room.ChildAges;roomConfig.push(adults+':'+(children!=null?children:[]).join('-'));}
        return roomConfig.join();};SearchFormHotel.prototype.decodePax=function(pax){var RoomConfig=[];var data=pax.split(',');var num_adults=0;var num_rooms=data.length;var num_children=0;for(var i=0,room;room=data[i];i++){var people=room.split(':');num_adults+=people[0]*1;if(people[1].length>0)
        num_children+=people[1].split('-').length;RoomConfig.push({AdultCount:people[0]*1,ChildAges:(people[1].length)?people[1].split('-'):null});}
        return[RoomConfig,num_adults,num_children,num_rooms];};SearchFormHotel.prototype.isValid=function(onPendingAction){if(onPendingAction===void 0){onPendingAction=function(){};}
        var errorCnt=0;var pendingCount=0;var model=this.model;var location=this.model.Location;var locationKey=location.Key;if(this.cityCompleter.pending(function(){pendingCount--;if(pendingCount===0){onPendingAction();}})){pendingCount++;}
        else if(location==null||location==undefined||locationKey==undefined||locationKey==""){errorCnt++;this.cityCompleter.validated(false,Language["HotelSearchForm.InvalidCity"]);}
        var useDates=!this.model.AnyTime;if(useDates){var checkIn=model.CheckIn!==null&&model.CheckIn.constructor===Date?model.CheckIn.dateOnly():null;var checkOut=model.CheckOut!==null&&model.CheckOut.constructor===Date?model.CheckOut.dateOnly():null;var today=(new Date()).dateOnly();if(checkIn===null||+checkIn<+today){errorCnt++;this.calendarCheckIn.validated(false,Language['HotelSearchForm.InvalidDate']);}
            if(checkOut===null||+checkOut<=+checkIn){errorCnt++;this.calendarCheckOut.validated(false,Language['HotelSearchForm.InvalidDate']);}
            if(!!checkIn&&!!checkOut&&(+checkOut-+checkIn>2592000000)){errorCnt++;this.calendarCheckOut.validated(false,Language['HotelSearchForm.InvalidPeriod.TooLong']);}
            var rooms=model.Rooms||[];var adultCount=0;for(var i=0;i<rooms.length;i++){adultCount+=(rooms[i].AdultCount||0);if(!!adultCount)
                break;}
            if(adultCount==0){errorCnt++;this.selectGuests.validated(false,Language['HotelSearchForm.InvalidRoom.SpecifyAdult']);}}
        var validationResult={isValid:errorCnt==0,isPending:pendingCount>0};return validationResult;};SearchFormHotel.prototype.startSearch=function(newWindow){var t=this;var validationResult=this.isValid(function(){setTimeout(function(){t.startSearch(newWindow);},0);});if(!validationResult.isValid||validationResult.isPending){this.pendingSearchIntent=validationResult.isPending;return;}
        this.persistModel();switch(this.searchBehavior){case 0:var version=this.model.Version;var oldIE=document.addEventListener?false:true;var searchUrl=(version!='9'||oldIE)?this.buildSearchUrl_DEPRECATED():this.buildSearchUrl();searchUrl=searchUrl.replace("http://","[http]").replace("//","/").replace("[http]","http://");if(newWindow)
            window.open(""+searchUrl);else
            window.location.href=""+searchUrl;break;case 1:var model=this.model;$ev.fire('control:hotelsearch-start',{model:this.model});break;}};SearchFormHotel.prototype.formatCompleterMenu=function(ul,item){};SearchFormHotel.prototype.formatCompleterItem=function(ul,item){if(!!item.group){var groupName=item.name;var divider=jQuery('<li>',{'class':'ui-geolocate-group ui-menu-divider'});divider.append('<div class="icon" ></div><div class="label">'+groupName+'</div ><hr>').appendTo(ul);return divider;}
        function escapeRegExp(str){return typeof str!=='undefined'?str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"):'';}
        var term=this.term.split(' ').join('|'),re=new RegExp('('+escapeRegExp(term)+')','gi'),hl='<span class="highlight">$1</span>',name=item.name,place=(item.place||[]).join(', '),hotelCount=item.hotelCountLabel,label=jQuery('<div>',{'class':'label'}),labelName=jQuery('<div>',{'class':'name'}).append(name.replace(re,hl)).appendTo(label),labelPlaceName=jQuery('<div>',{'class':'place-name'}).append(place.replace(re,hl)).appendTo(label),labelCount=jQuery('<div>',{'class':'count'}).append(hotelCount.replace(re,hl)).appendTo(label),icon=jQuery('<div>',{'class':'icon'});item.displayName=function(){return item.name+(!!place?(', '+place):'');};return jQuery('<li>',{'class':'ui-geolocate-item'}).data('ui-autocomplete-item',item).append(icon).append(label).appendTo(ul);};SearchFormHotel.prototype.setValid=function(value){this.UIValid=value;};SearchFormHotel.prototype.getValid=function(){return this.UIValid;};SearchFormHotel.prototype.getTimespan=function(){var model=this.model;return{start:model.CheckIn,end:model.CheckOut};};SearchFormHotel.prototype.setTimespan=function(timespan){var model=this.model;model.CheckIn=timespan.start;model.CheckOut=timespan.end;this.setValid(false);};SearchFormHotel.prototype.getDestination=function(){var model=this.model;var key=!!model.Location?model.Location.Key:'';return{key:key,type:2};};SearchFormHotel.prototype.setDestination=function(code){var _this=this;var onCityLoad=function(city){if(!city)
        return;var cityName=city.Name;var countryName=city.CountryName;var text=cityName+(!!countryName&&countryName!==cityName?', '+countryName:'');var cityFileName=city.FileName;var searchable=city.Searchable;var model=_this.model;model.Location={Country:countryName,CountryCode:city.countryCode,DisplayName:cityName,HotelCount:-1,Key:cityFileName,Name:cityName,Overview:!searchable};var inputCity=_this.element.find('.input._where input');inputCity.val(text);};var context=this;var onError=function(){};var reFileName=/^(hotel|place):\w{1,}$/;var reIATA=/^[a-zA-Z]{3}$/;var dataService=this.dataService;if(!!code.match(reIATA)){dataService.GetCityByKey(code,onCityLoad,onError,context);}
    else if(!!code.match(reFileName)){dataService.GetPlaceByFileName(code,onCityLoad,onError,context);}};SearchFormHotel.prototype.lookupCityByCookie=function(){var _this=this;var modelData=this.dataService.GetPersistedModel();if(!modelData||!modelData.length)
        return;var query=modelData[0];var onLoad=function(items){if(items.length>=2)
        items=items.slice(1);var item=items[0];var key=item.key;var name=item.name;var place=item.place;var placeName=!!place&&!!place.length?place.join(', '):'';var location=_this.model.Location={Key:item.key,Name:item.name,Country:place.join(', '),CountryCode:item.countryCode,HotelCount:item.hotelCount,DisplayName:item.name+(!!placeName?(', '+placeName):''),Overview:false};var inputCity=_this.element.find('.input._where input');inputCity.val(location.DisplayName);};var onError=function(error){};this.dataService.LookupCities(query,1,onLoad,onError);};SearchFormHotel.prototype.getPax=function(){var rooms=this.model.Rooms;var adultCount=0;var childAges=[];for(var i=0,len=rooms.length;i<len;i++){var room=rooms[i];adultCount+=room.AdultCount||0;if(room.ChildAges&&!!room.ChildAges.length)
        childAges.push.apply(childAges,room.ChildAges.slice());}
        return{adultCount:adultCount,childAges:childAges,rooms:rooms};};SearchFormHotel.prototype.setPax=function(adultCount,childAges){var adults=adultCount;var children=!!childAges&&!!childAges.length?childAges.slice(0):[];var rooms=[];var maxAdultsPrRoom=10;var maxChildrenPrRoom=4;while(!!adults||!!children.length){var adultsInRoom=adults>0?Math.min(adults,maxAdultsPrRoom):0;var childrenInRoom=!!children.length?children.length>maxChildrenPrRoom?children.splice(0,maxChildrenPrRoom):children.splice(0):[];adults-=adultsInRoom;rooms.push({AdultCount:adultsInRoom,ChildAges:childrenInRoom});}
        var model=this.model;model.Rooms=rooms;this.setValid(false);};return SearchFormHotel;})();SearchForm.SearchFormHotel=SearchFormHotel;(function(HotelSearchType){HotelSearchType[HotelSearchType["MULTIPLE_HOTELS"]=0]="MULTIPLE_HOTELS";HotelSearchType[HotelSearchType["SINGLE_HOTEL"]=1]="SINGLE_HOTEL";})(SearchForm.HotelSearchType||(SearchForm.HotelSearchType={}));var HotelSearchType=SearchForm.HotelSearchType;})(SearchForm||(SearchForm={}));var HotelUtils=new(function(){"use strict";var factory=this,languageCode=(!!currentCulture?currentCulture.split('-'):['EN'])[0].toUpperCase(),hotelUtils;switch(currentCulture){case"zh-CN":languageCode="cs";break;case"zh-TW":case"zh-HK":languageCode="cn";break;case"cs-CZ":languageCode="cz";break;case"nb-NO":languageCode="no";break;case"uk-UA":languageCode="uk";break;}
    this.parseCityLookupData=function(data){var list=!!data&&!!data.length?data:[],result=[],i,len,name,key;for(i=0,len=list.length;i<len;i++){name=list[i][0];key=list[i][5];result[i]={DisplayName:name,key:key};}
        return result;};hotelUtils=new function(){this.getCityCompleteMethod=function(){var hotelBaeUrl=$j("#uiHiddenHotelBaseUrl").val();var requestFormat=hotelBaeUrl+'/AutoComplete.ashx?[ARGS]&format=jsonp&callback=[CALLBACK]',jsonp=new JSONP(requestFormat),successHandler,args,requestId;return function(text,maxItems,callbackSuccess,callbackFailure,context){args={query:text,languageCode:languageCode,limit:maxItems};successHandler=function(){args=[];args[0]={Results:factory.parseCityLookupData(arguments[0]),RequestText:text};args[1]=context;args.push(context);callbackSuccess.apply(null,args);};requestId=jsonp.request(args,successHandler);return new(function()
    {this.get_executor=function(){return new(function(){this.abort=function(){jsonp.cancelRequest(requestId);};})();};})();};};this.getLanguageCode=function(){return languageCode;};this.formatDate=function(date){if(!date){return'';}
        var formattedDate=String.format('{0}-{1}-{2}',date.getFullYear(),(date.getMonth()+1).toPaddedString(2),(date.getDate()).toPaddedString(2));return formattedDate;};};return hotelUtils;})();var CarLocation=(function(){function CarLocation(Id,Name,CountryCode,CountryName,StateName,IataCode,Active){if(Active===void 0){Active=true;}
    this.Id=Id;this.Name=Name;this.CountryCode=CountryCode;this.CountryName=CountryName;this.StateName=StateName;this.IataCode=IataCode;this.Active=Active;}
    CarLocation.prototype.displayName=function(){var label=this.label;if(!label){label=this.label=this.Name+(!!this.StateName?', '+this.StateName:'')+', '+this.CountryName;}
        return label;};return CarLocation;})();var SearchForm;(function(SearchForm){'use strict';var SearchFormCar=(function(){function SearchFormCar(name,element,factory,dataService,textManager,model,currencyCode,getParentSearchIntent,openSearchInNewWindow){if(openSearchInNewWindow===void 0){openSearchInNewWindow=false;}
    this.name=name;this.element=element;this.factory=factory;this.dataService=dataService;this.textManager=textManager;this.model=model;this.currencyCode=currencyCode;this.getParentSearchIntent=getParentSearchIntent;this.openSearchInNewWindow=openSearchInNewWindow;this.UIValid=true;this.pendingSearchIntent=false;this.sanitizeModel(this.model);}
    SearchFormCar.prototype.sanitizeModel=function(model){var pickupId=model.PickupLocation.Id;var dropOffId=(model.DropoffLocation||model.PickupLocation).Id;var dropOffActive=pickupId>0&&dropOffId>0&&pickupId!==dropOffId;var matchUTC=/^\d{4}-\d{1,2}-\d{1,2}T\d{1,2}:\d{1,2}:\d{1,2}/;var getDateFromUTCString=function(str){var result=null;var match=matchUTC.exec(str);if(!!match&&!!match.length)
        result=Date.fromISO(match[0]);else
        result=new Date();return result;};model.PickupDate=getDateFromUTCString(model.PickupDate);;model.DropoffDate=getDateFromUTCString(model.DropoffDate);model.DropoffLocation.Active=dropOffActive;if(dropOffActive)
        this.toggleAlternativeDropOffLocation(true);};SearchFormCar.prototype.getSearchIntent=function(){return this.getParentSearchIntent()||this.pendingSearchIntent;};SearchFormCar.prototype.setCurrency=function(currencyCode){this.currencyCode=currencyCode;};SearchFormCar.prototype.formChanged=function(key,value,ev){if(ev===void 0){ev=null;}
        $ev.fire('control:car-searchform-changed',{name:this.name,key:key,value:value,ev:ev});};SearchFormCar.prototype.dateChanged=function(type,date){var dateIdentifier='';switch(type){case'date-pickup':dateIdentifier='PickupDate';break;case'date-dropoff':dateIdentifier='DropoffDate';break;}
        var oldDate=this.model[dateIdentifier];date.setHours(oldDate.getHours());date.setMinutes(oldDate.getMinutes());this.model[dateIdentifier]=date;this.validateDates(type);this.formChanged(type,date);};SearchFormCar.prototype.toggleAlternativeDropOffLocation=function(on){if(on){this.element.find('._location-dropoff').addClass('_active');this.model.DropoffLocation.Active=true;}
    else{this.element.find('._location-dropoff').removeClass('_active');this.model.DropoffLocation.Active=false;}};SearchFormCar.prototype.validateDates=function(source){var model=this.model;var pickupDate=model.PickupDate;var dropOffDate=model.DropoffDate;if(+pickupDate>+dropOffDate){if(source=='date-pickup'){model.DropoffDate=new Date(model.PickupDate+"");}
    else if(source=='date-dropoff'){model.PickupDate=new Date(model.DropoffDate+"");}
        this.updateUI();}};SearchFormCar.prototype.updateUI=function(){var model=this.model;var pickupDate=model.PickupDate;var dropOffDate=model.DropoffDate;try{model.calendarPickup.setDate(pickupDate);model.calendarDropOff.setDate(dropOffDate);}
    catch(ex){}
        var pickupTime=pickupDate.getHours().toPaddedString(2)+':'+pickupDate.getMinutes().toPaddedString(2);var dropOffTime=dropOffDate.getHours().toPaddedString(2)+':'+dropOffDate.getMinutes().toPaddedString(2);try{model.selectPickupTime.setValue(pickupTime);model.selectDropOffTime.setValue(dropOffTime);}
        catch(ex){}
        this.setValid(true);};SearchFormCar.prototype.timeChanged=function(type,value){var date=null;switch(type){case'time-pickup':date=this.model.PickupDate;break;case'time-dropoff':date=this.model.DropoffDate;break;}
        var timeParts=value.split(':');var hours=parseInt(timeParts[0],10);var minutes=parseInt(timeParts[1],10);date.setHours(hours);date.setMinutes(minutes);this.formChanged(type,value);};SearchFormCar.prototype.residenceChanged=function(value){this.model.ResidenceCode=value;this.formChanged('residency',value);};SearchFormCar.prototype.pickupLocationSelected=function(ev,location){this.model.PickupLocation=location;this.formChanged('pickup-location',location,ev);};SearchFormCar.prototype.dropOffLocationSelected=function(ev,location){var model=this.model;location.Active=model.DropoffLocation.Active;this.model.DropoffLocation=location;this.formChanged('dropoff-location',location,ev);};SearchFormCar.prototype.initForm=function(){var _this=this;var element=this.element;var model=this.model;var container=element.find('.container').first();var inputLocations=container.find('.input._locations .input');var inputPickup=inputLocations.filter('._location-pickup').find('input');var inputDropOff=inputLocations.filter('._location-dropoff').find('input');var pickUp=container.find('._date-pickup');var dropOff=container.find('._date-dropoff');var inputPickupDate=pickUp.find('._date input');var selectPickupTime=pickUp.find('._time select');var inputDropOffDate=dropOff.find('._date input');var selectDropOffTime=dropOff.find('._time select');var factory=this.factory;var dataService=this.dataService;var selectResidency=element.find('.options .option._residency select');model.InputOriginControl=factory.CreateCompleter(inputPickup,"cars",dataService,Language["CarSearchForm.TypePickupCity"],function(item){return'TODO: Implement car city display name formatter';},this.formatCompleterItem,null,function(ev,options){_this.pickupLocationSelected(ev,options.item);});model.InputDestinationControl=factory.CreateCompleter(inputDropOff,"cars",dataService,Language["CarSearchForm.TypeDropoffCity"],function(item){return'TODO: Implement car city display name formatter';},this.formatCompleterItem,null,function(ev,options){_this.dropOffLocationSelected(ev,options.item);});model.calendarPickup=factory.CreateCalendar(inputPickupDate,{minDate:new Date(),firstDay:1,date:new Date(model.PickupDate+""),clearable:false,onSelect:function(event,data){var day=data.selectedDay;var month=data.selectedMonth;var year=data.selectedYear;var date=new Date(year,month,day);_this.pickUpDateSelected(date);inputPickupDate.blur();},getHighlightDates:function(){var dates={};var dropoffDate=_this.model.DropoffDate;dropoffDate=new Date(dropoffDate.getFullYear(),dropoffDate.getMonth(),dropoffDate.getDate(),0,0,0,0);dates[+dropoffDate]={'class':'ui-datepicker-date-highlight-return',text:'Dropoff date'};return dates;}});model.calendarDropOff=factory.CreateCalendar(inputDropOffDate,{minDate:new Date(),firstDay:1,date:new Date(model.DropoffDate+""),clearable:false,onSelect:function(event,data){var day=data.selectedDay;var month=data.selectedMonth;var year=data.selectedYear;var date=new Date(year,month,day);_this.dropOffDateSelected(date);inputDropOffDate.blur();},getHighlightDates:function(){var dates={};var pickupDate=_this.model.PickupDate;pickupDate=new Date(pickupDate.getFullYear(),pickupDate.getMonth(),pickupDate.getDate(),0,0,0,0);dates[+pickupDate]={'class':'ui-datepicker-date-highlight-depart',text:'Pickup date'};return dates;}});model.selectPickupTime=factory.CreateSelectBox(selectPickupTime,false,function(value){_this.timeChanged('time-pickup',value);});model.selectDropOffTime=factory.CreateSelectBox(selectDropOffTime,false,function(value){_this.timeChanged('time-dropoff',value);});selectResidency.val(model.ResidenceCode);model.selectResidency=factory.CreateSelectBox(selectResidency,false,function(value){_this.residenceChanged(value);});this.containeralternativeDropOff=element.find('._location-dropoff');var chkAlternativeDropOff=element.find('#chk-return-location');var alternativeDropOff=false;var pickupLocation=model.PickupLocation||null;var dropOffLocation=(model.DropoffLocation||pickupLocation);if(!!pickupLocation&&!!dropOffLocation&&pickupLocation.Id!=dropOffLocation.Id)
        alternativeDropOff=true;chkAlternativeDropOff.prop('checked',alternativeDropOff);if(alternativeDropOff)
        this.toggleAlternativeDropOffLocation(true);chkAlternativeDropOff.change(function(ui){var checked=ui.target.checked;_this.toggleAlternativeDropOffLocation(checked);_this.formChanged('alternative-dropoff-active',checked);});this.initForm=function(){if(!this.getValid()){this.validateDates('date-pickup');this.updateUI();}};this.updateUI();$ev.observe('control:car-searchform-changed',function(options){if(_this.getSearchIntent())
        return;switch(options.key){case'pickup-location':if(_this.model.DropoffLocation.Active){_this.model.InputDestinationControl.focus();break;}
        case'dropoff-location':var ev=options.ev;if(!!ev&&!!ev.shiftKey)
            model.InputOriginControl.focus();else
            _this.model.calendarPickup.open();break;case'date-pickup':_this.model.calendarDropOff.open();break;case'date-dropoff':break;}},null,true);};SearchFormCar.prototype.toCTDateString=function(date){var dateTime='';var month=date.getMonth()+1;var day=date.getDate();month=month<10?'0'+month:month;day=day<10?'0'+day:day;var hours=date.getHours();var minutes=date.getMinutes();hours=hours<10?'0'+hours:hours;minutes=minutes<10?'0'+minutes:minutes;dateTime+=date.getFullYear()+'-'+month+'-'+day+'T'+hours+':'+minutes;return dateTime;};SearchFormCar.prototype.buildSearchUrl=function(){var model=this.model;if(!model.PickupLocation)
        return;if(!model.DropoffLocation||!model.DropoffLocation.Active)
        model.DropoffLocation=model.PickupLocation;var pickupID=model.PickupLocation.Id;var dropOffID=model.DropoffLocation.Id;var pickupDateTime=this.toCTDateString(model.PickupDate);var dropOffDateTime=this.toCTDateString(model.DropoffDate);var countryCode=model.PickupLocation.CountryCode;var userResidence=model.userResidence||'DK';var driverAge=30;var currency=this.currencyCode;var params=['countryID='+countryCode,'pickupLocationId='+pickupID,'returnLocationId='+dropOffID,'pickupDateTime='+pickupDateTime,'returnDateTime='+dropOffDateTime,'age='+driverAge,'currencyID='+currency,'currency='+currency,'residencyId='+userResidence];var basePath=model.SearchBasePath;var url=basePath+(basePath.indexOf('?')>-1?'&':'?')+params.join('&');return url;};SearchFormCar.prototype.FourDigitTime=function(date){var hour=date.getHours()+'';hour=(hour.length==2)?hour:'0'+hour;var minute=date.getMinutes()+'';minute=(minute.length==2)?minute:'0'+minute;return hour+minute;};SearchFormCar.prototype.persistModel=function(){var model=this.model;var pickupLocation=model.PickupLocation;if(!pickupLocation)
        return;var dropOffLocation=model.DropoffLocation;if(!dropOffLocation||!dropOffLocation.Active)
        dropOffLocation=pickupLocation;var pickupTime=new Date(model.PickupDate.getTime());var dropOffTime=new Date(model.DropoffDate.getTime());var pickupDateTime=HotelUtils.formatDate(pickupTime).replace(/-/g,"")+this.FourDigitTime(pickupTime);var dropOffDateTime=HotelUtils.formatDate(dropOffTime).replace(/-/g,"")+this.FourDigitTime(dropOffTime);var userResidence=model.userResidence||'DK';var cookieValue=[pickupLocation.Name,dropOffLocation.Name,pickupDateTime,dropOffDateTime,userResidence,new Date().toISOString(),pickupLocation.Id,dropOffLocation.Id,model.driverAge];this.dataService.PersistModel(cookieValue);};SearchFormCar.prototype.isValid=function(onPendingAction){if(onPendingAction===void 0){onPendingAction=function(){};}
        var errorCnt=0;var pendingCount=0;var model=this.model;var validateCompleter=function(completer,location,toolTip){if(completer.pending(function(){pendingCount--;if(pendingCount===0){onPendingAction();}})){pendingCount++;}
        else if(!location||!location.CountryCode||!location.Id){errorCnt++;completer.validated(false,toolTip);}};validateCompleter(model.InputOriginControl,model.PickupLocation,Language["CarSearchForm.Error.TypePickupCity"]);if(model.DropoffLocation&&model.DropoffLocation.Active){validateCompleter(model.InputDestinationControl,model.DropoffLocation,Language["CarSearchForm.Error.TypePickupCity"]);}
        if(model.DropoffDate.getTime()<=model.PickupDate.getTime()){errorCnt++;model.selectDropOffTime.validated(false,Language["CarSearchForm.Error.PickupDropOffSame"]);}
        var validationResult={isValid:errorCnt==0,isPending:pendingCount>0};return validationResult;};SearchFormCar.prototype.startSearch=function(newWindow){var _this=this;var validationResult=this.isValid(function(){setTimeout(function(){_this.startSearch(newWindow);},0);});if(!validationResult.isValid||validationResult.isPending){this.pendingSearchIntent=validationResult.isPending;return;}
        this.persistModel();var searchUrl=this.buildSearchUrl();searchUrl=searchUrl.replace("http://","[http]").replace("//","/").replace("[http]","http://");if(newWindow){window.open(""+searchUrl);}
        else{window.location.href=""+searchUrl;}};SearchFormCar.prototype.formatCompleterItem=function(ul,item){if(!!item.group){var groupName=item.Name;var divider=jQuery('<li>',{'class':'ui-geolocate-group ui-menu-divider'});divider.append('<div class="icon" ></div><div class="label">'+groupName+'</div ><hr>').appendTo(ul);return divider;}
        function escapeRegExp(str){return typeof str!=='undefined'?str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"):'';}
        var term=this.term.split(' ').join('|'),re=new RegExp('('+escapeRegExp(term)+')','gi'),hl='<span class="highlight">$1</span>',name=item.Name,id=item.Id,stateName=item.StateName,place=(!!stateName?stateName+', ':'')+item.CountryName,iata=item.IataCode,label=jQuery('<div>',{'class':'label'}),labelName=jQuery('<div>',{'class':'name'}).append(name.replace(re,hl)).appendTo(label),labelPlaceName=jQuery('<div>',{'class':'place-name'}).append(place.replace(re,hl)).appendTo(label),labelIata=jQuery('<div>',{'class':'iata'}).append(iata.replace(re,hl)).appendTo(label),icon=jQuery('<div>',{'class':'icon'});return jQuery('<li>',{'class':'ui-geolocate-item'}).data('ui-autocomplete-item',item).append(icon).append(label).appendTo(ul);};SearchFormCar.prototype.pickUpDateSelected=function(pickupDate){this.dateChanged('date-pickup',pickupDate);};SearchFormCar.prototype.dropOffDateSelected=function(dropOffDate){this.dateChanged('date-dropoff',dropOffDate);};SearchFormCar.prototype.setValid=function(value){this.UIValid=value;};SearchFormCar.prototype.getValid=function(){return this.UIValid;};SearchFormCar.prototype.getTimespan=function(){var model=this.model;return{start:model.PickupDate,end:model.DropoffDate};};SearchFormCar.prototype.setTimespan=function(timespan){var model=this.model;var newPickupDate=new Date(+timespan.start);var newDropOffDate=new Date(+timespan.end);var pickupDate=model.PickupDate;var dropOffDate=model.DropoffDate;newPickupDate.setHours(pickupDate.getHours());newPickupDate.setMinutes(pickupDate.getMinutes());newDropOffDate.setHours(dropOffDate.getHours());newDropOffDate.setMinutes(dropOffDate.getMinutes());model.PickupDate=newPickupDate;model.DropoffDate=newDropOffDate;this.setValid(false);};SearchFormCar.prototype.getDestination=function(){var key='';var model=this.model;var location=model.PickupLocation;var key=!!location.Id?location.Id.toString():'-1';return{key:key,type:3};};SearchFormCar.prototype.setDestination=function(code){var _this=this;var onCityLoaded=function(city){if(!city)
        return;var locationName=city.Name;var ctLocationID=city.Id;var inputLocations=_this.element.find('.input._locations .input');var inputPickup=inputLocations.filter('._location-pickup').find('input');var inputDropOff=inputLocations.filter('._location-dropoff').find('input');var pickupLocation=new CarLocation(city.Id,locationName,city.CountryCode,city.CountryName,city.StateName,city.IataCode,true);var dropoffLocation=new CarLocation(city.Id,locationName,city.CountryCode,city.CountryName,city.StateName,city.IataCode,false);var model=_this.model;model.PickupLocation=pickupLocation;model.DropoffLocation=dropoffLocation;_this.toggleAlternativeDropOffLocation(false);inputPickup.val(pickupLocation.displayName());inputDropOff.val(dropoffLocation.displayName());};var onError=function(){};var context=this;this.dataService.GetCityByKey(code,onCityLoaded,onError,context);};SearchFormCar.prototype.getPax=function(){return{adultCount:1,childAges:[]};};SearchFormCar.prototype.setPax=function(adultCount,childAges){};return SearchFormCar;})();SearchForm.SearchFormCar=SearchFormCar;})(SearchForm||(SearchForm={}));var SearchForm;(function(_SearchForm){'use strict';(function(SearchBehavior){SearchBehavior[SearchBehavior["REDIRECT"]=0]="REDIRECT";SearchBehavior[SearchBehavior["EVENT"]=1]="EVENT";})(_SearchForm.SearchBehavior||(_SearchForm.SearchBehavior={}));var SearchBehavior=_SearchForm.SearchBehavior;(function(ProductCityType){ProductCityType[ProductCityType["FLIGHT"]=1]="FLIGHT";ProductCityType[ProductCityType["HOTEL"]=2]="HOTEL";ProductCityType[ProductCityType["CAR"]=3]="CAR";ProductCityType[ProductCityType["PACKAGE"]=4]="PACKAGE";})(_SearchForm.ProductCityType||(_SearchForm.ProductCityType={}));var ProductCityType=_SearchForm.ProductCityType;var SearchForm=(function(){function SearchForm(element,formData,context){var _this=this;this.element=element;this.searchForms={};this.searchIntent=false;this.container=jQuery('.mui-searchbox').first();this.formContainers=this.container.find('.forms > .container > .form');this.tabElements=this.container.find('.tabs > .tab');this.initForms(element,formData,context);jQuery(document).on('Trigger.mui-searchbox.setForm',function(event,args){_this.showForm(args.form);});jQuery(document).on('Trigger.mui-searchbox.setFormAndDestination',function(event,args){for(var searchForm in _this.searchForms){_this.searchForms[searchForm].setDestination(args.dest);}
    var activeForm=_this.activeForm||_this.searchForms['flights'];_this.syncForms(activeForm,'dates');_this.showForm(args.form);});new UIHelper({viewportCollisionHandling:true});}
    SearchForm.prototype.startSearch=function(evt,type){type=typeof type!=='undefined'?type:null;var newWindow=(!!evt&&evt.ctrlKey);var searchForm;switch(type){case'flight':searchForm=this.searchForms['flights'];break;case'hotel':searchForm=this.searchForms['hotels'];break;case'car':searchForm=this.searchForms['cars'];break;default:searchForm=this.activeForm;break;}
        if(!!searchForm){}
        searchForm.startSearch(newWindow);};SearchForm.prototype.showForm=function(type){this.container.removeClass(function(index,css){return(css.match(/\mui-searchbox-\S+/g)||[]).join(' ');});this.container.addClass('mui-searchbox-'+type);this.formContainers.removeClass('_active').filter('._'+type).addClass('_active');this.tabElements.removeClass('_active').filter('._'+type).addClass('_active');this.activeForm=this.searchForms[type];this.activeForm.initForm();$ev.fire('control:form-changed',{type:type});};SearchForm.prototype.syncForms=function(sourceForm,what){var getData=null;var setData=null;switch(what){case'dates':getData=function(){return this.getTimespan();};setData=function(data){this.setTimespan(data);};break;case'destination':getData=function(){return this.getDestination();};setData=function(data){this.setDestination(data.key,data.type);};break;case'pax':getData=function(){return this.getPax();};setData=function(data){this.setPax(data.adultCount,data.childAges);};break;default:{getData=function(){};setData=function(data){};break;}}
        var searchForms=this.searchForms;var data=getData.call(sourceForm);for(var key in searchForms){if(searchForms[key]!==sourceForm)
            setData.call(searchForms[key],data);}};SearchForm.prototype.searchFormChanged=function(type,data){var _this=this;var key=data.key;var value=data.value;var actions=[];switch(type){case'flight':var sourceForm=this.searchForms['flights'];if(key==='segment'){if(value.part==='depart'&&value.index<=1)
        actions.push(this.syncForms.bind(this,sourceForm,'dates'));if(value.part==='destination')
        actions.push(this.syncForms.bind(this,sourceForm,'destination'));}
        if(key==='pax')
            actions.push(this.syncForms.bind(this,sourceForm,'pax'));break;case'hotel':var sourceForm=this.searchForms['hotels'];if(key==='check-in'||key==='check-out')
        actions.push(this.syncForms.bind(this,sourceForm,'dates'));if(key==='pax')
        actions.push(this.syncForms.bind(this,sourceForm,'pax'));break;case'car':var sourceForm=this.searchForms['cars'];if(key==='date-pickup'||key==='date-dropoff')
        actions.push(this.syncForms.bind(this,sourceForm,'dates'));break;}
        for(var i=0,len=actions.length;i<len;i++){actions[i]();}
        window.setTimeout(function(){if(!!_this.submitButton&&_this.submitButton.shine)
            _this.submitButton.shine();},20);};SearchForm.prototype.initForms=function(element,formModels,context){var _this=this;var currencyCode=context.currencyCode;var tabs=this.element.find('.tabs');var factory=new _SearchForm.ControlFactory();var searchForms={};var cultureCode=MomondoInfo.CultureInfo.CurrentCulture.Code;var cultureParts=cultureCode.split('-');var languageCode=cultureParts[0];var countryCode=cultureParts[1];var textManager=new Translation.Translation({Code:cultureCode,TwoLetterISOLanguageName:languageCode},null);for(var type in formModels){var searchForm;switch(type){case'flights':var model=formModels[type];var segments=model.Segments;var dataService=new MomondoServices.FlightService(cultureCode);var formType='flights';var tab=tabs.find('_flights');searchForm=new _SearchForm.SearchFormFlight('flights',jQuery('.form._flights'),factory,dataService,textManager,function(){},model,currencyCode,function(){return _this.getSearchIntent();});$ev.observe('control:flight-searchform-changed',this.searchFormChanged.bind(this,'flight'));break;case'hotels':var model=formModels[type];var version=model.Version||'';var dataService=new MomondoServices.HotelService(cultureCode,version);searchForm=new _SearchForm.SearchFormHotel('hotels',jQuery('.form._hotels'),factory,dataService,textManager,model,currencyCode,function(){return _this.getSearchIntent();});$ev.observe('control:hotel-searchform-changed',this.searchFormChanged.bind(this,'hotel'));break;case'cars':var dataService=new MomondoServices.CarService(10,cultureCode);var model=formModels[type];searchForm=new _SearchForm.SearchFormCar('cars',jQuery('.form._cars'),factory,dataService,textManager,model,currencyCode,function(){return _this.getSearchIntent();},false);$ev.observe('control:car-searchform-changed',this.searchFormChanged.bind(this,'car'));break;}
        searchForms[type]=searchForm;if(context.activeForm==type)
            this.activeForm=searchForm;}
        this.activeForm.initForm();this.searchForms=searchForms;var selected=true;var t=this;tabs.on('click','.tab',function(){var type=jQuery(this).data('searchform');t.showForm(type);});var buttonElement=this.element.find('.submit');this.submitButton=factory.CreateSubmitButton(buttonElement,function(evt){_this.startSearch(evt);},this.setSearchIntent.bind(this,true),this.setSearchIntent.bind(this,false));if($(document).observe)
            $(document).observe('currency:change',function(){_this.currencyChanged();});};SearchForm.prototype.setSearchIntent=function(on){this.searchIntent=on;};SearchForm.prototype.getSearchIntent=function(){return this.searchIntent;};SearchForm.prototype.currencyChanged=function(){var locale=jQuery('#localesettings').localesettings('getLocale');var currency=locale.currency.code;var searchForms=this.searchForms;for(var key in searchForms){searchForms[key].setCurrency(currency);}};SearchForm.prototype.getForm=function(type){return this.searchForms[type]||null;};return SearchForm;})();_SearchForm.SearchForm=SearchForm;var UIHelper=(function(){function UIHelper(options){this.viewportCollisionHandling=typeof options.viewportCollisionHandling!=='undefined'?options.viewportCollisionHandling:true;this.init();}
    UIHelper.prototype.init=function(){var _this=this;if(this.viewportCollisionHandling)
        $ev.observe('widget:popup-opened',function(item){_this.popupOpened(item);});};UIHelper.prototype.popupOpened=function(item){var _this=this;setTimeout(function(){var report=_this.detectFrameCollision(item);var offset=10;if(report.collision){var vp=report.viewport;if(report.top<0){var top=vp.offsetY-Math.abs(report.top)-offset;jQuery('html, body').animate({scrollTop:top},500);}
        if(report.bottom<0){var top=vp.offsetY+Math.abs(report.bottom)+offset;jQuery('html, body').animate({scrollTop:top},500);}}},100);};UIHelper.prototype.detectFrameCollision=function(item){var win=jQuery(window);var viewPortHeight=win.height();var viewPortTop=win.scrollTop();var viewPortBottom=viewPortHeight+viewPortTop;var itemOffset=item.offset();var itemTop=itemOffset.top;var itemBottom=itemTop+item.height();var pixelsTop=itemTop-viewPortTop;var pixelsBottom=viewPortBottom-itemBottom;return{collision:pixelsTop<0||pixelsBottom<0,top:pixelsTop,bottom:pixelsBottom,viewport:{height:viewPortHeight,offsetY:viewPortTop}};};return UIHelper;})();_SearchForm.UIHelper=UIHelper;})(SearchForm||(SearchForm={}));$j(document).ready(function(){var count=4;var lazyload=function(){$j("div.lazyload").lazyload({threshold:200,skip_invisible:true});}
    var GetPopulars=function(count)
    {$j("div .mui-goexplore-result-row").each(function(index)
    {var row=$j(this);if(index<count||count==0){row.removeClass("pagevisible");}});if(count==0){$j("#uiShowMore").hide();}}
    GetPopulars(count);$j("#uiShowMore").click(function(){count=0;GetPopulars(count);lazyload();});lazyload();});if(window.$j!=undefined||isVNext)
{jQuery(document).ready(function($)
{$('body').on('keyup','.mui-newsletter-signup-input input[type=text]',function(event)
{var $this=$(this),$parent=$this.closest('.mui-newsletter-signup'),$input=$parent.find('input[type=text]'),$submit=$parent.find('.mui-newsletter-signup-submit');if($input.parent().hasClass('ui-state-invalid'))
{$input.parent().removeClass('ui-state-invalid');}
    if(event.keyCode===13)
    {$submit.click();}}).on('click','.mui-newsletter-signup-submit',function(event)
{var $this=$(this),$parent=$this.closest('.mui-newsletter-signup'),$input=$parent.find('input[type=text]'),strEmail=$input.val(),pData=typeof pageData!=='undefined'?pageData:{},strCulture=pData.siteCountry||'XX',imgTag='<img class="mui-newsletter-submit-img" width="1" height="1" src="http://email.momondo.com/pub/rf?_ri_=X0Gzc2X%3DWQpglLjHJlYQGN5EB0jXGYWsnMalFynvPzblvvOVwjpnpgHlpgneHmgJoXX0Gzc2X%3DWQpglLjHJlYQGl4ysBKpwzdIzazeJzdIOtAS0SpRXO&EMAIL_ADDRESS_={0}&COUNTRY_ISO2='+strCulture+'&NEWSLETTER=TRUE&NEWSLETTER_SOURCE_ID=5"/>';if(/^[^@\s]+@[^@\s]+\.[a-zA-Z]+$/.test(strEmail))
{$parent.removeClass('_incomplete');$parent.find('.mui-newsletter-signup-form').remove();strEmail=encodeURIComponent(strEmail);imgTag=imgTag.replace('{0}',strEmail);$parent.prepend(imgTag);}else
{$input.parent().addClass('ui-state-invalid');}});});}
var MomondoTrackingWS=function(){MomondoTrackingWS.initializeBase(this);this._timeout=0;this._userContext=null;this._succeeded=null;this._failed=null;}
MomondoTrackingWS.prototype={_get_path:function(){var p=this.get_path();if(p)return p;else return MomondoTrackingWS._staticInstance.get_path();},LogUserFlightChoice:function(records,succeededCallback,failedCallback,userContext){return this._invoke(this._get_path(),'LogUserFlightChoice',false,{records:records},succeededCallback,failedCallback,userContext);}}
MomondoTrackingWS.registerClass('MomondoTrackingWS',Sys.Net.WebServiceProxy);MomondoTrackingWS._staticInstance=new MomondoTrackingWS();MomondoTrackingWS.set_path=function(value){MomondoTrackingWS._staticInstance.set_path(value);}
MomondoTrackingWS.get_path=function(){return MomondoTrackingWS._staticInstance.get_path();}
MomondoTrackingWS.set_timeout=function(value){MomondoTrackingWS._staticInstance.set_timeout(value);}
MomondoTrackingWS.get_timeout=function(){return MomondoTrackingWS._staticInstance.get_timeout();}
MomondoTrackingWS.set_defaultUserContext=function(value){MomondoTrackingWS._staticInstance.set_defaultUserContext(value);}
MomondoTrackingWS.get_defaultUserContext=function(){return MomondoTrackingWS._staticInstance.get_defaultUserContext();}
MomondoTrackingWS.set_defaultSucceededCallback=function(value){MomondoTrackingWS._staticInstance.set_defaultSucceededCallback(value);}
MomondoTrackingWS.get_defaultSucceededCallback=function(){return MomondoTrackingWS._staticInstance.get_defaultSucceededCallback();}
MomondoTrackingWS.set_defaultFailedCallback=function(value){MomondoTrackingWS._staticInstance.set_defaultFailedCallback(value);}
MomondoTrackingWS.get_defaultFailedCallback=function(){return MomondoTrackingWS._staticInstance.get_defaultFailedCallback();}
MomondoTrackingWS.set_enableJsonp=function(value){MomondoTrackingWS._staticInstance.set_enableJsonp(value);}
MomondoTrackingWS.get_enableJsonp=function(){return MomondoTrackingWS._staticInstance.get_enableJsonp();}
MomondoTrackingWS.set_jsonpCallbackParameter=function(value){MomondoTrackingWS._staticInstance.set_jsonpCallbackParameter(value);}
MomondoTrackingWS.get_jsonpCallbackParameter=function(){return MomondoTrackingWS._staticInstance.get_jsonpCallbackParameter();}
MomondoTrackingWS.set_path("/MomondoTrackingWS.asmx");MomondoTrackingWS.LogUserFlightChoice=function(records,onSuccess,onFailed,userContext){MomondoTrackingWS._staticInstance.LogUserFlightChoice(records,onSuccess,onFailed,userContext);}
var gtc=Sys.Net.WebServiceProxy._generateTypedConstructor;Type.registerNamespace('SkyGate.Momondo.Logging');if(typeof(SkyGate.Momondo.Logging.UserFlightChoiceRecord)==='undefined'){SkyGate.Momondo.Logging.UserFlightChoiceRecord=gtc("SkyGate.Momondo.Logging.UserFlightChoiceRecord");SkyGate.Momondo.Logging.UserFlightChoiceRecord.registerClass('SkyGate.Momondo.Logging.UserFlightChoiceRecord');}
var FontDetector=function(){var baseFonts=['monospace','sans-serif','serif'];var testString="mmmmmmmmmmlli";var testSize='72px';var h=document.getElementsByTagName("body")[0];var s=document.createElement("span");s.style.fontSize=testSize;s.innerHTML=testString;var defaultWidth={};var defaultHeight={};for(var index in baseFonts){s.style.fontFamily=baseFonts[index];h.appendChild(s);defaultWidth[baseFonts[index]]=s.offsetWidth;defaultHeight[baseFonts[index]]=s.offsetHeight;h.removeChild(s);}
    function detect(font){var detected=false;for(var index in baseFonts){s.style.fontFamily=font+','+baseFonts[index];h.appendChild(s);var matched=(s.offsetWidth!=defaultWidth[baseFonts[index]]||s.offsetHeight!=defaultHeight[baseFonts[index]]);h.removeChild(s);detected=detected||matched;}
        return detected;}
    this.detect=detect;};if(typeof Sys!='undefined'&&typeof Sys.__upperCaseTypes!='undefined')
{for(var s in Sys.__upperCaseTypes)
{var t=Sys.__upperCaseTypes[s];if(typeof t.set_path!='undefined'&&typeof t.get_path!='undefined')
    t.set_path(mm.pathPrefix+t.get_path());}}
var MomondoScriptsLoaded=true;(function(){document.fire('momondo:scriptsloaded');}).defer();
